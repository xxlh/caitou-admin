(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["store"],{"0ac8a":function(e,t,a){},"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("d3b7");function n(e,t,a,n,r,i,o){try{var l=e[i](o),s=l.value}catch(c){return void a(c)}l.done?t(s):Promise.resolve(s).then(n,r)}function r(e){return function(){var t=this,a=arguments;return new Promise((function(r,i){var o=e.apply(t,a);function l(e){n(o,r,i,l,s,"next",e)}function s(e){n(o,r,i,l,s,"throw",e)}l(void 0)}))}}},2557:function(e,t,a){},"4d55":function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return c}));a("ac1f"),a("5319");var n=a("b775"),r={list:"/stores",all:"/stores",add:"/stores",edit:"/stores/{id}",delete:"/stores/{id}"};function i(e){return Object(n["b"])({url:r.list,method:"get",params:e})}function o(e){return Object(n["b"])({url:r.all,method:"get",params:e})}function l(e){return Object(n["b"])({url:r.add,method:"post",data:e})}function s(e,t){return Object(n["b"])({url:r.edit.replace("{id}",e),method:"patch",data:t})}function c(e){return Object(n["b"])({url:r.delete.replace("{id}",e),method:"delete"})}},"862d3":function(e,t,a){"use strict";(function(t,a){e.exports=a()})(0,(function(){function e(e){var n=[];return e.AMapUI&&n.push(t(e.AMapUI)),e.Loca&&n.push(a(e.Loca)),Promise.all(n)}function t(e){return new Promise((function(t,a){var l=[];if(e.plugins)for(var s=0;s<e.plugins.length;s+=1)-1==r.AMapUI.plugins.indexOf(e.plugins[s])&&l.push(e.plugins[s]);if(i.AMapUI===n.failed)a("前次请求 AMapUI 失败");else if(i.AMapUI===n.notload){i.AMapUI=n.loading,r.AMapUI.version=e.version||r.AMapUI.version,s=r.AMapUI.version;var c=document.body||document.head,d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/ui/"+s+"/main.js",d.onerror=function(e){i.AMapUI=n.failed,a("请求 AMapUI 失败")},d.onload=function(){if(i.AMapUI=n.loaded,l.length)window.AMapUI.loadUI(l,(function(){for(var e=0,a=l.length;e<a;e++){var n=l[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}for(t();o.AMapUI.length;)o.AMapUI.splice(0,1)[0]()}));else for(t();o.AMapUI.length;)o.AMapUI.splice(0,1)[0]()},c.appendChild(d)}else i.AMapUI===n.loaded?e.version&&e.version!==r.AMapUI.version?a("不允许多个版本 AMapUI 混用"):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,a=l.length;e<a;e++){var n=l[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}t()})):t():e.version&&e.version!==r.AMapUI.version?a("不允许多个版本 AMapUI 混用"):o.AMapUI.push((function(e){e?a(e):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,a=l.length;e<a;e++){var n=l[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}t()})):t()}))}))}function a(e){return new Promise((function(t,a){if(i.Loca===n.failed)a("前次请求 Loca 失败");else if(i.Loca===n.notload){i.Loca=n.loading,r.Loca.version=e.version||r.Loca.version;var l=r.Loca.version,s=r.AMap.version.startsWith("2"),c=l.startsWith("2");if(s&&!c||!s&&c)a("JSAPI 与 Loca 版本不对应！！");else{s=r.key,c=document.body||document.head;var d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/loca?v="+l+"&key="+s,d.onerror=function(e){i.Loca=n.failed,a("请求 AMapUI 失败")},d.onload=function(){for(i.Loca=n.loaded,t();o.Loca.length;)o.Loca.splice(0,1)[0]()},c.appendChild(d)}}else i.Loca===n.loaded?e.version&&e.version!==r.Loca.version?a("不允许多个版本 Loca 混用"):t():e.version&&e.version!==r.Loca.version?a("不允许多个版本 Loca 混用"):o.Loca.push((function(e){e?a(e):a()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var n;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(n||(n={}));var r={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},o={AMap:[],AMapUI:[],Loca:[]},l=[],s=function(e){"function"==typeof e&&(i.AMap===n.loaded?e(window.AMap):l.push(e))};return{load:function(t){return new Promise((function(a,o){if(i.AMap==n.failed)o("");else if(i.AMap==n.notload){var c=t.key,d=t.version,u=t.plugins;c?(window.AMap&&"lbs.amap.com"!==location.host&&o("禁止多种API加载方式混用"),r.key=c,r.AMap.version=d||r.AMap.version,r.AMap.plugins=u||r.AMap.plugins,i.AMap=n.loading,d=document.body||document.head,window.___onAPILoaded=function(r){if(delete window.___onAPILoaded,r)i.AMap=n.failed,o(r);else for(i.AMap=n.loaded,e(t).then((function(){a(window.AMap)}))["catch"](o);l.length;)l.splice(0,1)[0]()},u=document.createElement("script"),u.type="text/javascript",u.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+r.AMap.version+"&key="+c+"&plugin="+r.AMap.plugins.join(","),u.onerror=function(e){i.AMap=n.failed,o(e)},d.appendChild(u)):o("请填写key")}else if(i.AMap==n.loaded)if(t.key&&t.key!==r.key)o("多个不一致的 key");else if(t.version&&t.version!==r.AMap.version)o("不允许多个版本 JSAPI 混用");else{if(c=[],t.plugins)for(d=0;d<t.plugins.length;d+=1)-1==r.AMap.plugins.indexOf(t.plugins[d])&&c.push(t.plugins[d]);c.length?window.AMap.plugin(c,(function(){e(t).then((function(){a(window.AMap)}))["catch"](o)})):e(t).then((function(){a(window.AMap)}))["catch"](o)}else if(t.key&&t.key!==r.key)o("多个不一致的 key");else if(t.version&&t.version!==r.AMap.version)o("不允许多个版本 JSAPI 混用");else{var p=[];if(t.plugins)for(d=0;d<t.plugins.length;d+=1)-1==r.AMap.plugins.indexOf(t.plugins[d])&&p.push(t.plugins[d]);s((function(){p.length?window.AMap.plugin(p,(function(){e(t).then((function(){a(window.AMap)}))["catch"](o)})):e(t).then((function(){a(window.AMap)}))["catch"](o)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,r={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},o={AMap:[],AMapUI:[],Loca:[]}}}}))},"88bc":function(e,t,a){(function(t){var a=1/0,n=9007199254740991,r="[object Arguments]",i="[object Function]",o="[object GeneratorFunction]",l="[object Symbol]",s="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,d=s||c||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function p(e,t){var a=-1,n=e?e.length:0,r=Array(n);while(++a<n)r[a]=t(e[a],a,e);return r}function m(e,t){var a=-1,n=t.length,r=e.length;while(++a<n)e[r+a]=t[a];return e}var f=Object.prototype,h=f.hasOwnProperty,v=f.toString,g=d.Symbol,b=f.propertyIsEnumerable,y=g?g.isConcatSpreadable:void 0,w=Math.max;function C(e,t,a,n,r){var i=-1,o=e.length;a||(a=k),r||(r=[]);while(++i<o){var l=e[i];t>0&&a(l)?t>1?C(l,t-1,a,n,r):m(r,l):n||(r[r.length]=l)}return r}function A(e,t){return e=Object(e),M(e,t,(function(t,a){return a in e}))}function M(e,t,a){var n=-1,r=t.length,i={};while(++n<r){var o=t[n],l=e[o];a(l,o)&&(i[o]=l)}return i}function _(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,n=-1,r=w(a.length-t,0),i=Array(r);while(++n<r)i[n]=a[t+n];n=-1;var o=Array(t+1);while(++n<t)o[n]=a[n];return o[t]=i,u(e,this,o)}}function k(e){return S(e)||I(e)||!!(y&&e&&e[y])}function x(e){if("string"==typeof e||P(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function I(e){return j(e)&&h.call(e,"callee")&&(!b.call(e,"callee")||v.call(e)==r)}var S=Array.isArray;function L(e){return null!=e&&F(e.length)&&!O(e)}function j(e){return E(e)&&L(e)}function O(e){var t=$(e)?v.call(e):"";return t==i||t==o}function F(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function $(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function E(e){return!!e&&"object"==typeof e}function P(e){return"symbol"==typeof e||E(e)&&v.call(e)==l}var q=_((function(e,t){return null==e?{}:A(e,p(C(t,1),x))}));e.exports=q}).call(this,a("c8ba"))},"9f62":function(e,t,a){"use strict";a("0ac8a")},c2d4:function(e,t,a){"use strict";a("2557")},cad8e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"card-title"},[e._v(e._s(e.$route.meta.title))]),a("div",{staticClass:"table-operator"},[a("a-row",[a("a-col",{attrs:{span:5}},[a("a-button",{directives:[{name:"action",rawName:"v-action:add",arg:"add"}],attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("a-col",{staticClass:"flex flex-x-end",attrs:{span:11,offset:8}},[a("SelectRegion",{attrs:{placeholder:"请选择省市区"},on:{change:e.onCascaderChange},model:{value:e.cascader,callback:function(t){e.cascader=t},expression:"cascader"}})],1)],1)],1),a("a-layout",[a("a-layout-sider",{attrs:{mode:"inline","inline-collapsed":!0,collapsed:!0}},[a("a-menu",{on:{click:e.switchArea},model:{value:e.selectedKeys,callback:function(t){e.selectedKeys=t},expression:"selectedKeys"}},e._l(e.areasById,(function(t){return a("a-menu-item",{key:t.id},[a("a-icon",{attrs:{type:"environment"}}),e._v(" "+e._s(t.id)+" "),a("span",[e._v(". "+e._s(t.name))])],1)})),1)],1),a("a-layout",{staticClass:"area-edit"},[a("div",{style:{height:"500px"},attrs:{id:"map"}}),a("a-card",{staticClass:"floating-controller",attrs:{bodyStyle:{display:"flex",flexDirection:"column"}}},[a("a-button",{attrs:{type:"default"},on:{click:e.handleEdit}},[e._v("区域信息")]),a("a-button",{attrs:{type:"primary"},on:{click:e.saveArea}},[e._v("保存路径")]),a("div",{staticClass:"plain-button",attrs:{size:"large"}},[a("a-button",{attrs:{type:"default",icon:"plus"},on:{click:e.createPath}}),a("a-button",{attrs:{type:"danger",ghost:"",icon:"delete"},on:{click:e.removePath}})],1)],1)],1)],1),a("AddForm",{ref:"AddForm",on:{handleSubmit:e.initData}}),a("EditForm",{ref:"EditForm",on:{handleSubmit:e.initData}})],1)},r=[],i=a("5530"),o=a("3835"),l=a("1da1"),s=(a("96cf"),a("d81d"),a("4de4"),a("d3b7"),a("159b"),a("d9a1")),c=a("2af9"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"区域名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入区域名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入区域名称'}]}]"}]})],1),a("a-form-item",{attrs:{label:"选择地区",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("SelectRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["cascader",{rules:[{required:!0,message:"请选择省市区"}]}],expression:"['cascader', {rules: [{required: true, message: '请选择省市区'}]}]"}],attrs:{placeholder:"请选择省市区"}})],1)],1)],1)],1)},u=[],p={components:{SelectRegion:c["h"]},data:function(){return{title:"新增地址",labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this)}},methods:{add:function(){this.visible=!0},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.confirmLoading=!0;var a=Object(o["a"])(e.cascader,3),n=a[0],r=a[1],l=a[2];delete e.cascader,s["a"](Object(i["a"])(Object(i["a"])({},e),{},{province:n,city:r,district:l})).then((function(a){t.$message.success("创建成功",1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){t.confirmLoading=!1}))}}},m=p,f=a("2877"),h=Object(f["a"])(m,d,u,!1,null,null,null),v=h.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"区域名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入区域名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入区域名称'}]}]"}]})],1),a("a-form-item",{attrs:{label:"选择地区",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("SelectRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["cascader",{rules:[{required:!0,message:"请选择省市区"}]}],expression:"['cascader', {rules: [{required: true, message: '请选择省市区'}]}]"}],attrs:{placeholder:"请选择省市区"}})],1)],1)],1)],1)},b=[],y={components:{SelectRegion:c["h"]},data:function(){return{title:"编辑地址",labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),record:{}}},methods:{edit:function(e){this.visible=!0,this.record=e,this.setFieldsValue()},setFieldsValue:function(){var e=this.record,t=this.form.setFieldsValue;e.cascader=[e.province,e.city,e.district],this.$nextTick((function(){t(e)}))},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.confirmLoading=!0;var a=Object(o["a"])(e.cascader,3),n=a[0],r=a[1],l=a[2];delete e.cascader,s["c"](this.record.id,Object(i["a"])(Object(i["a"])({},e),{},{province:n,city:r,district:l})).then((function(a){t.$message.success("已修改",1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){t.confirmLoading=!1}))}}},w=y,C=Object(f["a"])(w,g,b,!1,null,null,null),A=C.exports,M=a("862d3"),_=a.n(M),k=a("2ef0"),x=a.n(k),I={name:"Index",components:{STable:c["c"],AddForm:v,EditForm:A,SelectRegion:c["h"]},data:function(){return{areasById:[],selectedKeys:[],queryParam:{per_page:100},cascader:[],isLoading:!1,Amap:null,map:{},polyEditor:null,polygons:[],columns:[{title:"所属区域ID",dataIndex:"delivery_area_id"},{title:"仓储名",dataIndex:"name"},{title:"联系人姓名",dataIndex:"contact_name"},{title:"联系电话",dataIndex:"contact_phone"},{title:"详细地址",dataIndex:"full_address",scopedSlots:{customRender:"full_address"}},{title:"评分",dataIndex:"rating"},{title:"添加时间",dataIndex:"created_at"},{title:"操作",dataIndex:"action",width:"180px",scopedSlots:{customRender:"action"}}]}},created:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return window._AMapSecurityConfig={securityJsCode:"cc376bf07ec7a861cbfada9c7de5b86f"},t.next=3,_.a.load({key:"8eed729112431178d5b9adaff42b33c1",version:"2.0",plugins:["AMap.PolygonEditor"]});case 3:return e.AMap=t.sent,e.map=new e.AMap.Map("map",{}),e.polyEditor=new AMap.PolygonEditor(e.map),e.polyEditor.on("add",(function(t){var a=t.target;e.polygons.push(a),e.polyEditor.addAdsorbPolygons(a),a.on("dblclick",(function(){e.polyEditor.setTarget(a),e.polyEditor.open()}))})),t.next=9,e.initData();case 9:case"end":return t.stop()}}),t)})))()},methods:{initData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["d"](e.queryParam).then((function(e){return e}));case 2:a=t.sent,e.areasById=x()(a.data).keyBy("id").value(),a.data.length?(n=e.selectedKeys[0],r=e.areasById[n]||a.data[0],e.selectedKeys=[r.id],e.loadPaths(r.paths)):(e.map.clearMap(),e.polyEditor.close());case 5:case"end":return t.stop()}}),t)})))()},handleAdd:function(){this.$refs.AddForm.add()},handleEdit:function(){var e=this.selectedKeys[0];e?this.$refs.EditForm.edit(this.areasById[e]):this.$message.error("当前未选中区域")},saveArea:function(){var e,t,a=this,n=this.selectedKeys[0];if(n){null===(e=this.polyEditor)||void 0===e||null===(t=e.close)||void 0===t||t.call(e);var r=this.polygons.map((function(e){return e.getPath()})).filter((function(e){return e.length}));s["c"](n,{paths:r}).then((function(e){a.areasById[n].paths=r,a.$message.success("更新成功",1.5)})).catch((function(e){a.$message.error(e.msg,3)}))}else this.$message.error("当前未选中区域")},handleDelete:function(e){var t=this,a=this.$confirm({title:"您确定要删除该记录吗?",content:"删除后不可恢复",onOk:function(){return s["deleted"](e.id).then((function(e){t.$this.$message.success("已删除",1.5),t.handleRefresh()})).finally((function(e){a.destroy()}))}})},onCascaderChange:function(e){var t=Object(o["a"])(e,3),a=t[0],n=t[1],r=t[2];this.queryParam=Object(i["a"])(Object(i["a"])({},this.queryParam),{},{province:a,city:n,district:r}),this.initData()},switchArea:function(e){this.loadPaths(this.areasById[e.key].paths,this.areasById[e.key].district||this.areasById[e.key].city||this.areasById[e.key].province)},loadPaths:function(e,t){var a=this;if(this.map){if(this.map.clearMap(),this.polyEditor.close(),!e||!e.length)return this.$message.error("暂无路径数据！"),void this.map.setCity(t);this.polygons=e.map((function(e){return new AMap.Polygon({path:e})})),this.map.add(this.polygons),this.map.setFitView(),this.polyEditor.addAdsorbPolygons(this.polygons),this.polygons.forEach((function(e){return e.on("dblclick",(function(){a.polyEditor.setTarget(e),a.polyEditor.open()}))})),this.polyEditor.setTarget(this.polygons[0]),this.polyEditor.open()}else this.$message.error("map还未完全加载，请刷新重试！")},createPath:function(){this.polyEditor.close(),this.polyEditor.setTarget(),this.polyEditor.open()},removePath:function(){var e=this.polyEditor.getTarget();this.map.remove(e),this.polyEditor.close(),this.polygons=this.polygons.filter((function(t){return t!=e}))}}},S=I,L=(a("c2d4"),Object(f["a"])(S,n,r,!1,null,"25b6422a",null));t["default"]=L.exports},d9a1:function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l}));a("ac1f"),a("5319");var n=a("b775"),r={list:"/areas",add:"/areas",edit:"/areas/{id}"};function i(e){return Object(n["b"])({url:r.list,method:"get",params:e})}function o(e){return Object(n["b"])({url:r.add,method:"post",data:e})}function l(e,t){return Object(n["b"])({url:r.edit.replace("{id}",e),method:"patch",data:t})}},f30f:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"card-title"},[e._v(e._s(e.$route.meta.title))]),a("div",{staticClass:"table-operator"},[a("a-row",[a("a-col",{attrs:{span:5}},[a("a-button",{directives:[{name:"action",rawName:"v-action:add",arg:"add"}],attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1),a("a-col",{staticClass:"flex flex-x-end",attrs:{span:11,offset:8}},[a("SelectRegion",{attrs:{placeholder:"请选择省市区"},on:{change:e.onCascaderChange},model:{value:e.cascader,callback:function(t){e.cascader=t},expression:"cascader"}}),a("a-input-search",{staticStyle:{"max-width":"300px","min-width":"150px"},attrs:{placeholder:"搜索名称地址联系人"},on:{search:e.onSearch},model:{value:e.queryParam.search,callback:function(t){e.$set(e.queryParam,"search",t)},expression:"queryParam.search"}})],1)],1)],1),a("s-table",{ref:"table",attrs:{rowKey:"id",loading:e.isLoading,columns:e.columns,data:e.loadData,pageSize:15},scopedSlots:e._u([{key:"full_address",fn:function(t){return a("span",{},[a("p",{staticClass:"twoline-hide",staticStyle:{width:"270px"}},[e._v(e._s(t))])])}},{key:"action",fn:function(t,n){return a("span",{},[a("a",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],staticStyle:{"margin-right":"8px"},on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),a("a",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}],on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除")])])}}])}),a("AddForm",{ref:"AddForm",on:{handleSubmit:e.handleRefresh}}),a("EditForm",{ref:"EditForm",on:{handleSubmit:e.handleRefresh}})],1)},r=[],i=a("3835"),o=a("5530"),l=(a("d3b7"),a("4d55")),s=a("2af9"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"仓储名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入仓储名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入仓储名称'}]}]"}]})],1),a("a-form-item",{attrs:{label:"联系人姓名",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact_name",{rules:[{required:!0,message:"请输入联系人姓名"}]}],expression:"['contact_name', {rules: [{required: true, message: '请输入联系人姓名'}]}]"}]})],1),a("a-form-item",{attrs:{label:"联系电话",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact_phone",{rules:[{required:!0,message:"请输入联系电话"}]}],expression:"['contact_phone', {rules: [{required: true, message: '请输入联系电话'}]}]"}]})],1),a("a-form-item",{attrs:{label:"选择地区",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("SelectRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["cascader",{rules:[{required:!0,message:"请选择省市区"}]}],expression:"['cascader', {rules: [{required: true, message: '请选择省市区'}]}]"}],attrs:{placeholder:"请选择省市区"},on:{change:e.onCascaderChange}})],1),a("a-form-item",{attrs:{label:"地图选点",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[e._v(" "+e._s(e.lng)+", "+e._s(e.lat)+" "),a("a-button",{attrs:{type:"primary"},on:{click:e.openSelectMap}},[e._v("打开地图选择位置")]),a("SelectMapPoint",{ref:"SelectMap",attrs:{lng:e.lng,lat:e.lat},on:{complete:e.onSelectMap},model:{value:e.showMap,callback:function(t){e.showMap=t},expression:"showMap"}})],1),a("a-form-item",{attrs:{label:"详细地址",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["address",{rules:[{required:!0,message:"请输入详细地址"}]}],expression:"['address', {rules: [{required: true, message: '请输入详细地址'}]}]"}]})],1),a("a-form-item",{attrs:{label:"所属区域",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["delivery_area_id",{rules:[{required:!1}]}],expression:"['delivery_area_id', {rules: [{required: false}]}]"}],attrs:{options:e.areas}})],1)],1)],1)],1)},d=[],u=a("1da1"),p=(a("96cf"),a("d81d"),a("b0c0"),a("99af"),a("d9a1")),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{visible:e.value,title:"请点击地图选择对应位置",forceRender:!0,"wrap-class-name":"full-modal",width:"100%"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("div",{attrs:{id:"map"}})])},f=[],h=(a("3b18"),a("f64c")),v=a("4d91"),g=a("862d3"),b=a.n(g),y={name:"SelectMapPoint",model:{prop:"value",event:"change"},props:{value:v["a"].bool.def(),lng:v["a"].any.def(),lat:v["a"].any.def()},data:function(){return{AMap:null,map:{},marker:null,city:null,longitude:null,latitude:null,address:null}},created:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return window._AMapSecurityConfig={securityJsCode:e.$store.state.AMap_securityJsCode},t.next=3,b.a.load({key:e.$store.state.AMap_key,version:"2.0",plugins:["AMap.Geocoder"]});case 3:e.AMap=t.sent,e.map=new e.AMap.Map("map",{}),e.city&&e.map.setCity(e.city),e.map.on("click",(function(t){e.marker&&e.map.remove(e.marker),e.longitude=t.lnglat.getLng(),e.latitude=t.lnglat.getLat(),e.marker=new e.AMap.Marker({position:new e.AMap.LngLat(e.longitude,e.latitude)}),e.map.add(e.marker)})),e.lng&&e.lat&&(e.marker&&e.map.remove(e.marker),e.marker=new e.AMap.Marker({position:new e.AMap.LngLat(e.lng,e.lat)}),e.map.add(e.marker));case 8:case"end":return t.stop()}}),t)})))()},methods:{onOpen:function(e){map&&(this.city=e.city||this.city,this.lng=e.lng||this.lng,this.lat=e.lat||this.lat,this.city&&this.map.setCity(this.city),this.lng&&this.lat?(this.marker&&this.map.remove(this.marker),this.marker=new this.AMap.Marker({position:new this.AMap.LngLat(this.lng,this.lat)}),this.map.add(this.marker)):this.marker&&this.map.remove(this.marker))},handleOk:function(e){var t=this;if(!this.longitude||!this.latitude)return h["a"].error("请先点击地图选择点",3),!1;this.AMap||h["a"].error("地图尚未初始化，请稍后或刷新重试",3);var a=new this.AMap.Geocoder({});a.getAddress([this.longitude,this.latitude],(function(e,a){if("complete"===e&&"OK"===a.info){var n,r,i=null===a||void 0===a||null===(n=a.regeocode)||void 0===n?void 0:n.addressComponent;t.address=i.township+i.street+i.streetNumber,t.address||(t.address=null===a||void 0===a||null===(r=a.regeocode)||void 0===r?void 0:r.formattedAddress)}t.$emit("change",!1),t.$emit("complete",{lng:t.longitude,lat:t.latitude,address:t.address})}))},handleCancel:function(e){this.$emit("change",!1)}}},w=y,C=(a("9f62"),a("2877")),A=Object(C["a"])(w,m,f,!1,null,"3caecfb4",null),M=A.exports,_={components:{SelectRegion:s["h"],SelectMapPoint:M},data:function(){return{title:"新增地址",labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),showMap:!1,lng:null,lat:null,areas:[],province:""}},created:function(){var e=this;p["d"]({per_page:100}).then((function(t){e.areas=t.data.map((function(e){return{value:e.id,label:e.name||"".concat(e.province,"_").concat(e.id)}}))}))},methods:{add:function(){this.visible=!0},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.confirmLoading=!0;var a=Object(i["a"])(e.cascader,3),n=a[0],r=a[1],s=a[2];delete e.cascader,l["a"](Object(o["a"])(Object(o["a"])({},e),{},{province:n,city:r,district:s,longitude:this.lng,latitude:this.lat})).then((function(a){t.$message.success("创建成功",1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){t.confirmLoading=!1}))},openSelectMap:function(){this.showMap=!0;var e=this.form,t=(e.setFieldsValue,e.getFieldsValue),a=t();this.$refs.SelectMap.onOpen({city:a.cascader[1]||a.cascader[0],lng:this.lng,lat:this.lat})},onSelectMap:function(e){var t=this.form,a=t.setFieldsValue,n=t.getFieldsValue;this.lng=e.lng,this.lat=e.lat;var r=n();r.address||(r.address=e.address,a(r))},onCascaderChange:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n="",e.length&&(n=e[0]),n==t.province){a.next=8;break}return a.next=5,p["d"]({province:n,per_page:100});case 5:r=a.sent,t.areas=r.data.map((function(e){return{value:e.id,label:e.name||"".concat(e.province,"_").concat(e.id)}})),t.province=n;case 8:case"end":return a.stop()}}),a)})))()}}},k=_,x=Object(C["a"])(k,c,d,!1,null,null,null),I=x.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"仓储名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入仓储名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入仓储名称'}]}]"}]})],1),a("a-form-item",{attrs:{label:"联系人姓名",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact_name",{rules:[{required:!0,message:"请输入联系人姓名"}]}],expression:"['contact_name', {rules: [{required: true, message: '请输入联系人姓名'}]}]"}]})],1),a("a-form-item",{attrs:{label:"联系电话",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact_phone",{rules:[{required:!0,message:"请输入联系电话"}]}],expression:"['contact_phone', {rules: [{required: true, message: '请输入联系电话'}]}]"}]})],1),a("a-form-item",{attrs:{label:"选择地区",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("SelectRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["cascader",{rules:[{required:!0,message:"请选择省市区"}]}],expression:"['cascader', {rules: [{required: true, message: '请选择省市区'}]}]"}],attrs:{placeholder:"请选择省市区"},on:{change:e.onCascaderChange}})],1),a("a-form-item",{attrs:{label:"地图选点",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[e._v(" "+e._s(e.lng)+", "+e._s(e.lat)+" "),a("a-button",{attrs:{type:"primary"},on:{click:e.openSelectMap}},[e._v("打开地图选择位置")]),a("SelectMapPoint",{ref:"SelectMap",attrs:{lng:e.lng,lat:e.lat},on:{complete:e.onSelectMap},model:{value:e.showMap,callback:function(t){e.showMap=t},expression:"showMap"}})],1),a("a-form-item",{attrs:{label:"详细地址",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["address",{rules:[{required:!0,message:"请输入详细地址"}]}],expression:"['address', {rules: [{required: true, message: '请输入详细地址'}]}]"}]})],1),a("a-form-item",{attrs:{label:"所属区域",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["delivery_area_id",{rules:[{required:!1}]}],expression:"['delivery_area_id', {rules: [{required: false}]}]"}],attrs:{options:e.areas}})],1)],1)],1)],1)},L=[],j=(a("88bc"),{components:{SelectRegion:s["h"],SelectMapPoint:M},data:function(){return{title:"编辑地址",labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),record:{},showMap:!1,lng:null,lat:null,areas:[],province:""}},methods:{edit:function(e){this.visible=!0,this.record=e,this.setFieldsValue()},setFieldsValue:function(){var e=this,t=this.record,a=this.form.setFieldsValue;t.cascader=[t.province,t.city,t.district],this.lng=t.longitude,this.lat=t.latitude,this.$nextTick((function(){a(t)})),p["d"]({province:t.province,per_page:100}).then((function(t){e.areas=t.data.map((function(e){return{value:e.id,label:e.name||"".concat(e.province,"_").concat(e.id)}}))})),this.province=t.province},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.confirmLoading=!0;var a=Object(i["a"])(e.cascader,3),n=a[0],r=a[1],s=a[2];delete e.cascader,l["d"](this.record.id,Object(o["a"])(Object(o["a"])({},e),{},{province:n,city:r,district:s,longitude:this.lng,latitude:this.lat})).then((function(a){t.$message.success("已修改",1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){t.confirmLoading=!1}))},openSelectMap:function(){this.showMap=!0;var e=this.form,t=(e.setFieldsValue,e.getFieldsValue),a=t();this.$refs.SelectMap.onOpen({city:a.cascader[1]||a.cascader[0],lng:this.lng,lat:this.lat})},onSelectMap:function(e){var t=this.form,a=t.setFieldsValue,n=t.getFieldsValue;this.lng=e.lng,this.lat=e.lat;var r=n();r.address||(r.address=e.address,a(r))},onCascaderChange:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n="",e.length&&(n=e[0]),n==t.province){a.next=8;break}return a.next=5,p["d"]({province:n,per_page:100});case 5:r=a.sent,t.areas=r.data.map((function(e){return{value:e.id,label:e.name||"".concat(e.province,"_").concat(e.id)}})),t.province=n;case 8:case"end":return a.stop()}}),a)})))()}}}),O=j,F=Object(C["a"])(O,S,L,!1,null,null,null),$=F.exports,E={name:"Index",components:{STable:s["c"],AddForm:I,EditForm:$,SelectRegion:s["h"]},data:function(){var e=this;return{queryParam:{},cascader:[],isLoading:!1,columns:[{title:"所属区域ID",dataIndex:"delivery_area_id"},{title:"仓储名",dataIndex:"name"},{title:"联系人姓名",dataIndex:"contact_name"},{title:"联系电话",dataIndex:"contact_phone"},{title:"详细地址",dataIndex:"full_address",scopedSlots:{customRender:"full_address"}},{title:"评分",dataIndex:"rating"},{title:"添加时间",dataIndex:"created_at"},{title:"操作",dataIndex:"action",width:"180px",scopedSlots:{customRender:"action"}}],loadData:function(t){return l["e"](Object(o["a"])(Object(o["a"])({},t),e.queryParam)).then((function(e){return e}))}}},created:function(){},methods:{handleAdd:function(){this.$refs.AddForm.add()},handleEdit:function(e){this.$refs.EditForm.edit(e)},handleDelete:function(e){var t=this,a=this.$confirm({title:"您确定要删除该记录吗?",content:"删除后不可恢复",onOk:function(){return l["c"](e.id).then((function(e){t.$message.success("已删除",1.5),t.handleRefresh()})).finally((function(e){a.destroy()}))}})},handleRefresh:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs.table.refresh(e)},onSearch:function(){this.handleRefresh(!0)},onCascaderChange:function(e){var t=Object(i["a"])(e,3),a=t[0],n=t[1],r=t[2];this.queryParam=Object(o["a"])(Object(o["a"])({},this.queryParam),{},{province:a,city:n,district:r}),this.handleRefresh(!0)}}},P=E,q=Object(C["a"])(P,n,r,!1,null,null,null);t["default"]=q.exports}}]);