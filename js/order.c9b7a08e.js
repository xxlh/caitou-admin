"use strict";(self["webpackChunkvue_antd_pro"]=self["webpackChunkvue_antd_pro"]||[]).push([[709],{38963:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var r=function(){var e=this,t=e._self._c;return t("div",[t("a-spin",{attrs:{spinning:e.isLoading}}),e.isLoading?e._e():t("div",{staticClass:"order-content"},[t("a-card",{attrs:{bordered:!1}},[t("div",{staticClass:"order-progress",class:"progress-".concat(e.progress)},[t("ul",[t("li",[t("span",[e._v("下单时间")]),t("div",{staticClass:"tip"},[e._v(e._s(e.record.created_at))])]),t("li",[t("span",[e._v("付款")]),e.record.paid_at?t("div",{staticClass:"tip"},[e._v("付款于 "+e._s(e.record.paid_at))]):e._e()]),t("li",[t("span",[e._v("发货")])]),t("li",[t("span",[e._v("收货")])]),t("li",[t("span",[e._v("完成")]),e.record.status==e.OrderStatusEnum.COMPLETED.value?t("div",{staticClass:"tip"},[e._v("完成于 "+e._s(e.record.receipt_time))]):e._e()])])])]),e.deal?t("a-card",{attrs:{bordered:!1}},[t("a-steps",{attrs:{current:e.dealProgress}},[t("a-step",{attrs:{title:"仓储打包中",description:"共 ".concat(e.deal.packings.length," 家仓储在打包")}}),t("a-step",{attrs:{title:"打包完成",description:e.deal.packed_at}}),t("a-step",{attrs:{title:"骑手到仓储点",description:e.deal.arrived_at}}),t("a-step",{attrs:{title:"配送中",description:e.dealProgress>=3?"于 ".concat(e.deal.fetched_at," 取到所有货品"):""}}),t("a-step",{attrs:{title:"已送达",description:e.deal.delivered_at}}),t("a-step",{attrs:{title:"已评价",description:e.deal.reviewed_at}})],1)],1):e._e(),t("a-card",{staticClass:"mt-20",attrs:{bordered:!1}},[e.record.status!=e.OrderStatusEnum.CANCELLED.value?[t("div",{staticClass:"ant-descriptions-title"},[e._v("订单操作")]),t("div",{staticClass:"alerts mt-10 mb-15"},[e.record.status==e.OrderStatusEnum.REFUNDING.value?t("a-alert",{attrs:{message:"当前买家已付款并申请取消订单，请审核是否同意，如同意则自动退回付款金额（原路退款）并关闭订单。",banner:""}}):e._e()],1),t("div",{staticClass:"actions clearfix mt-10"},[e.$auth("orders.updatePrice")?t("div",{staticClass:"action-item"},[e.record.paid_at?e._e():t("a-button",{on:{click:e.handleUpdatePrice}},[e._v("订单改价")])],1):e._e(),e.$auth("orders.deliver")?t("div",{staticClass:"action-item"},[e.deal?[e.record.paid_at&&[e.OrderStatusEnum.UNDELIVERED.value,e.OrderStatusEnum.UNRECEIVED.value].includes(e.record.status)&&!e.inArray(e.record.status,[e.OrderStatusEnum.CANCELLED.value,e.OrderStatusEnum.REFUNDING.value])?t("a-button",{attrs:{type:e.deal.delivery_man_id?"default":"primary"},on:{click:function(t){return e.handleDeliveryMan(e.record)}}},[e._v(e._s(e.deal.delivery_man_id?"改派骑士":"分配骑士"))]):e._e()]:[e.record.paid_at&&e.record.delivery_status==e.DeliveryStatusEnum.NOT_DELIVERED.value&&!e.inArray(e.record.status,[e.OrderStatusEnum.CANCELLED.value,e.OrderStatusEnum.REFUNDING.value])?t("a-button",{attrs:{type:"primary"},on:{click:e.handleDelivery}},[e._v("发货")]):e._e()]],2):e._e(),e.$auth("orders.cancel")?t("div",{staticClass:"action-item"},[e.record.status==e.OrderStatusEnum.REFUNDING.value?t("a-button",{attrs:{type:"primary"},on:{click:e.handleCancel}},[e._v("审核取消订单")]):e._e()],1):e._e()]),t("a-divider",{staticClass:"o-divider"})]:e._e(),t("a-descriptions",{attrs:{title:"订单信息"}},[t("a-descriptions-item",{attrs:{label:"订单号"}},[e._v(e._s(e.record.no))]),t("a-descriptions-item",{attrs:{label:"支付方式"}},[t("a-tag",{attrs:{color:"green"}},[e._v(e._s(e.PayTypeEnum[e.record.payment_method].name))])],1),t("a-descriptions-item",{attrs:{label:"实付款金额"}},[e._v("￥"+e._s(e.record.total_amount))]),t("a-descriptions-item",{attrs:{label:"配送方式"}}),t("a-descriptions-item",{attrs:{label:"运费金额"}},[e._v("￥"+e._s(e.record.freight))]),t("a-descriptions-item",{attrs:{label:"订单状态"}},[t("a-tag",{attrs:{color:e.renderOrderStatusColor(e.record.status)}},[e._v(e._s(e.OrderStatusEnum[e.record.status].name))])],1),t("a-descriptions-item",{attrs:{label:"买家信息"}},[t("a-tooltip",[t("template",{slot:"title"},[e._v("会员ID: "+e._s(e.user.id))]),t("span",{staticClass:"c-p"},[e._v(e._s(e.user.nickname))])],2)],1),t("a-descriptions-item",{attrs:{label:"买家留言"}},[e.record.remark?t("strong",[e._v(e._s(e.record.remark))]):t("span",[e._v("--")])]),e.deal?t("a-descriptions-item",{attrs:{label:"仓储信息"}},e._l(e.deal.packings,(function(a){return t("a-tooltip",{key:a.id,staticStyle:{"margin-right":"10px"}},[t("template",{slot:"title"},[e._v("仓储地址: "+e._s(a.address.full_address))]),a.store&&a.store.contact_phone?t("a",{attrs:{href:"tel://".concat(a.store.contact_phone)}},[t("span",{staticClass:"c-p"},[t("a-icon",{attrs:{type:"phone"}}),e._v(" "+e._s(a.name))],1)]):t("span",[e._v(e._s(a.name))])],2)})),1):e._e(),e.deal?t("a-descriptions-item",{attrs:{label:"骑手信息"}},[e.deal.man?t("a-tooltip",{attrs:{title:e.deal.man&&e.deal.man.phone}},[e.deal.man.phone?t("a",{attrs:{href:"tel://".concat(e.deal.man.phone)}},[t("a-icon",{attrs:{type:"phone"}}),e._v(" 骑士-"+e._s(e.deal.man.name)+" ")],1):t("span",[e._v("骑士-"+e._s(e.deal.man.name))])]):t("span",[e._v("(尚未分配骑士)")])],1):e._e()],1)],2),t("a-card",{staticClass:"mt-20",attrs:{bordered:!1}},[t("div",{staticClass:"ant-descriptions-title"},[e._v("订单商品")]),t("div",{staticClass:"goods-list"},[t("a-table",{attrs:{rowKey:"id",columns:e.goodsColumns,dataSource:e.record.items,pagination:!1},scopedSlots:e._u([{key:"goodsInfo",fn:function(e,a){return[t("GoodsItem",{attrs:{data:{image:a.image||a.product.image,imageAlt:"商品图片",title:a.product.title,goodsProps:a.product.generic_spec}}})]}},{key:"no",fn:function(a){return t("span",{},[e._v(e._s(a||"--"))])}},{key:"price",fn:function(a,r){return[t("p",{class:{"f-through":r.is_user_grade}},[e._v("￥"+e._s(a))]),r.is_user_grade?t("p",[t("a-tooltip",[t("template",{slot:"title"},[t("span",{staticClass:"f-13"},[e._v("会员等级折扣价")])]),t("strong",[e._v("会员价：")]),t("span",[e._v("￥"+e._s(r.grade_goods_price))])],2)],1):e._e()]}},{key:"count",fn:function(a){return t("span",{},[e._v("x"+e._s(a))])}},{key:"total_price",fn:function(a,r){return t("span",{},[e._v("￥"+e._s(r.price*r.count))])}},{key:"store",fn:function(a,r){return[e.packingByStoreId[r.product_sku.store_id]?t("a-tooltip",[t("template",{slot:"title"},[t("div",{staticClass:"f-13"},[e._v("仓储电话："+e._s(e.packingByStoreId[r.product_sku.store_id].store.contact_phone))]),t("div",{staticClass:"f-13"},[e._v("骑士电话："+e._s(e.deal.man.phone))])]),t("span",{staticClass:"c-p"},[e._v(e._s(e.packingByStoreId[r.product_sku.store_id].name))]),t("a-tag",{staticStyle:{"margin-left":"5px"},attrs:{color:e.renderOrderStatusColor(e.packingByStoreId[r.product_sku.store_id].status)}},[e._v(e._s(e.OrderStatusEnum[e.packingByStoreId[r.product_sku.store_id].status].name))])],2):e._e()]}}],null,!1,3936819970)}),t("div",{staticClass:"order-price"},[t("table",{staticClass:"fl-r"},[t("tbody",[t("tr",[t("td",[e._v("订单总额：")]),t("td",[e._v("￥"+e._s(e.record.total_amount))])]),e.record.discount>0?t("tr",[t("td",[e._v("优惠券抵扣：")]),t("td",[e._v("-￥"+e._s(e.record.discount))])]):e._e(),e.record.points_money>0?t("tr",[t("td",[e._v("积分抵扣：")]),t("td",[e._v("-￥"+e._s(e.record.points_money))])]):e._e(),t("tr",[t("td",[e._v("运费金额：")]),t("td",[e._v("+￥"+e._s(e.record.freight))])]),t("tr",[t("td",[e._v("实付款金额：")]),t("td",[t("strong",[e._v("￥"+e._s(e.record.total_amount))])])])])])])],1)]),e.record.delivery_type==e.DeliveryTypeEnum.EXPRESS.value?t("a-card",{staticClass:"mt-20",attrs:{bordered:!1}},[t("a-descriptions",{attrs:{title:"收货信息"}},[t("a-descriptions-item",{attrs:{label:"收货人姓名"}},[e._v(e._s(e.record.address.name))]),t("a-descriptions-item",{attrs:{label:"联系电话"}},[e._v(e._s(e.record.address.phone))]),t("a-descriptions-item",{attrs:{label:"收货地区"}},[e._v(" "+e._s(e.record.address.region.province)+" "+e._s(e.record.address.region.city)+" "+e._s(e.record.address.region.region)+" ")]),t("a-descriptions-item",{attrs:{label:"详细地址"}},[e._v(e._s(e.record.address.detail))])],1),e.record.paid_at&&e.record.delivery_status==e.DeliveryStatusEnum.UNRECEIVED.value&&!e.inArray(e.record.status,[e.OrderStatusEnum.CANCELLED.value,e.OrderStatusEnum.REFUNDING.value])?[t("a-divider",{staticClass:"o-divider"}),t("a-descriptions",{attrs:{title:"发货信息"}},[t("a-descriptions-item",{attrs:{label:"物流公司"}},[e._v(e._s(e.record.express.express_name))]),t("a-descriptions-item",{attrs:{label:"物流单号"}},[e._v(e._s(e.record.express_no))]),t("a-descriptions-item",{attrs:{label:"发货状态"}},[t("a-tag",{attrs:{color:e.record.delivery_status==e.DeliveryStatusEnum.UNRECEIVED.value?"green":""}},[e._v(e._s(e.DeliveryStatusEnum[e.record.delivery_status].name))])],1),t("a-descriptions-item",{attrs:{label:"发货时间"}},[e._v(e._s(e.record.delivery_time))])],1)]:e._e()],2):e._e()],1),t("DeliveryForm",{ref:"DeliveryForm",on:{handleSubmit:e.handleRefresh}}),t("DeliveryManForm",{ref:"DeliveryManForm",on:{handleSubmit:e.handleRefresh}}),t("CancelForm",{ref:"CancelForm",on:{handleSubmit:e.handleRefresh}}),t("PriceForm",{ref:"PriceForm",on:{handleSubmit:e.handleRefresh}})],1)},s=[],n=a(75374),i=a(61145),o=a(7191),l=a(114),d=a(47187),u=a(34351),c=[{title:"商品信息",scopedSlots:{customRender:"goodsInfo"}},{title:"商品编码",dataIndex:"product_sku.no",scopedSlots:{customRender:"no"}},{title:"重量(Kg)",dataIndex:"product_sku.weight",scopedSlots:{customRender:"goods_weight"}},{title:"单价",dataIndex:"price",scopedSlots:{customRender:"price"}},{title:"购买数量",dataIndex:"count",scopedSlots:{customRender:"count"}},{title:"商品总价",dataIndex:"total_price",scopedSlots:{customRender:"total_price"}}],m=[{title:"仓储点",dataIndex:"store",scopedSlots:{customRender:"store"}}],p={name:"Index",components:{GoodsItem:l.O5,UserItem:l.Dn,DeliveryForm:d.Jd,DeliveryManForm:d.Z6,CancelForm:d.l4,PriceForm:d.i6},data:function(){return{DeliveryStatusEnum:u.ws,DeliveryTypeEnum:u.W8,OrderSourceEnum:u.B9,OrderStatusEnum:u.yk,PayStatusEnum:u.q5,PayTypeEnum:u.cB,ReceiptStatusEnum:u.Gq,inArray:i.RV,isLoading:!0,orderId:null,record:{},deal:{},user:{},reviews:{},packingByStoreId:{},progress:2,dealProgress:0,goodsColumns:c}},created:function(){this.orderId=this.$route.query.orderId,this.handleRefresh()},methods:{handleRefresh:function(){this.getDetail()},getDetail:function(){var e=this,t=this.orderId;this.isLoading=!0,o._0(t).then((function(t){e.record=t.order,e.deal=t.delivery_deal,e.user=t.user,e.reviews=t.reviews,e.initData()})).finally((function(){e.isLoading=!1}))},initData:function(){var e;this.initProgress(),this.deal&&(e=this.goodsColumns).push.apply(e,m),this.deal&&(this.packingByStoreId=_(this.deal.packings).keyBy("store_id").value())},initProgress:function(){var e=this.record,t=this.deal;this.progress=2,e.paid_at&&(this.progress+=1),e.ship_status===u.ws.NOT_DELIVERED.value&&(this.progress+=1),e.ship_status===u.Gq.RECEIVED.value&&(this.progress+=1),t&&("packing"==t.status&&(this.dealProgress=0),"packed"==t.status&&(this.dealProgress=1),"arrived"==t.status&&(this.dealProgress=2),"delivering"==t.status&&(this.dealProgress=3),"delivered"==t.status&&(this.dealProgress=4),"completed"==t.status&&(this.dealProgress=5))},renderOrderStatusColor:function(e){var t=this.OrderStatusEnum,a=(0,n.A)((0,n.A)((0,n.A)((0,n.A)({},t.NORMAL.value,""),t.CANCELLED.value,"red"),t.REFUNDING.value,"red"),t.COMPLETED.value,"green");return a[e]},handleDelivery:function(){var e=this.record;this.$refs.DeliveryForm.show(e)},handleDeliveryMan:function(e){this.$refs.DeliveryManForm.show(e)},handleCancel:function(){var e=this.record;this.$refs.CancelForm.show(e)},handleUpdatePrice:function(){var e=this.record;this.$refs.PriceForm.show(e)}}},v=p,h=a(81656),f=(0,h.A)(v,r,s,!1,null,"4ed9f9ee",null),g=f.exports},8429:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("a-spin",{attrs:{spinning:e.isLoading}},[t("div",{staticClass:"card-title"},[e._v(e._s(e.$route.meta.title))]),t("div",{staticClass:"table-operator"},[t("a-row",{staticClass:"row-item-search"},[t("a-form",{staticClass:"search-form",attrs:{form:e.searchForm,layout:"inline"},on:{submit:e.handleSearch}},[t("a-form-item",{attrs:{label:"订单查询"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["search"],expression:"['search']"}],staticStyle:{width:"342px"},attrs:{placeholder:"请输入关键词"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["searchType",{initialValue:"no"}],expression:"['searchType', { initialValue: 'no' }]"}],staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},slot:"addonBefore"},e._l(e.SearchTypeEnum,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])})),1)],1)],1),t("a-form-item",{attrs:{label:"优惠券ID"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["voucher_template_id"],expression:"['voucher_template_id']"}],attrs:{placeholder:"请输入优惠券ID"}})],1),t("a-form-item",{attrs:{label:"下单时间"}},[t("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["created_between"],expression:"['created_between']"}],attrs:{format:"YYYY-MM-DD"}})],1),t("a-form-item",{staticClass:"search-btn"},[t("a-button",{attrs:{type:"primary",icon:"search","html-type":"submit"}},[e._v("搜索")])],1),t("a-form-item",{staticClass:"search-btn"},[t("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1),t("div",{staticClass:"ant-table ant-table-scroll-position-left ant-table-default ant-table-bordered"},[t("div",{staticClass:"ant-table-content"},[t("div",{staticClass:"ant-table-body"},[t("table",[t("thead",{staticClass:"ant-table-thead"},[t("tr",e._l(e.columns,(function(a,r){return t("th",{key:r},[t("span",{staticClass:"ant-table-header-column"},[t("div",[t("span",{staticClass:"ant-table-column-title"},[e._v(e._s(a.title))])])])])})),0)]),t("tbody",{staticClass:"ant-table-tbody"},[e._l(e.orderList.data,(function(a){return[t("tr",{key:"order_".concat(a.id,"_1"),staticClass:"order-empty"},[t("td",{attrs:{colspan:"7"}})]),t("tr",{key:"order_".concat(a.id,"_2")},[t("td",{attrs:{colspan:"7"}},[t("span",{staticClass:"mr-20"},[e._v(e._s(a.created_at))]),t("span",{staticClass:"mr-20"},[e._v("订单号："+e._s(a.no))]),t("platform-icon",{attrs:{name:a.platform,showTips:!0}})],1)]),e._l(a.items,(function(r,s){return t("tr",{key:"orderGoods_".concat(a.id,"_").concat(s)},[t("td",[r.product?t("GoodsItem",{attrs:{data:{image:r.image||r.product.image,imageAlt:"商品图片",title:r.product.title,goodsProps:r.product.generic_spec}}}):e._e()],1),t("td",[t("p",[e._v("￥"+e._s(r.price))]),t("p",[e._v("×"+e._s(r.count))])]),0===s?[t("td",{attrs:{rowspan:a.items.length}},[t("p",[e._v("￥"+e._s(a.total_amount))]),t("p",{staticClass:"c-muted-1"},[e._v("(含运费：￥"+e._s(a.freight)+")")])]),t("td",{attrs:{rowspan:a.items.length}},[a.user?t("UserItem",{attrs:{user:a.user}}):t("span",[e._v(e._s(a.user.nickname))]),a.delivery_deal?[t("br"),t("br"),a.delivery_deal.man&&a.delivery_deal.man.phone?t("a",{attrs:{href:"tel://".concat(a.delivery_deal.man.phone)}},[t("a-icon",{attrs:{type:"phone"}}),e._v(" 骑士-"+e._s(a.delivery_deal.man.name))],1):e._e(),e._l(a.stores,(function(a){return[t("br"),a.contact_phone?t("a",{key:a.id,attrs:{href:"tel://".concat(a.contact_phone)}},[t("a-icon",{attrs:{type:"phone"}}),e._v(" 商家-"+e._s(a.name))],1):e._e()]}))]:e._e()],2),t("td",{attrs:{rowspan:a.items.length}},[t("p",{staticClass:"mtb-2"},[t("span",{staticClass:"f-13"},[e._v("付款状态：")]),t("a-tag",{attrs:{color:a.paid_at?"green":""}},[e._v(e._s(e.PayStatusEnum[a.paid_at?"SUCCESS":"PENDING"].name))])],1),t("p",{staticClass:"mtb-2"},[t("span",{staticClass:"f-13"},[e._v("发货状态：")]),t("a-tag",{attrs:{color:a.ship_status==e.DeliveryStatusEnum.DELIVERED.value?"green":""}},[e._v(e._s(e.DeliveryStatusEnum[a.ship_status].name))])],1),[e.OrderStatusEnum.UNDELIVERED.value,e.OrderStatusEnum.UNRECEIVED.value].includes(a.status)&&a.delivery_deal?t("p",{staticClass:"mtb-2"},[t("span",{staticClass:"f-13"},[e._v("配送状态：")]),t("a-tag",{attrs:{color:e.renderOrderStatusColor(a.status)}},[e._v(e._s(e.OrderStatusEnum[a.delivery_deal.status].name))])],1):t("p",{staticClass:"mtb-2"},[t("span",{staticClass:"f-13"},[e._v("收货状态：")]),t("a-tag",{attrs:{color:a.ship_status==e.ReceiptStatusEnum.RECEIVED.value?"green":""}},[e._v(e._s(e.ReceiptStatusEnum[a.ship_status].name))])],1),[e.OrderStatusEnum.CANCELLED.value,e.OrderStatusEnum.REFUNDING.value].includes(a.status)?t("p",{staticClass:"mtb-2"},[t("span",{staticClass:"f-13"},[e._v("订单状态：")]),t("a-tag",{attrs:{color:e.renderOrderStatusColor(a.status)}},[e._v(e._s(e.OrderStatusEnum[a.status].name))])],1):e._e()]),t("td",{attrs:{rowspan:a.items.length}},[t("div",{staticClass:"actions"},[e.$auth("orders.view")?t("router-link",{attrs:{to:{path:"/order/detail",query:{orderId:a.id}}}},[e._v("详情")]):e._e(),a.delivery_deal?[a.paid_at&&[e.OrderStatusEnum.UNDELIVERED.value,e.OrderStatusEnum.UNRECEIVED.value].includes(a.status)&&!e.inArray(a.status,[e.OrderStatusEnum.CANCELLED.value,e.OrderStatusEnum.REFUNDING.value])?t("a",{directives:[{name:"action",rawName:"v-action:cancel",arg:"cancel"}],on:{click:function(t){return e.handleDeliveryMan(a)}}},[e._v(e._s(a.delivery_deal.delivery_man_id?"改派骑士":"分配骑士"))]):e._e()]:[a.paid_at&&a.ship_status==e.DeliveryStatusEnum.NOT_DELIVERED.value&&!e.inArray(a.status,[e.OrderStatusEnum.CANCELLED.value,e.OrderStatusEnum.REFUNDING.value])?t("a",{directives:[{name:"action",rawName:"v-action:cancel",arg:"cancel"}],on:{click:function(t){return e.handleDelivery(a)}}},[e._v("发货")]):e._e()],a.status==e.OrderStatusEnum.REFUNDING.value?t("a",{directives:[{name:"action",rawName:"v-action:cancel",arg:"cancel"}],on:{click:function(t){return e.handleCancel(a)}}},[e._v("审核取消")]):e._e(),t("a",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}],on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])],2)])]:e._e()],2)}))]}))],2)])]),e.orderList.data.length?e._e():t("a-empty",{attrs:{image:e.simpleImage}})],1)]),e.orderList.data.length?t("div",{staticClass:"pagination"},[t("a-pagination",{attrs:{current:e.page,pageSize:e.orderList.per_page,total:e.orderList.total},on:{change:e.onChangePage}})],1):e._e(),t("DeliveryForm",{ref:"DeliveryForm",on:{handleSubmit:e.handleRefresh}}),t("DeliveryManForm",{ref:"DeliveryManForm",on:{handleSubmit:e.handleRefresh}}),t("CancelForm",{ref:"CancelForm",on:{handleSubmit:e.handleRefresh}})],1)],1)},s=[],n=a(75374),i=a(57888),o=(a(27377),a(2970)),l=a(61145),d=a(7191),u=a(15115),c=a(73260),m=a(114),p=a(34351),v=a(47187),_=a(47026),h=[{title:"商品信息",align:"center",dataIndex:"items",scopedSlots:{customRender:"goods"}},{title:"单价/数量",align:"center",scopedSlots:{customRender:"unit_price"}},{title:"实付款",align:"center",dataIndex:"total_amount",scopedSlots:{customRender:"total_amount"}},{title:"买家 / 骑士 / 商家",dataIndex:"user",scopedSlots:{customRender:"user"}},{title:"交易状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",width:"180px",scopedSlots:{customRender:"action"}}],f=[{name:"订单号",value:"no"},{name:"备注",value:"remark"},{name:"会员昵称",value:"nickname"},{name:"会员ID",value:"userid"}],g={name:"Index",components:{PlatformIcon:c.A,GoodsItem:m.O5,UserItem:m.Dn,DeliveryForm:v.Jd,DeliveryManForm:v.Z6,CancelForm:v.l4},data:function(){return{dataType:this.getDataType(),searchForm:this.$form.createForm(this),queryParam:{area_id:_.A.getters.areaId},searchParams:{},isLoading:!1,columns:h,page:1,orderList:{data:[],total:0,per_page:10}}},beforeCreate:function(){(0,l.mU)(this,{inArray:l.RV,DeliveryStatusEnum:p.ws,DeliveryTypeEnum:p.W8,OrderSourceEnum:p.B9,OrderStatusEnum:p.yk,PayStatusEnum:p.q5,PayTypeEnum:p.cB,ReceiptStatusEnum:p.Gq,SearchTypeEnum:f,simpleImage:o.Ay.PRESENTED_IMAGE_SIMPLE})},created:function(){this.init()},watch:{$route:function(){this.init()}},methods:{init:function(){this.dataType=this.getDataType(),this.searchForm.resetFields(),this.queryParam={area_id:_.A.getters.areaId},this.handleRefresh(!0)},getDataType:function(){return this.$route.path.split("/")[3]},getList:function(){var e=this,t=this.dataType,a=this.queryParam,r=this.searchParams,s=this.page;return this.isLoading=!0,d.p_((0,i.A)((0,i.A)((0,i.A)({status:t},a),r),{},{page:s})).then((function(t){e.orderList=t})).finally((function(){e.isLoading=!1}))},renderOrderStatusColor:function(e){var t=this.OrderStatusEnum,a=(0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)({},t.NORMAL.value,""),t.CANCELLED.value,"red"),t.REFUNDING.value,"red"),t.COMPLETED.value,"green"),t.UNREVIEWED.value,"green"),t.DELIVERED.value,"green");return a[e]},handleRefresh:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.page=1),this.getList()},handleSearch:function(e){var t=this;e.preventDefault(),this.searchForm.validateFields((function(e,a){e||(t.queryParam=(0,i.A)((0,i.A)({},t.queryParam),a),"no"==t.queryParam.searchType?t.searchParams={no:t.queryParam.search}:"nickname"==t.queryParam.searchType?t.searchParams={user_nickname:t.queryParam.search}:"userid"==t.queryParam.searchType&&(t.searchParams={user_id:t.queryParam.search}),delete t.queryParam.search,delete t.queryParam.searchType,t.handleRefresh(!0))}))},handleReset:function(){this.searchForm.resetFields()},onChangePage:function(e){this.page=e,this.handleRefresh()},handleDelete:function(e){var t=this,a=t.$confirm({title:"您确定要删除该订单记录吗?",content:"删除后不可恢复，请谨慎操作",onOk:function(){return u.KF(e.id).then((function(e){t.$message.success(e.message,1.5),t.handleRefresh()})).finally((function(e){a.destroy()}))}})},handleDelivery:function(e){this.$refs.DeliveryForm.show(e)},handleDeliveryMan:function(e){this.$refs.DeliveryManForm.show(e)},handleCancel:function(e){this.$refs.CancelForm.show(e)}}},y=g,E=a(81656),b=(0,E.A)(y,r,s,!1,null,"716da390",null),C=b.exports},69074:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("a-spin",{attrs:{spinning:e.isLoading}},[t("div",{staticClass:"card-title"},[e._v(e._s(e.$route.meta.title))]),t("div",{staticClass:"table-operator"},[t("a-row",{staticClass:"row-item-search"},[t("a-form",{staticClass:"search-form",attrs:{form:e.searchForm,layout:"inline"},on:{submit:e.handleSearch}},[t("a-form-item",{attrs:{label:"订单查询"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["search"],expression:"['search']"}],staticStyle:{width:"342px"},attrs:{placeholder:"请输入关键词"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["searchType",{initialValue:"ids"}],expression:"['searchType', { initialValue: 'ids' }]"}],staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},slot:"addonBefore"},e._l(e.SearchTypeEnum,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])})),1)],1)],1),t("a-form-item",{attrs:{label:"支付方式"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["payment_method",{initialValue:-1}],expression:"['payment_method', { initialValue: -1 }]"}]},[t("a-select-option",{attrs:{value:-1}},[e._v("全部")]),e._l(e.PayTypeEnum.data,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])}))],2)],1),t("a-form-item",{attrs:{label:"下单时间"}},[t("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["created_between"],expression:"['created_between']"}],attrs:{format:"YYYY-MM-DD"}})],1),t("a-form-item",{staticClass:"search-btn"},[t("a-button",{attrs:{type:"primary",icon:"search","html-type":"submit"}},[e._v("搜索")])],1),t("a-form-item",{staticClass:"search-btn"},[t("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1),t("div",{staticClass:"ant-table ant-table-scroll-position-left ant-table-default ant-table-bordered"},[t("div",{staticClass:"ant-table-content"},[t("div",{staticClass:"ant-table-body"},[t("table",[t("thead",{staticClass:"ant-table-thead"},[t("tr",e._l(e.columns,(function(a,r){return t("th",{key:r},[t("span",{staticClass:"ant-table-header-column"},[t("div",[t("span",{staticClass:"ant-table-column-title"},[e._v(e._s(a.title))])])])])})),0)]),t("tbody",{staticClass:"ant-table-tbody"},[e._l(e.dealList.data,(function(a){return[t("tr",{key:"order_".concat(a.id,"_1"),staticClass:"order-empty"},[t("td",{attrs:{colspan:"7"}})]),t("tr",{key:"order_".concat(a.id,"_2")},[t("td",{attrs:{colspan:"7"}},[t("span",{staticClass:"mr-20"},[e._v(e._s(a.created_at))]),t("span",{staticClass:"mr-20"},[e._v("配送单号："+e._s(a.id))]),t("platform-icon",{attrs:{name:a.platform,showTips:!0}})],1)]),e._l(a.packings,(function(r,s){return t("tr",{key:"orderGoods_".concat(a.id,"_").concat(s)},[t("td",[r.items.length?t("GoodsItem",{attrs:{data:{image:r.items[0].image,imageAlt:"商品图片",title:r.items[0].title+"...等"}}}):e._e()],1),t("td",[t("p",[e._v("共计"+e._s(r.items.reduce((function(e,t){return e+parseInt(t.count)}),0))+"件商品")])]),t("td",[t("a-tooltip",[t("template",{slot:"title"},[e._v("仓储地址: "+e._s(r.address.full_address))]),t("span",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(r.name))]),t("a-tag",{attrs:{color:e.renderOrderStatusColor(r.status)}},[e._v(e._s(e.OrderStatusEnum[r.status].name))])],2)],1),0===s?[t("td",{attrs:{rowspan:a.items.length}},[a.man&&a.man.phone?t("a",{attrs:{href:"tel://".concat(a.man.phone)}},[t("a-icon",{attrs:{type:"phone"}}),e._v(" 骑士-"+e._s(a.man.name)+" ")],1):e._e()]),t("td",{attrs:{rowspan:a.items.length}},[t("a-tooltip",[t("template",{slot:"title"},[e._v("送达地址: "+e._s(a.address.full_address))]),a.address&&a.address.contact_phone?t("a",{attrs:{href:"tel://".concat(a.address.contact_phone)}},[t("span",{staticClass:"c-p"},[t("a-icon",{attrs:{type:"phone"}}),e._v(" "+e._s(a.address.contact_name))],1)]):t("span",[e._v(e._s(a.address.contact_name))])],2)],1),t("td",{attrs:{rowspan:a.items.length}},[t("a-tag",{attrs:{color:e.renderOrderStatusColor(a.status)}},[e._v(e._s(e.OrderStatusEnum[a.status].name))])],1),t("td",{attrs:{rowspan:a.items.length}},[t("div",{staticClass:"actions"},[e.$auth("orders.view")?t("router-link",{attrs:{to:{path:"/order/detail",query:{orderId:a.order_id}}}},[e._v("详情")]):e._e(),[e.OrderStatusEnum.UNDELIVERED.value,e.OrderStatusEnum.UNRECEIVED.value].includes(a.status)&&!e.inArray(a.status,[e.OrderStatusEnum.CANCELLED.value,e.OrderStatusEnum.REFUNDING.value])?t("a",{directives:[{name:"action",rawName:"v-action:cancel",arg:"cancel"}],on:{click:function(t){return e.handleDeliveryMan(a)}}},[e._v(e._s(a.delivery_deal.delivery_man_id?"改派骑士":"分配骑士"))]):e._e(),t("a",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}],on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])],1)])]:e._e()],2)}))]}))],2)])]),e.dealList.data.length?e._e():t("a-empty",{attrs:{image:e.simpleImage}})],1)]),e.dealList.data.length?t("div",{staticClass:"pagination"},[t("a-pagination",{attrs:{current:e.page,pageSize:e.dealList.per_page,total:e.dealList.total},on:{change:e.onChangePage}})],1):e._e(),t("DeliveryManForm",{ref:"DeliveryManForm",on:{handleSubmit:e.handleRefresh}})],1)],1)},s=[],n=a(75374),i=a(57888),o=(a(27377),a(2970)),l=a(61145),d=a(14693),u=a(15115),c=a(73260),m=a(114),p=a(34351),v=a(47187),_=[{title:"商品信息",align:"center",dataIndex:"items",scopedSlots:{customRender:"goods"}},{title:"数量",align:"center",scopedSlots:{customRender:"unit_price"}},{title:"仓储",align:"center",dataIndex:"store",scopedSlots:{customRender:"store"}},{title:"骑士",dataIndex:"man",scopedSlots:{customRender:"man"}},{title:"送达",dataIndex:"user",scopedSlots:{customRender:"user"}},{title:"交易状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",width:"180px",scopedSlots:{customRender:"action"}}],h=[{name:"配送单号",value:"ids"},{name:"订单号",value:"order_ids"},{name:"骑士名",value:"man_name"},{name:"送达地址",value:"address"}],f={name:"Index",components:{PlatformIcon:c.A,GoodsItem:m.O5,UserItem:m.Dn,DeliveryManForm:v.Z6},data:function(){return{dataType:this.getDataType(),searchForm:this.$form.createForm(this),queryParam:{},searchParams:{},isLoading:!1,columns:_,page:1,dealList:{data:[],total:0,per_page:10}}},beforeCreate:function(){(0,l.mU)(this,{inArray:l.RV,DeliveryTypeEnum:p.W8,OrderSourceEnum:p.B9,OrderStatusEnum:p.yk,PayStatusEnum:p.q5,PayTypeEnum:p.cB,ReceiptStatusEnum:p.Gq,SearchTypeEnum:h,simpleImage:o.Ay.PRESENTED_IMAGE_SIMPLE})},created:function(){this.init()},watch:{$route:function(){this.init()}},methods:{init:function(){this.dataType=this.getDataType(),this.searchForm.resetFields(),this.queryParam={},this.handleRefresh(!0)},getDataType:function(){return this.$route.path.split("/")[3]},getList:function(){var e=this,t=this.dataType,a=this.queryParam,r=this.searchParams,s=this.page;return this.isLoading=!0,d.p_((0,i.A)((0,i.A)((0,i.A)({status:t},a),r),{},{page:s})).then((function(t){e.dealList=t})).finally((function(){e.isLoading=!1}))},renderOrderStatusColor:function(e){var t=this.OrderStatusEnum,a=(0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)({},t.NORMAL.value,""),t.CANCELLED.value,"red"),t.REFUNDING.value,"red"),t.COMPLETED.value,"green"),t.UNREVIEWED.value,"green"),t.DELIVERED.value,"green");return a[e]},handleRefresh:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.page=1),this.getList()},handleSearch:function(e){var t=this;e.preventDefault(),this.searchForm.validateFields((function(e,a){e||(t.queryParam=(0,i.A)((0,i.A)({},t.queryParam),a),"ids"==t.queryParam.searchType?t.searchParams={ids:t.queryParam.search}:"order_ids"==t.queryParam.searchType?t.searchParams={order_ids:t.queryParam.search}:"man_name"==t.queryParam.searchType?t.searchParams={man_name:t.queryParam.search}:"address"==t.queryParam.searchType&&(t.searchParams={address:t.queryParam.search}),delete t.queryParam.search,delete t.queryParam.searchType,t.handleRefresh(!0))}))},handleReset:function(){this.searchForm.resetFields()},onChangePage:function(e){this.page=e,this.handleRefresh()},handleDelete:function(e){var t=this,a=t.$confirm({title:"您确定要删除该订单记录吗?",content:"删除后不可恢复，请谨慎操作",onOk:function(){return u.KF(e.id).then((function(e){t.$message.success(e.message,1.5),t.handleRefresh()})).finally((function(e){a.destroy()}))}})},handleDeliveryMan:function(e){this.$refs.DeliveryManForm.show(e)}}},g=f,y=a(81656),E=(0,y.A)(g,r,s,!1,null,"b81b41c0",null),b=E.exports},33475:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var r=function(){var e=this,t=e._self._c;return t("div",[t("a-spin",{attrs:{spinning:e.isLoading}}),e.isLoading?e._e():t("div",{staticClass:"detail-content"},[t("a-card",{attrs:{bordered:!1}},[e.record.status==e.RefundStatusEnum.NORMAL.value?t("div",{staticClass:"detail-actions"},[t("div",{staticClass:"ant-descriptions-title"},[e._v("售后单操作")]),t("div",{staticClass:"alerts mt-10 mb-15"},[e.record.audit_status==e.AuditStatusEnum.WAIT.value?t("a-alert",{attrs:{message:"当前买家已发起售后申请，请及时审核处理",banner:""}}):e._e()],1),t("div",{staticClass:"actions mt-10"},[e.$auth("orders.refund")?t("div",[e.record.audit_status==e.AuditStatusEnum.WAIT.value?t("a-button",{attrs:{type:"primary"},on:{click:e.handleAudit}},[e._v("商家审核")]):e._e()],1):e._e(),e.$auth("orders.refund")?t("div",[e.record.type==e.RefundTypeEnum.RETURN.value&&e.record.audit_status==e.AuditStatusEnum.REVIEWED.value&&e.record.is_user_send&&!e.record.is_receipt?t("a-button",{attrs:{type:"primary"},on:{click:e.handleReceipt}},[e._v("确认收货")]):e._e()],1):e._e()]),t("a-divider",{staticClass:"o-divider"})],1):e._e(),t("a-descriptions",{attrs:{title:"售后单信息"}},[t("a-descriptions-item",{attrs:{label:"订单号"}},[t("router-link",{attrs:{title:"查看订单详情",to:{path:"/order/detail",query:{orderId:e.record.order_id}},target:"_blank"}},[e._v(e._s(e.record.orderData.order_no))])],1),t("a-descriptions-item",{attrs:{label:"买家信息"}},[t("a-tooltip",[t("template",{slot:"title"},[e._v("会员ID: "+e._s(e.record.user.user_id))]),t("span",{staticClass:"c-p"},[e._v(e._s(e.record.user.nick_name))])],2)],1),t("a-descriptions-item",{attrs:{label:"订单支付总额"}},[t("span",{staticClass:"c-p"},[t("span",[e._v("￥")]),t("span",[e._v(e._s(e.record.orderData.pay_price))])])]),t("a-descriptions-item",{attrs:{label:"售后类型"}},[t("a-tag",[e._v(e._s(e.RefundTypeEnum[e.record.type].name))])],1),t("a-descriptions-item",{attrs:{label:"售后单状态"}},[t("a-tag",{attrs:{color:e.renderRefundStatusColor(e.record.status)}},[e._v(e._s(e.RefundStatusEnum[e.record.status].name))])],1),t("a-descriptions-item",{attrs:{label:"申请时间"}},[e._v(e._s(e.record.create_time))])],1),t("a-divider",{staticClass:"o-divider"}),t("a-descriptions",{attrs:{title:"处理进度"}},[t("a-descriptions-item",{attrs:{label:"审核状态 (商家)"}},[t("a-tag",{attrs:{color:e.renderAuditStatusColor(e.record.audit_status)}},[e._v(e._s(e.AuditStatusEnum[e.record.audit_status].name))])],1),e.record.type==e.RefundTypeEnum.RETURN.value?t("a-descriptions-item",{attrs:{label:"发货状态 (买家)"}},[t("a-tag",{attrs:{color:e.record.is_user_send?"green":""}},[e._v(e._s(e.record.is_user_send?"已发货":"待发货"))])],1):e._e(),e.record.type==e.RefundTypeEnum.RETURN.value?t("a-descriptions-item",{attrs:{label:"收货状态 (商家)"}},[t("a-tag",{attrs:{color:e.record.is_receipt?"green":""}},[e._v(e._s(e.record.is_receipt?"已收货":"待收货"))])],1):e._e(),e.record.audit_status==e.AuditStatusEnum.REJECTED.value?t("a-descriptions-item",{attrs:{label:"拒绝原因"}},[t("span",[e._v(e._s(e.record.refuse_desc))])]):e._e()],1)],1),t("a-card",{staticClass:"mt-20",attrs:{bordered:!1}},[t("a-descriptions",{attrs:{title:"买家申请原因"}},[t("a-descriptions-item",{attrs:{label:"售后描述"}},[e._v(e._s(e.record.apply_desc?e.record.apply_desc:"--"))])],1),e.record.images.length?[t("a-divider",{staticClass:"o-divider"}),t("a-descriptions",{attrs:{title:"申请凭证"}},[t("a-descriptions-item",[t("div",{staticClass:"image-list"},e._l(e.record.images,(function(e){return t("div",{key:e.image_id,staticClass:"file-item"},[t("a",{attrs:{href:e.image_url,target:"_blank"}},[t("div",{staticClass:"img-cover",style:{backgroundImage:"url('".concat(e.image_url,"')")}})])])})),0)])],1)]:e._e()],2),t("a-card",{staticClass:"mt-20",attrs:{bordered:!1}},[t("div",{staticClass:"ant-descriptions-title"},[e._v("售后商品")]),t("div",{staticClass:"goods-list"},[t("a-table",{attrs:{rowKey:"order_goods_id",columns:e.goodsColumns,dataSource:[e.record.orderGoods],pagination:!1},scopedSlots:e._u([{key:"goodsInfo",fn:function(e,a){return[t("GoodsItem",{attrs:{data:{image:a.goods_image,imageAlt:"商品图片",title:a.goods_name,goodsProps:a.goods_props}}})]}},{key:"goods_no",fn:function(a){return t("span",{},[e._v(e._s(a||"--"))])}},{key:"goods_price",fn:function(t){return[e._v("￥"+e._s(t))]}},{key:"total_num",fn:function(a){return t("span",{},[e._v("x"+e._s(a))])}},{key:"total_pay_price",fn:function(a){return t("span",{},[e._v("￥"+e._s(a))])}}],null,!1,113254456)})],1)]),e.record.audit_status==e.AuditStatusEnum.REVIEWED.value?t("a-card",{staticClass:"mt-20",attrs:{bordered:!1}},[t("a-descriptions",{attrs:{title:"商家退货地址"}},[t("a-descriptions-item",{attrs:{label:"收货人姓名"}},[e._v(e._s(e.record.address.name))]),t("a-descriptions-item",{attrs:{label:"联系电话"}},[e._v(e._s(e.record.address.phone))]),t("a-descriptions-item",{attrs:{label:"所在地区"}},e._l(e.record.address.region,(function(a,r){return t("span",{key:r,staticClass:"region mr-5"},[e._v(e._s(a))])})),0),t("a-descriptions-item",{attrs:{label:"详细地址"}},[e._v(e._s(e.record.address.detail))])],1)],1):e._e(),e.record.type==e.RefundTypeEnum.RETURN.value&&e.record.audit_status==e.AuditStatusEnum.REVIEWED.value&&e.record.is_user_send?t("a-card",{staticClass:"mt-20",attrs:{bordered:!1}},[t("a-descriptions",{attrs:{title:"退货物流信息"}},[t("a-descriptions-item",{attrs:{label:"物流公司"}},[e._v(e._s(e.record.express.express_name))]),t("a-descriptions-item",{attrs:{label:"物流单号"}},[e._v(e._s(e.record.express_no))]),t("a-descriptions-item",{attrs:{label:"发货状态"}},[t("a-tag",{attrs:{color:e.record.is_user_send?"green":""}},[e._v(e._s(e.record.is_user_send?"已发货":"待发货"))])],1),t("a-descriptions-item",{attrs:{label:"发货时间"}},[e._v(e._s(e.record.send_time))])],1)],1):e._e()],1),t("AuditForm",{ref:"AuditForm",on:{handleSubmit:e.handleRefresh}}),t("ReceiptForm",{ref:"ReceiptForm",on:{handleSubmit:e.handleRefresh}})],1)},s=[],n=a(75374),i=a(61145),o=a(21689),l=a(114),d=a(83472),u=a(76133),c=[{title:"商品信息",scopedSlots:{customRender:"goodsInfo"}},{title:"商品编码",dataIndex:"goods_no",scopedSlots:{customRender:"goods_no"}},{title:"重量(Kg)",dataIndex:"goods_weight",scopedSlots:{customRender:"goods_weight"}},{title:"单价",dataIndex:"goods_price",scopedSlots:{customRender:"goods_price"}},{title:"购买数量",dataIndex:"total_num",scopedSlots:{customRender:"total_num"}},{title:"实际付款价",dataIndex:"total_pay_price",scopedSlots:{customRender:"total_pay_price"}}],m={name:"Index",components:{GoodsItem:l.O5,UserItem:l.Dn,AuditForm:u.c,ReceiptForm:u.F},data:function(){return{isLoading:!0,orderRefundId:null,record:{},goodsColumns:c,goodsList:[]}},beforeCreate:function(){(0,i.mU)(this,{AuditStatusEnum:d.Hy,RefundStatusEnum:d.eS,RefundTypeEnum:d.Us})},created:function(){this.orderRefundId=this.$route.query.orderRefundId,this.handleRefresh()},methods:{handleRefresh:function(){this.getDetail()},getDetail:function(){var e=this,t=this.orderRefundId;this.isLoading=!0,o._0({orderRefundId:t}).then((function(t){e.record=t.data.detail,e.goodsList=[e.record.orderGoods]})).finally((function(){e.isLoading=!1}))},renderAuditStatusColor:function(e){var t=this.AuditStatusEnum,a=(0,n.A)((0,n.A)((0,n.A)({},t.WAIT.value,""),t.REVIEWED.value,"green"),t.REJECTED.value,"red");return a[e]},renderRefundStatusColor:function(e){var t=this.RefundStatusEnum,a=(0,n.A)((0,n.A)((0,n.A)((0,n.A)({},t.NORMAL.value,""),t.REJECTED.value,"red"),t.COMPLETED.value,"green"),t.CANCELLED.value,"red");return a[e]},handleAudit:function(){var e=this.record;this.$refs.AuditForm.show(e)},handleReceipt:function(){var e=this.record;this.$refs.ReceiptForm.show(e)}}},p=m,v=a(81656),_=(0,v.A)(p,r,s,!1,null,"11f9649f",null),h=_.exports},38965:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{bordered:!1}},[t("a-spin",{attrs:{spinning:e.isLoading}},[t("div",{staticClass:"card-title"},[e._v(e._s(e.$route.meta.title))]),t("div",{staticClass:"table-operator"},[t("a-row",{staticClass:"row-item-search"},[t("a-form",{staticClass:"search-form",attrs:{form:e.searchForm,layout:"inline"},on:{submit:e.handleSearch}},[t("a-form-item",{attrs:{label:"关键词查询"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["searchValue"],expression:"['searchValue']"}],staticStyle:{width:"342px"},attrs:{placeholder:"请输入关键词"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["searchType",{initialValue:10}],expression:"['searchType', { initialValue: 10 }]"}],staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},slot:"addonBefore"},e._l(e.SearchTypeEnum,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])})),1)],1)],1),t("a-form-item",{attrs:{label:"售后类型"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["refundType",{initialValue:-1}],expression:"['refundType', { initialValue: -1 }]"}]},[t("a-select-option",{attrs:{value:-1}},[e._v("全部")]),e._l(e.RefundTypeEnum.data,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])}))],2)],1),t("a-form-item",{attrs:{label:"售后单状态"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["refundStatus",{initialValue:-1}],expression:"['refundStatus', { initialValue: -1 }]"}]},[t("a-select-option",{attrs:{value:-1}},[e._v("全部")]),e._l(e.RefundStatusEnum.data,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])}))],2)],1),t("a-form-item",{attrs:{label:"申请时间"}},[t("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["betweenTime"],expression:"['betweenTime']"}],attrs:{format:"YYYY-MM-DD"}})],1),t("a-form-item",{staticClass:"search-btn"},[t("a-button",{attrs:{type:"primary",icon:"search","html-type":"submit"}},[e._v("搜索")])],1),t("a-form-item",{staticClass:"search-btn"},[t("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1),t("div",{staticClass:"ant-table ant-table-scroll-position-left ant-table-default ant-table-bordered"},[t("div",{staticClass:"ant-table-content"},[t("div",{staticClass:"ant-table-body"},[t("table",[t("thead",{staticClass:"ant-table-thead"},[t("tr",e._l(e.columns,(function(a,r){return t("th",{key:r},[t("span",{staticClass:"ant-table-header-column"},[t("div",[t("span",{staticClass:"ant-table-column-title"},[e._v(e._s(a.title))])])])])})),0)]),t("tbody",{staticClass:"ant-table-tbody"},[e._l(e.refundList.data,(function(a){return[t("tr",{key:"refund_".concat(a.order_refund_id,"_1"),staticClass:"order-empty"},[t("td",{attrs:{colspan:"8"}})]),t("tr",{key:"refund_".concat(a.order_refund_id,"_2")},[t("td",{attrs:{colspan:"8"}},[t("span",{staticClass:"mr-20"},[e._v(e._s(a.create_time))]),t("span",[e._v("订单号："+e._s(a.order_no))])])]),t("tr",{key:"refund_".concat(a.order_refund_id,"_3")},[t("td",[t("GoodsItem",{attrs:{data:{image:a.orderGoods.goods_image,imageAlt:"商品图片",title:a.orderGoods.goods_name,goodsProps:a.orderGoods.goods_props}}})],1),t("td",[t("p",[e._v("￥"+e._s(a.orderGoods.goods_price))]),t("p",[e._v("×"+e._s(a.orderGoods.total_num))])]),t("td",[t("p",[e._v("￥"+e._s(a.orderGoods.total_pay_price))])]),t("td",[t("UserItem",{attrs:{user:a.user}})],1),t("td",[t("a-tag",[e._v(e._s(e.RefundTypeEnum[a.type].name))])],1),t("td",[t("p",{staticClass:"mtb-2"},[t("span",{staticClass:"f-13"},[e._v("商家审核：")]),t("a-tag",{attrs:{color:e.renderAuditStatusColor(a.audit_status)}},[e._v(e._s(e.AuditStatusEnum[a.audit_status].name))])],1),a.type==e.RefundTypeEnum.RETURN.value?t("p",{staticClass:"mtb-2"},[t("span",{staticClass:"f-13"},[e._v("用户发货：")]),t("a-tag",{attrs:{color:a.is_user_send?"green":""}},[e._v(e._s(a.is_user_send?"已发货":"待发货"))])],1):e._e(),a.type==e.RefundTypeEnum.RETURN.value?t("p",{staticClass:"mtb-2"},[t("span",{staticClass:"f-13"},[e._v("商家收货：")]),t("a-tag",{attrs:{color:a.is_receipt?"green":""}},[e._v(e._s(a.is_receipt?"已收货":"待收货"))])],1):e._e()]),t("td",[t("a-tag",{attrs:{color:e.renderRefundStatusColor(a.status)}},[e._v(e._s(e.RefundStatusEnum[a.status].name))])],1),t("td",[t("div",{staticClass:"actions"},[e.$auth("orders.refund")?t("router-link",{attrs:{to:{path:"/order/refund/detail",query:{orderRefundId:a.order_refund_id}}}},[e._v("详情")]):e._e(),a.audit_status==e.AuditStatusEnum.WAIT.value?t("a",{directives:[{name:"action",rawName:"v-action:audit",arg:"audit"}],on:{click:function(t){return e.handleAudit(a)}}},[e._v("审核")]):e._e(),a.type==e.RefundTypeEnum.RETURN.value&&a.audit_status==e.AuditStatusEnum.REVIEWED.value&&a.is_user_send&&!a.is_receipt?t("a",{directives:[{name:"action",rawName:"v-action:receipt",arg:"receipt"}],on:{click:function(t){return e.handleReceipt(a)}}},[e._v("确认收货")]):e._e()],1)])])]}))],2)])]),e.refundList.data.length?e._e():t("a-empty",{attrs:{image:e.simpleImage}})],1)]),e.refundList.data.length?t("div",{staticClass:"pagination"},[t("a-pagination",{attrs:{current:e.page,pageSize:e.refundList.per_page,total:e.refundList.total},on:{change:e.onChangePage}})],1):e._e(),t("AuditForm",{ref:"AuditForm",on:{handleSubmit:e.handleRefresh}}),t("ReceiptForm",{ref:"ReceiptForm",on:{handleSubmit:e.handleRefresh}})],1)],1)},s=[],n=a(75374),i=a(57888),o=(a(27377),a(2970)),l=a(61145),d=a(21689),u=a(114),c=a(83472),m=a(76133),p=[{title:"商品信息",align:"center"},{title:"单价/数量",align:"center",scopedSlots:{customRender:"unit_price"}},{title:"付款金额",align:"center",dataIndex:"total_pay_price",scopedSlots:{customRender:"pay_price"}},{title:"买家",dataIndex:"user",scopedSlots:{customRender:"user"}},{title:"售后类型",dataIndex:"type",scopedSlots:{customRender:"type"}},{title:"处理进度",dataIndex:"progress",scopedSlots:{customRender:"progress"}},{title:"售后单状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",width:"180px",scopedSlots:{customRender:"action"}}],v=[{name:"订单号",value:10},{name:"会员昵称",value:20},{name:"会员ID",value:30}],_={name:"Index",components:{GoodsItem:u.O5,UserItem:u.Dn,AuditForm:m.c,ReceiptForm:m.F},data:function(){return{searchForm:this.$form.createForm(this),queryParam:{},isLoading:!1,columns:p,page:1,refundList:{data:[],total:0,per_page:10}}},beforeCreate:function(){(0,l.mU)(this,{inArray:l.RV,AuditStatusEnum:c.Hy,RefundStatusEnum:c.eS,RefundTypeEnum:c.Us,SearchTypeEnum:v,simpleImage:o.Ay.PRESENTED_IMAGE_SIMPLE})},created:function(){this.init()},methods:{init:function(){this.searchForm.resetFields(),this.queryParam={},this.handleRefresh(!0)},getList:function(){var e=this,t=this.queryParam,a=this.page;return this.isLoading=!0,d.p_((0,i.A)((0,i.A)({},t),{},{page:a})).then((function(t){e.refundList=t.data.list})).finally((function(){e.isLoading=!1}))},renderAuditStatusColor:function(e){var t=this.AuditStatusEnum,a=(0,n.A)((0,n.A)((0,n.A)({},t.WAIT.value,""),t.REVIEWED.value,"green"),t.REJECTED.value,"red");return a[e]},renderRefundStatusColor:function(e){var t=this.RefundStatusEnum,a=(0,n.A)((0,n.A)((0,n.A)((0,n.A)({},t.NORMAL.value,""),t.REJECTED.value,"red"),t.COMPLETED.value,"green"),t.CANCELLED.value,"red");return a[e]},handleRefresh:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.page=1),this.getList()},handleSearch:function(e){var t=this;e.preventDefault(),this.searchForm.validateFields((function(e,a){e||(t.queryParam=(0,i.A)((0,i.A)({},t.queryParam),a),t.handleRefresh(!0))}))},handleReset:function(){this.searchForm.resetFields()},onChangePage:function(e){this.page=e,this.handleRefresh()},handleAudit:function(e){this.$refs.AuditForm.show(e)},handleReceipt:function(e){this.$refs.ReceiptForm.show(e)}}},h=_,f=a(81656),g=(0,f.A)(h,r,s,!1,null,"2fc386a6",null),y=g.exports},7891:function(e,t,a){a.r(t),a.d(t,{default:function(){return A}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("a-card",{staticClass:"mb-20",attrs:{bordered:!1}},[t("div",{staticClass:"card-title"},[e._v(e._s(e.$route.meta.title))]),t("a-alert",{staticClass:"mb-20",attrs:{showIcon:!1,message:"功能说明：此功能用于订单数据导出，导出后的文件请用Excel打开查看",banner:""}}),t("a-form",{staticClass:"my-form",attrs:{form:e.myForm,layout:"inline"},on:{submit:e.handleSubmit}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"下单时间"}},[t("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["betweenTime",{rules:[{required:!0,message:"请选择下单时间"}]}],expression:"['betweenTime', { rules: [{ required: true, message: '请选择下单时间' }] }]"}],attrs:{format:"YYYY-MM-DD"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"订单来源"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["orderSource",{initialValue:-1}],expression:"['orderSource', { initialValue: -1 }]"}]},[t("a-select-option",{attrs:{value:-1}},[e._v("全部")]),e._l(e.OrderSourceEnum.data,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])}))],2)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"支付方式"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["payType",{initialValue:-1,rules:[{required:!0,message:"请选择支付方式"}]}],expression:"['payType', { initialValue: -1, rules: [{ required: true, message: '请选择支付方式' }] } ]"}]},[t("a-select-option",{attrs:{value:-1}},[e._v("全部")]),e._l(e.PayTypeEnum.data,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])}))],2)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{label:"配送方式"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["deliveryType",{initialValue:-1}],expression:"['deliveryType', { initialValue: -1 }]"}]},[t("a-select-option",{attrs:{value:-1}},[e._v("全部")]),e._l(e.DeliveryTypeEnum.data,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.value}},[e._v(e._s(a.name))])}))],2)],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-item",{staticClass:"item-main",attrs:{label:"导出的字段"}},[t("a-checkbox-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["columns",{initialValue:e.columnValue,rules:[{required:!0,message:"请选择导出的字段"}]}],expression:"['columns', { initialValue: columnValue, rules: [{ required: true, message: '请选择导出的字段' }] }]"}],attrs:{options:e.columnData}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-item",{staticClass:"form-btn"},[t("a-button",{staticClass:"btn-main",attrs:{type:"primary",icon:"download","html-type":"submit",loading:e.isBtnLoading}},[e._v("导出")]),t("a-button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1)],1),t("a-card",{attrs:{bordered:!1}},[t("div",{staticClass:"card-title"},[e._v("历史导出记录")]),t("ExportList",{ref:"ExportList"})],1)],1)},s=[],n=a(61145),i=a(26222),o={exportOrder:"/order.export/exportOrder",list:"/order.export/list"};function l(e){return(0,i.p)({url:o.exportOrder,method:"get",params:e})}function d(e){return(0,i.p)({url:o.list,method:"get",params:e})}var u=a(34351),c=function(){var e=this,t=e._self._c;return t("s-table",{ref:"table",attrs:{rowKey:"id",loading:e.isLoading,columns:e.columns,data:e.loadData,pageSize:10},scopedSlots:e._u([{key:"time",fn:function(a){return[t("span",[e._v(e._s(a.start_time))]),t("span",{staticClass:"ml-5 mr-5"},[e._v("到")]),t("span",[e._v(e._s(a.end_time))])]}},{key:"status",fn:function(a){return[t("a-tag",{attrs:{color:e.ExportStatusColorEnum[a]}},[e._v(e._s(e.ExportStatusEnum[a].name))])]}},{key:"action",fn:function(a,r){return t("span",{staticClass:"actions"},[r.status===e.ExportStatusEnum.COMPLETED.value?t("a",{directives:[{name:"action",rawName:"v-action:download",arg:"download"}],attrs:{href:r.download_url,target:"_blank"}},[e._v("下载")]):e._e()])}}])})},m=[],p=a(75374),v=a(21550),_=a(35230),h=new _.A([{key:"NORMAL",name:"进行中",value:10},{key:"COMPLETED",name:"已完成",value:20},{key:"FAIL",name:"失败",value:30}]),f=(0,p.A)((0,p.A)((0,p.A)({},h.NORMAL.value,""),h.COMPLETED.value,"green"),h.FAIL.value,"red"),g={name:"ExportList",components:{STable:v.Wd},data:function(){return{isLoading:!1,ExportStatusEnum:h,ExportStatusColorEnum:f,columns:[{title:"记录ID",dataIndex:"id"},{title:"下单时间",scopedSlots:{customRender:"time"}},{title:"导出时间",dataIndex:"create_time"},{title:"导出状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",width:"180px",scopedSlots:{customRender:"action"}}],loadData:function(e){return d(e).then((function(e){return e.data.list}))}}},watch:{value:{immediate:!0,handler:function(e){this.imgUrl=e}}},created:function(){},methods:{handleRefresh:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs.table.refresh(e)}}},y=g,E=a(81656),b=(0,E.A)(y,c,m,!1,null,"f6a64ab8",null),C=b.exports,S=[{label:"订单ID",value:"order_id"},{label:"订单号",value:"order_no"},{label:"商品信息",value:"goods_detail"},{label:"商品总额",value:"total_price"},{label:"优惠券抵扣金额",value:"coupon_money"},{label:"积分抵扣金额",value:"points_money"},{label:"后台改价",value:"update_price"},{label:"运费金额",value:"express_price"},{label:"订单实付款",value:"pay_price"},{label:"支付方式",value:"pay_type"},{label:"下单时间",value:"create_time"},{label:"买家信息",value:"user_info"},{label:"买家留言",value:"buyer_remark"},{label:"配送方式",value:"delivery_type"},{label:"收货人",value:"receipt_name"},{label:"联系电话",value:"receipt_phone"},{label:"收货地址",value:"receipt_address"},{label:"物流公司",value:"express_company"},{label:"物流单号",value:"express_no"},{label:"付款状态",value:"pay_status"},{label:"付款时间",value:"pay_time"},{label:"发货状态",value:"delivery_status"},{label:"发货时间",value:"delivery_time"},{label:"收货状态",value:"receipt_status"},{label:"收货时间",value:"receipt_time"},{label:"订单状态",value:"order_status"},{label:"是否已评价",value:"is_comment"},{label:"订单来源",value:"order_source"}],R=["order_no","goods_detail","total_price","coupon_money","points_money","update_price","express_price","pay_price","pay_type","create_time","user_info","buyer_remark","delivery_type","receipt_name","receipt_phone","receipt_address","express_company","express_no","pay_status","pay_time","delivery_status","delivery_time","receipt_status","receipt_time","order_status","order_source"],D={name:"Export",components:{ExportList:C},data:function(){return{myForm:this.$form.createForm(this),isLoading:!1,isBtnLoading:!1,labelCol:{span:8},wrapperCol:{span:16},columnData:S,columnValue:R}},beforeCreate:function(){(0,n.mU)(this,{inArray:n.RV,DeliveryTypeEnum:u.W8,OrderSourceEnum:u.B9,OrderStatusEnum:u.yk,PayTypeEnum:u.cB})},methods:{handleSubmit:function(e){var t=this;e.preventDefault(),this.myForm.validateFields((function(e,a){e||t.onFormSubmit(a)}))},onFormSubmit:function(e){var t=this;t.isLoading=!0,t.isBtnLoading=!0,l(e).then((function(e){t.$message.success(e.message,1.5),t.$refs.ExportList.handleRefresh()})).finally((function(e){t.isLoading=!1,t.isBtnLoading=!1}))},handleReset:function(){this.myForm.resetFields()}}},L=D,w=(0,E.A)(L,r,s,!1,null,"4744af65",null),A=w.exports},14693:function(e,t,a){a.d(t,{CN:function(){return i},p_:function(){return n}});var r=a(26222),s={list:"/deals",add:"/deals",edit:"/deals/{id}",delete:"/deals/{id}",allocate:"/deals/{id}/allocate_man"};function n(e){return(0,r.p)({url:s.list,method:"get",params:e})}function i(e,t){return(0,r.p)({url:s.allocate.replace("{id}",e),method:"post",data:t})}},15115:function(e,t,a){a.d(t,{KF:function(){return l},hE:function(){return o},nX:function(){return i},xC:function(){return n}});var r=a(26222),s={delivery:"/orders/{id}/ship",updatePrice:"/order.event/updatePrice",confirmCancel:"/orders/{id}/refund",delete:"/orders/{id}"};function n(e,t){return(0,r.p)({url:s.delivery.replace("{id}",e),method:"post",data:t})}function i(e){return(0,r.p)({url:s.updatePrice,method:"post",data:e})}function o(e,t){return(0,r.p)({url:s.confirmCancel.replace("{id}",e),method:"post",data:t})}function l(e){return(0,r.p)({url:s.delete.replace("{id}",e),method:"delete"})}},7191:function(e,t,a){a.d(t,{_0:function(){return i},p_:function(){return n}});var r=a(26222),s={list:"/orders",detail:"/orders/{id}"};function n(e){return(0,r.p)({url:s.list,method:"get",params:e})}function i(e,t){return(0,r.p)({url:s.detail.replace("{id}",e),method:"get",params:t})}},21689:function(e,t,a){a.d(t,{R9:function(){return l},_0:function(){return i},p_:function(){return n},sb:function(){return o}});var r=a(26222),s={list:"/order.refund/list",detail:"/order.refund/detail",audit:"/order.refund/audit",receipt:"/order.refund/receipt"};function n(e){return(0,r.p)({url:s.list,method:"get",params:e})}function i(e){return(0,r.p)({url:s.detail,method:"get",params:e})}function o(e){return(0,r.p)({url:s.audit,method:"post",data:e})}function l(e){return(0,r.p)({url:s.receipt,method:"post",data:e})}},70131:function(e,t,a){a.d(t,{KF:function(){return d},Q7:function(){return i},WQ:function(){return o},hc:function(){return l},p_:function(){return n}});var r=a(26222),s={list:"/setting.express/list",all:"/setting.express/all",add:"/setting.express/add",edit:"/setting.express/edit",delete:"/setting.express/delete"};function n(e){return(0,r.p)({url:s.list,method:"get",params:e})}function i(e){return(0,r.p)({url:s.all,method:"get",params:e})}function o(e){return(0,r.p)({url:s.add,method:"post",data:e})}function l(e){return(0,r.p)({url:s.edit,method:"post",data:e})}function d(e){return(0,r.p)({url:s.delete,method:"post",data:e})}},3238:function(e,t,a){a.d(t,{KF:function(){return d},Q7:function(){return i},WQ:function(){return o},hc:function(){return l},p_:function(){return n}});var r=a(26222),s={list:"/stores",all:"/stores",add:"/stores",edit:"/stores/{id}",delete:"/stores/{id}"};function n(e){return(0,r.p)({url:s.list,method:"get",params:e})}function i(e){return(0,r.p)({url:s.all,method:"get",params:e})}function o(e){return(0,r.p)({url:s.add,method:"post",data:e})}function l(e,t){return(0,r.p)({url:s.edit.replace("{id}",e),method:"patch",data:t})}function d(e){return(0,r.p)({url:s.delete.replace("{id}",e),method:"delete"})}},34351:function(e,t,a){a.d(t,{ws:function(){return s},W8:function(){return n},B9:function(){return i},yk:function(){return o},q5:function(){return l},cB:function(){return d},Gq:function(){return u}});var r=a(35230),s=new r.A([{key:"NOT_DELIVERED",name:"未发货",value:"pending"},{key:"DELIVERED",name:"已发货",value:"delivered"},{key:"RECEIVED",name:"已发货",value:"received"}]),n=new r.A([{key:"EXPRESS",name:"快递配送",value:10}]),i=new r.A([{key:"MASTER",name:"普通订单",value:10}]),o=new r.A([{key:"NORMAL",name:"进行中",value:"pending"},{key:"CANCELLED",name:"已取消",value:"canceled"},{key:"REFUNDING",name:"退款中",value:"refunding"},{key:"UNPAID",name:"未支付",value:"unpaid"},{key:"UNDELIVERED",name:"待发货",value:"undelivered"},{key:"UNRECEIVED",name:"未收货",value:"unreceived"},{key:"PACKING",name:"商家打包中",value:"packing"},{key:"PACKED",name:"打包完成",value:"packed"},{key:"ARRIVED",name:"骑手到店",value:"arrived"},{key:"DELIVERING",name:"配送中",value:"delivering"},{key:"DELIVERED",name:"已送达",value:"delivered"},{key:"UNREVIEWED",name:"已收货",value:"unreviewed"},{key:"REVIEWING",name:"待评价",value:"reviewing"},{key:"COMPLETED",name:"已完成",value:"completed"}]),l=new r.A([{key:"PENDING",name:"待支付",value:10},{key:"SUCCESS",name:"已支付",value:20}]),d=new r.A([{key:"BALANCE",name:"余额支付",value:"balance"},{key:"WECHAT",name:"微信支付",value:"wechat"},{key:"APLIPAY",name:"支付宝",value:"alipay"},{key:"APLIPAY",name:"未知付款方式",value:null}]),u=new r.A([{key:"NOT_DELIVERED",name:"未收货",value:"pending"},{key:"DELIVERED",name:"未收货",value:"delivered"},{key:"RECEIVED",name:"已收货",value:"received"}])},83472:function(e,t,a){a.d(t,{Hy:function(){return s},eS:function(){return n},Us:function(){return i}});var r=a(35230),s=new r.A([{key:"WAIT",name:"待审核",value:0},{key:"REVIEWED",name:"已同意",value:10},{key:"REJECTED",name:"已拒绝",value:20}]),n=new r.A([{key:"NORMAL",name:"进行中",value:0},{key:"REJECTED",name:"已拒绝",value:10},{key:"COMPLETED",name:"已完成",value:20},{key:"CANCELLED",name:"已取消",value:30}]),i=new r.A([{key:"RETURN",name:"退货退款",value:10},{key:"EXCHANGE",name:"换货",value:20}])},47187:function(e,t,a){a.d(t,{l4:function(){return w},Jd:function(){return c},Z6:function(){return b},i6:function(){return P}});var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:640,visible:e.visible,isLoading:e.isLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.isLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"物流公司",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["express_company",{rules:[{required:!0,message:"请输入物流公司"}]}],expression:"['express_company', { rules: [{ required: true, message: '请输入物流公司' }] }]"}]})],1),t("a-form-item",{attrs:{label:"物流单号",labelCol:e.labelCol,wrapperCol:e.wrapperCol,extra:"请填写发货的物流或快递单号"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["express_no",{rules:[{required:!0,message:"请输入物流单号"}]}],expression:"['express_no', { rules: [{ required: true, message: '请输入物流单号' }] }]"}]})],1)],1)],1)],1)},s=[],n=a(15115),i=a(70131),o={data:function(){return{title:"订单发货",labelCol:{span:7},wrapperCol:{span:13},visible:!1,isLoading:!1,form:this.$form.createForm(this),expressList:[],record:{}}},created:function(){},methods:{show:function(e){this.visible=!0,this.record=e},getExpressList:function(){var e=this;this.isLoading=!0,i.Q7().then((function(t){e.expressList=t.data.list})).finally((function(){e.isLoading=!1}))},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.isLoading=!0,n.xC(this.record.id,e).then((function(a){t.$message.success("已发货",1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).catch((function(e){t.$message.error(e.msg,3)})).finally((function(){t.isLoading=!1}))}}},l=o,d=a(81656),u=(0,d.A)(l,r,s,!1,null,null,null),c=u.exports,m=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:640,visible:e.visible,isLoading:e.isLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.isLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"菜头骑士",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["man_id",{rules:[{required:!0,message:"请选择骑士"}]}],expression:"['man_id', { rules: [{ required: true, message: '请选择骑士' }] }]"}],attrs:{placeholder:"请选择骑士"}},e._l(e.menList,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.id}},[e._v(e._s(a.name))])})),1),t("div",{staticClass:"form-item-help"},[t("router-link",{attrs:{target:"_blank",to:{path:"/setting/delivery/man/index"}}},[e._v("菜头骑士管理")])],1)],1)],1)],1)],1)},p=[],v=a(14693),_=a(26222),h={list:"/men",add:"/men",edit:"/men/{id}",delete:"/men/{id}"};function f(e){return(0,_.p)({url:h.list,method:"get",params:e})}var g={data:function(){return{title:"分配骑士",labelCol:{span:7},wrapperCol:{span:13},visible:!1,isLoading:!1,form:this.$form.createForm(this),menList:[],record:{}}},created:function(){this.getMenList()},methods:{show:function(e){this.visible=!0,this.record=e},getMenList:function(){var e=this;this.isLoading=!0,f({per_page:99,area_id:this.$store.getters.areaId}).then((function(t){e.menList=t.data})).finally((function(){e.isLoading=!1}))},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.isLoading=!0,v.CN(this.record.delivery_deal.id,e).then((function(a){t.$message.success("已分配",1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).catch((function(e){t.$message.error(e.msg,3)})).finally((function(){t.isLoading=!1}))}}},y=g,E=(0,d.A)(y,m,p,!1,null,null,null),b=E.exports,C=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:560,visible:e.visible,isLoading:e.isLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.isLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"实付款金额",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("span",[e._v("￥"+e._s(e.record.total_amount))])]),t("a-form-item",{attrs:{label:"审核状态",labelCol:e.labelCol,wrapperCol:e.wrapperCol,extra:"同意后将退回付款金额并关闭订单"}},[t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["agree",{initialValue:1,rules:[{required:!0}]}],expression:"['agree', { initialValue: 1, rules: [{ required: true }] }]"}]},[t("a-radio",{attrs:{value:1}},[e._v("同意")]),t("a-radio",{attrs:{value:0}},[e._v("拒绝")])],1)],1),t("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.form.getFieldValue("agree"),expression:"!form.getFieldValue('agree')"}],attrs:{label:"拒绝原因",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["reason",{rules:[{required:!e.form.getFieldValue("agree"),message:"请填写拒绝原因！"}]}],expression:"['reason', {rules: [{required: !form.getFieldValue('agree'), message: '请填写拒绝原因！'}]}]"}]})],1)],1)],1)],1)},S=[],R={data:function(){return{title:"审核取消订单",labelCol:{span:7},wrapperCol:{span:13},visible:!1,isLoading:!1,form:this.$form.createForm(this),record:{}}},created:function(){},methods:{show:function(e){this.visible=!0,this.record=e},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.isLoading=!0,n.hE(this.record.id,e).then((function(a){t.$message.success(a.message,1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){t.isLoading=!1}))}}},D=R,L=(0,d.A)(D,C,S,!1,null,null,null),w=L.exports,A=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:560,visible:e.visible,isLoading:e.isLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.isLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"订单金额",labelCol:e.labelCol,wrapperCol:e.wrapperCol,extra:"最终付款金额 = 订单金额 + 运费金额"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["order_price",{rules:[{required:!0,message:"请输入订单金额"}]}],expression:"['order_price', { rules: [{ required: true, message: '请输入订单金额' }] }]"}],attrs:{min:.01,precision:2}}),t("span",{staticClass:"ml-10"},[e._v("元")])],1),t("a-form-item",{attrs:{label:"运费金额",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["express_price",{rules:[{required:!0,message:"请输入运费金额"}]}],expression:"['express_price', { rules: [{ required: true, message: '请输入运费金额' }] }]"}],attrs:{min:0,precision:2}}),t("span",{staticClass:"ml-10"},[e._v("元")])],1)],1)],1)],1)},I=[],k=a(2543),x=a.n(k),F={data:function(){return{title:"修改订单金额",labelCol:{span:7},wrapperCol:{span:13},visible:!1,isLoading:!1,form:this.$form.createForm(this),record:{}}},created:function(){},methods:{show:function(e){this.visible=!0,this.record=e,this.setFieldsValue()},setFieldsValue:function(){var e=this.record,t=this.$nextTick,a=this.form.setFieldsValue;t((function(){var t=Number(e.update_price.value);"-"===e.update_price.symbol&&(t=-t),a({order_price:x().add(Number(e.order_price),t),express_price:Number(e.express_price)})}))},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.isLoading=!0,n.nX({orderId:this.record.order_id,form:e}).then((function(a){t.$message.success(a.message,1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){t.isLoading=!1}))}}},N=F,T=(0,d.A)(N,A,I,!1,null,null,null),P=T.exports},76133:function(e,t,a){a.d(t,{c:function(){return _},F:function(){return b}});var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:560,visible:e.visible,isLoading:e.isLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.isLoading}},[e.visible?t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"售后类型",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-tag",[e._v(e._s(e.RefundTypeEnum[e.record.type].name))])],1),t("a-form-item",{attrs:{label:"审核状态",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["audit_status",{initialValue:10,rules:[{required:!0}]}],expression:"['audit_status', { initialValue: 10, rules: [{ required: true }] }]"}]},[t("a-radio",{attrs:{value:10}},[e._v("同意")]),t("a-radio",{attrs:{value:20}},[e._v("拒绝")])],1)],1),e.form.getFieldValue("audit_status")==e.AuditStatusEnum.REVIEWED.value?t("a-form-item",{attrs:{label:"退货地址",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["address_id",{rules:[{required:!0,message:"请选择退货地址"}]}],expression:"['address_id', { rules: [{ required: true, message: '请选择退货地址' }] }]"}],attrs:{placeholder:"请选择退货地址"}},e._l(e.addressList,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.address_id}},[e._v(e._s(a.name))])})),1),t("div",{staticClass:"form-item-help"},[t("router-link",{attrs:{target:"_blank",to:{path:"/store/address/index"}}},[e._v("地址管理")])],1)],1):e._e(),e.form.getFieldValue("audit_status")==e.AuditStatusEnum.REJECTED.value?t("a-form-item",{attrs:{label:"拒绝原因",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["refuse_desc",{rules:[{required:!0,message:"请输入拒绝原因"}]}],expression:"['refuse_desc', { rules: [{ required: true, message: '请输入拒绝原因' }] }]"}],attrs:{autoSize:{minRows:4}}})],1):e._e()],1):e._e()],1)],1)},s=[],n=a(61145),i=a(21689),o=a(3238),l=a(83472),d=a(35230),u=new d.A([{key:"DELIVERY",name:"发货地址",value:10},{key:"RETURN",name:"退货地址",value:20}]),c={data:function(){return{title:"售后单审核",labelCol:{span:7},wrapperCol:{span:13},visible:!1,isLoading:!1,form:this.$form.createForm(this),addressList:[],record:{}}},beforeCreate:function(){(0,n.mU)(this,{AuditStatusEnum:l.Hy,RefundTypeEnum:l.Us})},created:function(){this.getAddressList()},methods:{show:function(e){var t=this;this.visible=!0,this.record=e,this.$nextTick((function(){t.$forceUpdate()}))},getAddressList:function(){var e=this;this.isLoading=!0,o.Q7({type:u.RETURN.value}).then((function(t){e.addressList=t.data.list})).finally((function(){e.isLoading=!1}))},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.isLoading=!0,i.sb({orderRefundId:this.record.order_refund_id,form:e}).then((function(a){t.$message.success(a.message,1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){t.isLoading=!1}))}}},m=c,p=a(81656),v=(0,p.A)(m,r,s,!1,null,"f59d991e",null),_=v.exports,h=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:565,visible:e.visible,isLoading:e.isLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.isLoading}},[e.record.type==e.RefundTypeEnum.RETURN.value?t("a-alert",{attrs:{message:"请确认已收到寄回的商品，确认后自动退回付款金额（原路退款）并关闭当前售后单",banner:""}}):e._e(),e.visible?t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"售后类型",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-tag",[e._v(e._s(e.RefundTypeEnum[e.record.type].name))])],1),t("a-form-item",{attrs:{label:"订单付款的总金额",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("span",[e._v("￥"+e._s(e.record.orderData.pay_price)+"元")])]),t("a-form-item",{attrs:{label:"退款的金额",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["refund_money",{rules:[{required:!0,message:"请输入退款金额"}]}],expression:"['refund_money', { rules: [{ required: true, message: '请输入退款金额' }] }]"}],attrs:{min:.01,precision:2}}),t("span",{staticClass:"ml-10"},[e._v("元")]),t("div",{staticClass:"form-item-help"},[t("p",{staticClass:"extra"},[e._v("请输入退款金额，最多"+e._s(Math.min(e.record.orderGoods.total_pay_price,e.record.orderData.pay_price))+"元，最多不能大于订单实际付款的总金额")])])],1)],1):e._e()],1)],1)},f=[],g={data:function(){return{title:"确认收货并退款",labelCol:{span:8},wrapperCol:{span:13},visible:!1,isLoading:!1,form:this.$form.createForm(this),record:{}}},beforeCreate:function(){(0,n.mU)(this,{AuditStatusEnum:l.Hy,RefundTypeEnum:l.Us})},methods:{show:function(e){var t=this;this.visible=!0,this.record=e,this.$nextTick((function(){t.$forceUpdate()}))},handleSubmit:function(e){var t=this;e.preventDefault();var a=this.form.validateFields;a((function(e,a){!e&&t.onFormSubmit(a)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var t=this;this.isLoading=!0,i.R9({orderRefundId:this.record.order_refund_id,form:e}).then((function(a){t.$message.success(a.message,1.5),t.handleCancel(),t.$emit("handleSubmit",e)})).finally((function(){t.isLoading=!1}))}}},y=g,E=(0,p.A)(y,h,f,!1,null,"7bbd5f22",null),b=E.exports}}]);