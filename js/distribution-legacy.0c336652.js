"use strict";(self["webpackChunkvue_antd_pro"]=self["webpackChunkvue_antd_pro"]||[]).push([[113],{86891:function(t,e,a){a.r(e),a.d(e,{default:function(){return v}});a(48598),a(62062),a(62010);var n=function(){var t=this,e=t._self._c;return e("div",[e("a-card",{attrs:{bordered:"false"}},[e("div",{staticClass:"table-search"},[e("a-form",{attrs:{layout:"inline"}},[e("a-form-item",{attrs:{label:"关键词"}},[e("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"昵称或用户ID",allowClear:""},model:{value:t.query.keyword,callback:function(e){t.$set(t.query,"keyword",e)},expression:"query.keyword"}})],1),e("a-form-item",{attrs:{label:"等级"}},[e("a-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",allowClear:""},model:{value:t.query.level,callback:function(e){t.$set(t.query,"level",e)},expression:"query.level"}},[e("a-select-option",{attrs:{value:1}},[t._v("LV1")]),e("a-select-option",{attrs:{value:2}},[t._v("LV2")]),e("a-select-option",{attrs:{value:3}},[t._v("LV3")]),e("a-select-option",{attrs:{value:4}},[t._v("LV4")]),e("a-select-option",{attrs:{value:5}},[t._v("LV5")])],1)],1),e("a-form-item",{attrs:{label:"负责人"}},[e("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"全部",allowClear:"",showSearch:"",filterOption:!1,loading:t.managerLoading},on:{search:t.handleManagerSearch},model:{value:t.query.manager_id,callback:function(e){t.$set(t.query,"manager_id",e)},expression:"query.manager_id"}},t._l(t.managerOptions,(function(a){return e("a-select-option",{key:a.id,attrs:{value:a.id}},[t._v(" "+t._s(a.name||a.username||"#"+a.id)+" ")])})),1)],1),e("a-form-item",[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.loadData(!0)}}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.reset}},[t._v("重置")])],1)],1),t.$auth("distribution.agents.manage")?e("div",{staticStyle:{"margin-top":"16px"}},[e("a-button",{attrs:{type:"primary",icon:"user-add"},on:{click:t.openPromoteModal}},[t._v(" 从用户提升为分销员 ")])],1):t._e()],1),e("a-table",{attrs:{columns:t.columns,dataSource:t.list,loading:t.loading,pagination:t.pagination,rowKey:"user_id"},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"commission",fn:function(a,n){return e("span",{},[t._v(" "+t._s(t.formatCommissionWithCount(n,"total"))+" ")])}},{key:"downlineCommission",fn:function(a,n){return e("span",{},[t._v(" "+t._s(t.formatCommissionWithCount(n,"downline"))+" ")])}},{key:"teamMembers",fn:function(a,n){return e("span",{},[t._v(" "+t._s((n.first_members_count||0)+(n.second_members_count||0)+(n.third_members_count||0))+" ")])}},{key:"managers",fn:function(a,n){return e("span",{},[n.managerScopes&&n.managerScopes.length?[t._v(" "+t._s(n.managerScopes.map((function(t){var e,a;return(null===(e=t.manager)||void 0===e?void 0:e.name)||(null===(a=t.manager)||void 0===a?void 0:a.username)||"#"+t.member_id})).join("、"))+" ")]:[t._v("-")]],2)}},{key:"levelSelect",fn:function(a,n){return e("span",{},[t.$auth("distribution.agents.manage")?e("a-select",{staticStyle:{width:"100px"},attrs:{size:"small",value:n.level||1},on:{change:function(e){return t.handleLevelChange(n,e)}}},t._l([1,2,3,4,5],(function(a){return e("a-select-option",{key:a,attrs:{value:a}},[t._v("LV"+t._s(a))])})),1):e("span",[t._v("LV"+t._s(n.level||1))])],1)}},{key:"actions",fn:function(a,n){return e("span",{},[e("a",{on:{click:function(e){return t.openDetail(n)}}},[t._v("查看数据")])])}}])})],1),e("a-drawer",{attrs:{visible:t.detailVisible,width:720,title:t.detailTitle,destroyOnClose:""},on:{close:t.closeDetail}},[t.currentAgent?[e("div",{staticClass:"detail-toolbar"},[e("span",[t._v("统计范围：")]),e("a-select",{staticStyle:{width:"120px"},on:{change:t.handleDetailRangeChange},model:{value:t.detailRange,callback:function(e){t.detailRange=e},expression:"detailRange"}},[e("a-select-option",{attrs:{value:"7d"}},[t._v("近7天")]),e("a-select-option",{attrs:{value:"30d"}},[t._v("近30天")]),e("a-select-option",{attrs:{value:"90d"}},[t._v("近90天")])],1)],1),e("a-spin",{attrs:{spinning:t.detailLoading}},[t.detailSummary?e("div",{staticClass:"summary-grid"},[e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("收入合计")]),e("div",{staticClass:"value"},[t._v("￥"+t._s(t.toAmount(t.detailSummary.income)))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("已入账")]),e("div",{staticClass:"value"},[t._v("￥"+t._s(t.toAmount(t.detailSummary.accounted)))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("团队流水")]),e("div",{staticClass:"value"},[t._v("￥"+t._s(t.toAmount(t.detailSummary.turnover)))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("订单数")]),e("div",{staticClass:"value"},[t._v(t._s(t.detailSummary.order_count||0))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("分享次数")]),e("div",{staticClass:"value"},[t._v(t._s(t.detailSummary.share_count||0))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("团队人数")]),e("div",{staticClass:"value"},[t._v(t._s(t.detailSummary.member_total||0))])])]):t._e(),t.detailSeries.length?e("a-table",{staticStyle:{"margin-top":"16px"},attrs:{columns:t.detailColumns,dataSource:t.detailSeries,pagination:!1,size:"small",rowKey:"date"}}):e("a-empty",{attrs:{description:"暂无数据"}})],1)]:t._e()],2),e("a-modal",{attrs:{title:"提升用户为分销员",visible:t.promoteVisible,confirmLoading:t.promoteLoading,maskClosable:!1,width:"600px"},on:{ok:t.handlePromote,cancel:t.closePromoteModal}},[e("a-form",{attrs:{layout:"vertical"}},[e("a-form-item",{attrs:{label:"选择用户",required:""}},[e("a-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",placeholder:"搜索用户昵称/ID/手机号",filterOption:!1,loading:t.userSearchLoading,notFoundContent:t.userSearchLoading?void 0:"输入关键词搜索用户"},on:{search:t.handleUserSearch},model:{value:t.promoteForm.user_id,callback:function(e){t.$set(t.promoteForm,"user_id",e)},expression:"promoteForm.user_id"}},t._l(t.userOptions,(function(a){return e("a-select-option",{key:a.id,attrs:{value:a.id}},[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("a-avatar",{staticStyle:{"margin-right":"8px"},attrs:{src:a.avatar_url,size:"small"}},[t._v(" "+t._s(a.nickname?a.nickname.charAt(0):"U")+" ")]),e("span",[t._v(t._s(a.nickname||"未设置昵称")+" (ID: "+t._s(a.id)+")")])],1)])})),1)],1),e("a-form-item",{attrs:{label:"推荐人（可选）"}},[e("a-select",{staticStyle:{width:"100%"},attrs:{showSearch:"",allowClear:"",placeholder:"可选，搜索已有分销员作为推荐人",filterOption:!1,loading:t.referrerSearchLoading},on:{search:t.handleReferrerSearch},model:{value:t.promoteForm.referrer_id,callback:function(e){t.$set(t.promoteForm,"referrer_id",e)},expression:"promoteForm.referrer_id"}},t._l(t.referrerOptions,(function(a){return e("a-select-option",{key:a.user_id,attrs:{value:a.user_id}},[t._v(" "+t._s(a.user_nickname)+" (ID: "+t._s(a.user_id)+") - LV"+t._s(a.level)+" ")])})),1),e("div",{staticStyle:{"margin-top":"8px",color:"#999","font-size":"12px"}},[t._v(" 如果不选择推荐人，该用户将成为顶级分销员 ")])],1),t.selectedUser?e("a-alert",{staticStyle:{"margin-top":"16px"},attrs:{type:"info",showIcon:""}},[e("template",{slot:"message"},[e("div",[e("strong",[t._v("即将提升用户：")]),e("div",{staticStyle:{"margin-top":"8px"}},[t._v(" "+t._s(t.selectedUser.nickname||"未设置昵称")+" (ID: "+t._s(t.selectedUser.id)+") ")]),t.selectedUser.phone?e("div",{staticStyle:{"margin-top":"4px"}},[t._v(" 手机："+t._s(t.selectedUser.phone)+" ")]):t._e()])])],2):t._e()],1)],1)],1)},r=[],i=a(69870),s=a(57888),o=a(17654),c=a(9133),u=(a(28706),a(50113),a(2892),a(25428),a(9868),a(26099),a(42762),a(23500),a(95093)),l=a.n(u),d=a(26222),m=a(35491),p={data:function(){var t=this;return{loading:!1,list:[],query:{page:1,per_page:10,keyword:void 0,level:void 0,manager_id:void 0},pagination:{current:1,pageSize:10,total:0,showTotal:function(t){return"共 ".concat(t," 条")}},columns:[{title:"用户ID",dataIndex:"user_id"},{title:"昵称",dataIndex:"user_nickname"},{title:"等级",dataIndex:"level",scopedSlots:{customRender:"levelSelect"}},{title:"直属成员",dataIndex:"first_members_count"},{title:"团队成员",scopedSlots:{customRender:"teamMembers"}},{title:"负责人",scopedSlots:{customRender:"managers"}},{title:"累计佣金/单量",scopedSlots:{customRender:"commission"}},{title:"下线佣金/单量",scopedSlots:{customRender:"downlineCommission"}},{title:"创建时间",dataIndex:"created_at",customRender:function(e){return t.formatDate(e)}},{title:"操作",scopedSlots:{customRender:"actions"},width:120}],detailColumns:[{title:"日期",dataIndex:"date"},{title:"收入",dataIndex:"income",customRender:function(t){return"￥".concat(Number(t||0).toFixed(2))}},{title:"已入账",dataIndex:"accounted",customRender:function(t){return"￥".concat(Number(t||0).toFixed(2))}},{title:"流水",dataIndex:"turnover",customRender:function(t){return"￥".concat(Number(t||0).toFixed(2))}},{title:"订单数",dataIndex:"order_count"},{title:"分享数",dataIndex:"share_count"},{title:"团队人数",dataIndex:"member_total"}],managerOptions:[],managerCache:{},managerLoading:!1,managerSearchKeyword:"",detailVisible:!1,detailLoading:!1,detailSummary:null,detailSeries:[],detailRange:"30d",currentAgent:null,promoteVisible:!1,promoteLoading:!1,promoteForm:{user_id:void 0,referrer_id:void 0},userOptions:[],referrerOptions:[],userSearchLoading:!1,referrerSearchLoading:!1}},computed:{detailTitle:function(){if(!this.currentAgent)return"分销员数据";var t=this.currentAgent.user_nickname||"";return t?"分销员 #".concat(this.currentAgent.user_id,"（").concat(t,"）"):"分销员 #".concat(this.currentAgent.user_id)},selectedUser:function(){var t=this;return this.userOptions.find((function(e){return e.id===t.promoteForm.user_id}))}},mounted:function(){this.loadData(!0),this.loadManagers()},methods:{normalizeManagerInfo:function(t){if(!t||void 0===t.id||null===t.id)return null;var e=Number(t.id);return!Number.isFinite(e)||e<=0?null:{id:e,name:t.name,username:t.username}},cacheManagerOption:function(t){var e=this.normalizeManagerInfo(t);return e?(this.managerCache[e.id]=e,e):null},ensureSelectedManagerOption:function(){var t=this.query.manager_id;if(void 0!==t&&null!==t){var e=Number(t);if(Number.isFinite(e)){this.query.manager_id!==e&&(this.query.manager_id=e);var a=this.managerOptions.find((function(t){return t.id===e}));if(!a){var n=this.managerCache[e];n&&(this.managerOptions=[n].concat((0,c.A)(this.managerOptions)))}}else this.query.manager_id=void 0}},loadData:function(){var t=arguments,e=this;return(0,o.A)((0,i.A)().mark((function a(){var n,r,o,c,u;return(0,i.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]&&t[0],n&&(e.query.page=1,e.pagination.current=1),e.loading=!0,a.prev=3,r=(0,s.A)({},e.query),void 0!==r.manager_id&&null!==r.manager_id&&(o=Number(r.manager_id),Number.isFinite(o)?(r.manager_id=o,e.query.manager_id=o):(delete r.manager_id,e.query.manager_id=void 0)),a.next=8,(0,m.pQ)(r);case 8:c=a.sent,u=(c.data||[]).map((function(t){return(0,s.A)((0,s.A)({},t),{},{managerScopes:t.managerScopes||[]})})),e.list=u,e.pagination=(0,s.A)((0,s.A)({},e.pagination),{},{current:c.current_page||1,pageSize:c.per_page||e.query.per_page,total:c.total||0}),e.syncManagerOptionsFromList(),a.next=18;break;case 15:a.prev=15,a.t0=a["catch"](3),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"加载失败");case 18:return a.prev=18,e.loading=!1,a.finish(18);case 21:case"end":return a.stop()}}),a,null,[[3,15,18,21]])})))()},loadManagers:function(t){var e=this;return(0,o.A)((0,i.A)().mark((function a(){var n,r,s;return(0,i.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.managerLoading=!0,e.managerSearchKeyword=t||"",a.prev=2,a.next=5,(0,m.L_)({per_page:50,page:1,keyword:t});case 5:n=a.sent,r=[],s=n.data||[],s.forEach((function(t){var a=e.cacheManagerOption(t);a&&r.push(a)})),e.managerOptions=r,e.ensureSelectedManagerOption(),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](2),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"负责人加载失败");case 16:return a.prev=16,e.managerLoading=!1,a.finish(16);case 19:case"end":return a.stop()}}),a,null,[[2,13,16,19]])})))()},syncManagerOptionsFromList:function(){var t=this;this.list.forEach((function(e){(e.managerScopes||[]).forEach((function(e){var a,n,r=t.cacheManagerOption({id:e.member_id,name:null===(a=e.manager)||void 0===a?void 0:a.name,username:null===(n=e.manager)||void 0===n?void 0:n.username});if(r&&!t.managerSearchKeyword){var i=t.managerOptions.find((function(t){return t.id===r.id}));i||(t.managerOptions=[].concat((0,c.A)(t.managerOptions),[r]))}}))})),this.ensureSelectedManagerOption()},handleManagerSearch:function(t){this.loadManagers(t)},handleTableChange:function(t){this.query.page=t.current,this.query.per_page=t.pageSize,this.loadData()},reset:function(){this.query.keyword=void 0,this.query.level=void 0,this.query.manager_id=void 0,this.loadData(!0)},handleLevelChange:function(t,e){var a=this;return(0,o.A)((0,i.A)().mark((function n(){var r;return(0,i.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=Number(e),r&&r!==t.level){n.next=3;break}return n.abrupt("return");case 3:return n.prev=3,n.next=6,(0,m.x4)(t.user_id,{level:r});case 6:a.$message.success("等级已更新"),t.level=r,n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](3),a.$message.error((null===n.t0||void 0===n.t0?void 0:n.t0.msg)||"更新失败");case 13:case"end":return n.stop()}}),n,null,[[3,10]])})))()},formatDate:function(t){return t?l()(t).format("YYYY-MM-DD HH:mm"):"-"},toAmount:function(t){return Number(t||0).toFixed(2)},formatCommissionWithCount:function(t,e){var a=0,n=0;"total"===e?(a=(Number(t.share_member_commission_amount)||0)+(Number(t.first_member_commission_amount)||0)+(Number(t.second_member_commission_amount)||0)+(Number(t.third_member_commission_amount)||0),n=(Number(t.share_member_orders)||0)+(Number(t.first_member_orders)||0)+(Number(t.second_member_orders)||0)+(Number(t.third_member_orders)||0)):"downline"===e&&(a=(Number(t.first_member_commission_amount)||0)+(Number(t.second_member_commission_amount)||0)+(Number(t.third_member_commission_amount)||0),n=(Number(t.first_member_orders)||0)+(Number(t.second_member_orders)||0)+(Number(t.third_member_orders)||0));var r="￥"+this.toAmount(a),i=n>0?" / "+n:" / 0";return r+i},openDetail:function(t){this.currentAgent=t,this.detailVisible=!0,this.detailRange="30d",this.loadAgentDetail()},loadAgentDetail:function(){var t=this;return(0,o.A)((0,i.A)().mark((function e(){var a;return(0,i.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.currentAgent){e.next=2;break}return e.abrupt("return");case 2:return t.detailLoading=!0,e.prev=3,e.next=6,(0,m.gF)({agent_id:t.currentAgent.user_id,range:t.detailRange});case 6:a=e.sent,t.detailSummary=null!==a&&void 0!==a&&a.summary?(0,s.A)({},a.summary):null,t.detailSeries=((null===a||void 0===a?void 0:a.series)||[]).map((function(t){return{date:t.date,income:Number(t.income||0),accounted:Number(t.accounted||0),turnover:Number(t.turnover||0),order_count:Number(t.order_count||0),share_count:Number(t.share_count||0),member_total:Number(t.member_total||0)}})),e.next=16;break;case 11:e.prev=11,e.t0=e["catch"](3),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"统计数据获取失败"),t.detailSummary=null,t.detailSeries=[];case 16:return e.prev=16,t.detailLoading=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,11,16,19]])})))()},handleDetailRangeChange:function(t){this.detailRange=t,this.loadAgentDetail()},closeDetail:function(){this.detailVisible=!1,this.detailLoading=!1,this.currentAgent=null,this.detailSummary=null,this.detailSeries=[],this.detailRange="30d"},openPromoteModal:function(){this.promoteVisible=!0,this.promoteForm={user_id:void 0,referrer_id:void 0},this.userOptions=[],this.referrerOptions=[]},closePromoteModal:function(){this.promoteVisible=!1,this.promoteForm={user_id:void 0,referrer_id:void 0},this.userOptions=[],this.referrerOptions=[]},handleUserSearch:function(t){var e=this;return(0,o.A)((0,i.A)().mark((function a(){var n;return(0,i.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t&&!(t.trim().length<2)){a.next=3;break}return e.userOptions=[],a.abrupt("return");case 3:return e.userSearchLoading=!0,a.prev=4,a.next=7,d.p.get("/users",{params:{keyword:t.trim(),per_page:20}});case 7:n=a.sent,e.userOptions=n.data||[],a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](4),e.$message.error("搜索用户失败: "+((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"")),e.userOptions=[];case 15:return a.prev=15,e.userSearchLoading=!1,a.finish(15);case 18:case"end":return a.stop()}}),a,null,[[4,11,15,18]])})))()},handleReferrerSearch:function(t){var e=this;return(0,o.A)((0,i.A)().mark((function a(){var n;return(0,i.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.referrerSearchLoading=!0,a.prev=1,a.next=4,(0,m.pQ)({keyword:t||void 0,per_page:50});case 4:n=a.sent,e.referrerOptions=n.data||[],a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](1),e.$message.error("搜索推荐人失败"),e.referrerOptions=[];case 12:return a.prev=12,e.referrerSearchLoading=!1,a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[1,8,12,15]])})))()},handlePromote:function(){var t=this;return(0,o.A)((0,i.A)().mark((function e(){var a;return(0,i.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.promoteForm.user_id){e.next=3;break}return t.$message.warning("请选择要提升的用户"),e.abrupt("return");case 3:return t.promoteLoading=!0,e.prev=4,a={user_id:t.promoteForm.user_id},t.promoteForm.referrer_id&&(a.referrer_id=t.promoteForm.referrer_id),e.next=9,(0,m.Sn)(a);case 9:t.$message.success("提升成功！该用户已成为分销员"),t.closePromoteModal(),t.loadData(!0),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](4),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"提升失败，该用户可能已经是分销员");case 17:return e.prev=17,t.promoteLoading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[4,14,17,20]])})))()}}},h=p,f=a(81656),g=(0,f.A)(h,n,r,!1,null,"313b63e0",null),v=g.exports},44949:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var n=function(){var t=this,e=t._self._c;return e("div",[e("a-card",{attrs:{bordered:"false"}},[e("div",{staticClass:"table-search"},[e("a-form",{attrs:{layout:"inline"}},[e("a-form-item",{attrs:{label:"关键词"}},[e("a-input",{staticStyle:{width:"220px"},attrs:{placeholder:"姓名或账号",allowClear:""},model:{value:t.query.keyword,callback:function(e){t.$set(t.query,"keyword",e)},expression:"query.keyword"}})],1),e("a-form-item",[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.loadData(!0)}}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),e("a-table",{attrs:{columns:t.columns,dataSource:t.list,loading:t.loading,pagination:t.pagination,rowKey:"id"},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"agents",fn:function(a,n){return e("span",{},[t._v(" "+t._s(n.managed_agent_count||0)+" ")])}},{key:"actions",fn:function(a,n){return e("span",{},[e("a",{on:{click:function(e){return t.openAssignModal(n)}}},[t._v("分配分销员")]),e("a-divider",{attrs:{type:"vertical"}}),e("a",{on:{click:function(e){return t.openDrawer(n)}}},[t._v("查看分销员")])],1)}}])})],1),e("a-modal",{attrs:{visible:t.assignVisible,title:t.modalTitle,confirmLoading:t.assignSubmitting,width:"640",destroyOnClose:""},on:{ok:t.handleAssignSubmit,cancel:t.closeAssignModal}},[e("a-form",{attrs:{layout:"vertical"}},[e("a-form-item",{attrs:{label:"选择分销员"}},[e("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",showSearch:"",filterOption:!1,loading:t.agentsLoading,placeholder:"输入昵称或ID搜索一级分销员"},on:{search:t.handleAgentSearch},model:{value:t.selectedAgentIds,callback:function(e){t.selectedAgentIds=e},expression:"selectedAgentIds"}},t._l(t.agentOptions,(function(a){return e("a-select-option",{key:a.value,attrs:{value:a.value}},[t._v(" "+t._s(a.label)+" ")])})),1)],1)],1),t.selectedAgentDetails.length?e("div",{staticClass:"selected-list"},[e("div",{staticClass:"selected-list__title"},[t._v("已选择 "+t._s(t.selectedAgentDetails.length)+" 位：")]),e("a-table",{attrs:{columns:t.selectedColumns,dataSource:t.selectedAgentDetails,pagination:!1,size:"small",rowKey:"user_id"}})],1):t._e()],1),e("a-drawer",{attrs:{visible:t.drawerVisible,title:t.drawerTitle,width:720,destroyOnClose:""},on:{close:t.closeDrawer}},[e("a-table",{attrs:{columns:t.drawerColumns,dataSource:t.drawerData,loading:t.drawerLoading,pagination:t.drawerPagination,rowKey:"user_id",size:"middle"},on:{change:t.handleDrawerChange}})],1)],1)},r=[],i=a(9133),s=a(69870),o=a(57888),c=a(17654),u=(a(28706),a(2008),a(62062),a(62010),a(2892),a(25428),a(26099),a(31415),a(47764),a(23500),a(62953),a(95093)),l=a.n(u),d=a(35491),m={data:function(){return{loading:!1,list:[],query:{page:1,per_page:10,keyword:void 0},pagination:{current:1,pageSize:10,total:0,showTotal:function(t){return"共 ".concat(t," 条")}},columns:[{title:"ID",dataIndex:"id",width:80},{title:"姓名",dataIndex:"name"},{title:"账号",dataIndex:"username"},{title:"手机号",dataIndex:"phone"},{title:"负责分销员",scopedSlots:{customRender:"agents"},width:120},{title:"操作",scopedSlots:{customRender:"actions"},width:200}],assignVisible:!1,assignSubmitting:!1,currentManager:null,selectedAgentIds:[],selectedColumns:[{title:"用户ID",dataIndex:"user_id",width:100},{title:"昵称",dataIndex:"user_nickname"},{title:"等级",dataIndex:"level",customRender:function(t){return"LV".concat(t||1)}},{title:"加入时间",dataIndex:"created_at",customRender:function(t){return t?l()(t).format("YYYY-MM-DD HH:mm"):"-"}}],agentOptions:[],agentCache:{},agentsLoading:!1,agentSearchKeyword:"",assignedAgents:[],drawerVisible:!1,drawerLoading:!1,drawerData:[],drawerPagination:{current:1,pageSize:10,total:0,showTotal:function(t){return"共 ".concat(t," 条")}},drawerColumns:[{title:"用户ID",dataIndex:"user_id",width:100},{title:"昵称",dataIndex:"user_nickname"},{title:"等级",dataIndex:"level",customRender:function(t){return"LV".concat(t||1)}},{title:"直属成员",dataIndex:"first_members_count"},{title:"团队成员",dataIndex:"team_members",customRender:function(t,e){return(e.first_members_count||0)+(e.second_members_count||0)+(e.third_members_count||0)}},{title:"创建时间",dataIndex:"created_at",customRender:function(t){return t?l()(t).format("YYYY-MM-DD HH:mm"):"-"}}]}},computed:{selectedAgentDetails:function(){var t=this;return this.selectedAgentIds.map((function(e){return t.agentCache[e]})).filter((function(t){return!!t}))},modalTitle:function(){if(!this.currentManager)return"分配分销员";var t=this.currentManager.name||this.currentManager.username||"#".concat(this.currentManager.id);return"分配分销员 - ".concat(t)},drawerTitle:function(){if(!this.currentManager)return"分销员列表";var t=this.currentManager.name||this.currentManager.username||"#".concat(this.currentManager.id);return"分销员列表 - ".concat(t)}},mounted:function(){this.loadData(!0)},methods:{loadData:function(){var t=arguments,e=this;return(0,c.A)((0,s.A)().mark((function a(){var n,r;return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]&&t[0],n&&(e.query.page=1,e.pagination.current=1),e.loading=!0,a.prev=3,a.next=6,(0,d.L_)((0,o.A)({},e.query));case 6:r=a.sent,e.list=r.data||[],e.pagination=(0,o.A)((0,o.A)({},e.pagination),{},{current:r.current_page||1,pageSize:r.per_page||e.query.per_page,total:r.total||0}),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](3),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"加载失败");case 14:return a.prev=14,e.loading=!1,a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[3,11,14,17]])})))()},reset:function(){this.query.keyword=void 0,this.loadData(!0)},handleTableChange:function(t){this.query.page=t.current,this.query.per_page=t.pageSize,this.loadData()},addAgentsToCache:function(t){var e=this;(t||[]).forEach((function(t){if(t){var a=Number(t.user_id||t.id);!Number.isFinite(a)||a<=0||(e.agentCache[a]=(0,o.A)((0,o.A)((0,o.A)({},e.agentCache[a]),t),{},{user_id:a}))}}))},buildAgentOption:function(t){if(!t)return null;var e=Number(t.user_id);if(!Number.isFinite(e)||e<=0)return null;var a=t.user_nickname?"".concat(t.user_nickname," (#").concat(e,")"):"分销员 #".concat(e);return{value:e,label:a}},ensureSelectedAgentsOption:function(){var t=this,e=new Set(this.agentOptions.map((function(t){return t.value})));this.selectedAgentIds.forEach((function(a){if(!e.has(a)){var n=t.agentCache[a],r=t.buildAgentOption(n);r&&(t.agentOptions=[].concat((0,i.A)(t.agentOptions),[r]),e.add(a))}}))},openAssignModal:function(t){var e=this;return(0,c.A)((0,s.A)().mark((function a(){var n;return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.currentManager=t,e.assignVisible=!0,e.assignSubmitting=!1,e.agentOptions=[],e.agentSearchKeyword="",n=(t.agent_ids||[]).map((function(t){return Number(t)})).filter((function(t){return Number.isFinite(t)})),e.selectedAgentIds=n,a.next=9,e.loadAssignedAgents(t.id);case 9:return a.next=11,e.loadAgentOptions();case 11:e.ensureSelectedAgentsOption();case 12:case"end":return a.stop()}}),a)})))()},closeAssignModal:function(){this.assignVisible=!1,this.assignSubmitting=!1,this.currentManager=null,this.selectedAgentIds=[],this.agentOptions=[],this.assignedAgents=[]},loadAssignedAgents:function(t){var e=this;return(0,c.A)((0,s.A)().mark((function a(){var n,r,i;return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.agentsLoading=!0,a.prev=1,a.next=4,(0,d.Gg)(t,{per_page:200,page:1});case 4:n=a.sent,r=(n.data||[]).map((function(t){return t.agent||t})),e.assignedAgents=r,e.addAgentsToCache(r),e.selectedAgentIds.length||(i=r.map((function(t){return Number(t.user_id)})).filter((function(t){return Number.isFinite(t)})),e.selectedAgentIds=i),e.ensureSelectedAgentsOption(),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](1),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"加载当前分销员失败");case 15:return a.prev=15,e.agentsLoading=!1,a.finish(15);case 18:case"end":return a.stop()}}),a,null,[[1,12,15,18]])})))()},loadAgentOptions:function(t){var e=this;return(0,c.A)((0,s.A)().mark((function a(){var n,r;return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.agentsLoading=!0,e.agentSearchKeyword=t||"",a.prev=2,a.next=5,(0,d.pQ)({per_page:100,page:1,level:1,keyword:t});case 5:n=a.sent,r=n.data||[],e.addAgentsToCache(r),e.agentOptions=r.map((function(t){return e.buildAgentOption(t)})).filter((function(t){return!!t})),e.ensureSelectedAgentsOption(),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](2),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"分销员搜索失败");case 15:return a.prev=15,e.agentsLoading=!1,a.finish(15);case 18:case"end":return a.stop()}}),a,null,[[2,12,15,18]])})))()},handleAgentSearch:function(t){this.loadAgentOptions(t)},handleAssignSubmit:function(){var t=this;return(0,c.A)((0,s.A)().mark((function e(){var a;return(0,s.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.currentManager){e.next=2;break}return e.abrupt("return");case 2:return t.assignSubmitting=!0,e.prev=3,a=t.selectedAgentIds.map((function(t){return Number(t)})).filter((function(t){return Number.isFinite(t)})),e.next=7,(0,d.oQ)(t.currentManager.id,{agent_ids:a});case 7:t.$message.success("分配成功"),t.closeAssignModal(),t.loadData(),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](3),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"分配失败");case 15:return e.prev=15,t.assignSubmitting=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[3,12,15,18]])})))()},openDrawer:function(t){var e=this;return(0,c.A)((0,s.A)().mark((function a(){return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.currentManager=t,e.drawerVisible=!0,e.drawerPagination.current=1,a.next=5,e.loadDrawerData(1);case 5:case"end":return a.stop()}}),a)})))()},closeDrawer:function(){this.drawerVisible=!1,this.drawerData=[],this.drawerLoading=!1},loadDrawerData:function(){var t=arguments,e=this;return(0,c.A)((0,s.A)().mark((function a(){var n,r,i;return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:1,e.currentManager){a.next=3;break}return a.abrupt("return");case 3:return e.drawerLoading=!0,a.prev=4,a.next=7,(0,d.Gg)(e.currentManager.id,{per_page:e.drawerPagination.pageSize,page:n});case 7:r=a.sent,i=(r.data||[]).map((function(t){return t.agent||t})),e.drawerData=i,e.addAgentsToCache(i),e.drawerPagination=(0,o.A)((0,o.A)({},e.drawerPagination),{},{current:r.current_page||n,total:r.total||0}),a.next=17;break;case 14:a.prev=14,a.t0=a["catch"](4),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"分销员列表加载失败");case 17:return a.prev=17,e.drawerLoading=!1,a.finish(17);case 20:case"end":return a.stop()}}),a,null,[[4,14,17,20]])})))()},handleDrawerChange:function(t){this.loadDrawerData(t.current)}}},p=m,h=a(81656),f=(0,h.A)(p,n,r,!1,null,"3a4cbfd0",null),g=f.exports},4878:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});a(2892),a(9868);var n=function(){var t=this,e=t._self._c;return e("a-card",{attrs:{bordered:"false"}},[e("div",{staticClass:"table-search"},[e("a-form",{attrs:{layout:"inline"}},[e("a-form-item",{attrs:{label:"状态"}},[e("a-select",{staticStyle:{width:"140px"},attrs:{allowClear:"",placeholder:"全部"},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},[e("a-select-option",{attrs:{value:"pending"}},[t._v("待审核")]),e("a-select-option",{attrs:{value:"valid"}},[t._v("有效")]),e("a-select-option",{attrs:{value:"done"}},[t._v("已入账")]),e("a-select-option",{attrs:{value:"canceled"}},[t._v("已取消")])],1)],1),e("a-form-item",[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.loadData(!0)}}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),e("a-table",{attrs:{columns:t.columns,dataSource:t.list,loading:t.loading,pagination:t.pagination,rowKey:"id"},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"type",fn:function(a){return e("span",{},[t._v(" "+t._s(t.typeText(a))+" ")])}},{key:"status",fn:function(a){return e("span",{},[e("a-tag",{attrs:{color:t.statusColor(a)}},[t._v(t._s(t.statusText(a)))])],1)}},{key:"commission",fn:function(a){return e("span",{},[t._v(" ￥"+t._s(Number(a||0).toFixed(2))+" ")])}},{key:"actions",fn:function(a,n){return e("span",{},["pending"===n.status&&t.$auth("distribution.rebates.approve")?e("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleApprove(n)}}},[t._v("通过")]):t._e(),"pending"===n.status&&t.$auth("distribution.rebates.approve")?e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"danger",size:"small"},on:{click:function(e){return t.handleReject(n)}}},[t._v("拒绝")]):t._e(),"pending"!==n.status||t.$auth("distribution.rebates.approve")?"pending"!==n.status?e("span",[t._v("-")]):t._e():e("span",[t._v("待审核")])],1)}}])})],1)},r=[],i=(a(96305),a(43898)),s=a(69870),o=a(57888),c=a(17654),u=a(95093),l=a.n(u),d=a(35491),m={data:function(){var t=this;return{loading:!1,list:[],query:{page:1,per_page:10,status:void 0},pagination:{current:1,pageSize:10,total:0,showTotal:function(t){return"共 ".concat(t," 条")}},columns:[{title:"ID",dataIndex:"id"},{title:"分销员",dataIndex:"user_nickname"},{title:"等级",dataIndex:"user_level",customRender:function(t){return t?"LV".concat(t):"-"}},{title:"佣金金额",dataIndex:"commission",scopedSlots:{customRender:"commission"}},{title:"类型",dataIndex:"type",scopedSlots:{customRender:"type"}},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"创建时间",dataIndex:"created_at",customRender:function(e){return t.formatDate(e)}},{title:"入账时间",dataIndex:"accounted_at",customRender:function(e){return t.formatDate(e)}},{title:"操作",scopedSlots:{customRender:"actions"}}]}},mounted:function(){this.loadData(!0)},methods:{loadData:function(){var t=arguments,e=this;return(0,c.A)((0,s.A)().mark((function a(){var n,r;return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]&&t[0],n&&(e.query.page=1,e.pagination.current=1),e.loading=!0,a.prev=3,a.next=6,(0,d.$X)((0,o.A)({},e.query));case 6:r=a.sent,e.list=r.data||[],e.pagination=(0,o.A)((0,o.A)({},e.pagination),{},{current:r.current_page||1,pageSize:r.per_page||e.query.per_page,total:r.total||0}),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](3),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"加载失败");case 14:return a.prev=14,e.loading=!1,a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[3,11,14,17]])})))()},handleTableChange:function(t){this.query.page=t.current,this.query.per_page=t.pageSize,this.loadData()},reset:function(){this.query.status=void 0,this.loadData(!0)},typeText:function(t){return"share_buy"===t?"分享下单":"团队订单"},statusText:function(t){switch(t){case"pending":return"待审核";case"paid":return"已支付";case"received":return"已收货";case"done":return"已入账";case"canceled":return"已取消";default:return t}},statusColor:function(t){switch(t){case"pending":return"orange";case"done":return"green";case"canceled":return"red";default:return"blue"}},formatDate:function(t){return t?l()(t).format("YYYY-MM-DD HH:mm"):"-"},handleApprove:function(t){var e=this;return(0,c.A)((0,s.A)().mark((function a(){return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,d.vt)(t.id);case 3:e.$message.success("审核通过"),e.loadData(),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"操作失败");case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},handleReject:function(t){var e=this;return(0,c.A)((0,s.A)().mark((function a(){return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:i.A.confirm({title:"确认操作",content:"确定要拒绝该笔佣金吗？",onOk:function(){var a=(0,c.A)((0,s.A)().mark((function a(){return(0,s.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,d.RS)(t.id);case 3:e.$message.success("已拒绝"),e.loadData(),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"操作失败");case 10:case"end":return a.stop()}}),a,null,[[0,7]])})));function n(){return a.apply(this,arguments)}return n}()});case 1:case"end":return a.stop()}}),a)})))()}}},p=m,h=a(81656),f=(0,h.A)(p,n,r,!1,null,"2303acfa",null),g=f.exports},22013:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var n=function(){var t=this,e=t._self._c;return e("div",[e("a-card",{attrs:{bordered:"false"}},[e("div",{staticClass:"filter-bar"},[e("a-form",{attrs:{layout:"inline"}},[e("a-form-item",{attrs:{label:"日期范围"}},[e("a-range-picker",{staticStyle:{width:"260px"},attrs:{allowClear:""},on:{change:t.handleDateChange},model:{value:t.query.dateRange,callback:function(e){t.$set(t.query,"dateRange",e)},expression:"query.dateRange"}})],1),e("a-form-item",[e("a-radio-group",{on:{change:t.handlePresetChange},model:{value:t.query.rangePreset,callback:function(e){t.$set(t.query,"rangePreset",e)},expression:"query.rangePreset"}},[e("a-radio-button",{attrs:{value:"7d"}},[t._v("近7天")]),e("a-radio-button",{attrs:{value:"30d"}},[t._v("近30天")]),e("a-radio-button",{attrs:{value:"90d"}},[t._v("近90天")])],1)],1),e("a-form-item",{attrs:{label:"排名指标"}},[e("a-select",{staticStyle:{width:"140px"},on:{change:t.loadRanking},model:{value:t.query.metric,callback:function(e){t.$set(t.query,"metric",e)},expression:"query.metric"}},[e("a-select-option",{attrs:{value:"income"}},[t._v("预计收入")]),e("a-select-option",{attrs:{value:"turnover"}},[t._v("成交流水")]),e("a-select-option",{attrs:{value:"order_count"}},[t._v("订单数")])],1)],1),e("a-form-item",{attrs:{label:"分销员ID"}},[e("a-input",{staticStyle:{width:"160px"},attrs:{placeholder:"精确匹配",allowClear:""},model:{value:t.query.agentId,callback:function(e){t.$set(t.query,"agentId",e)},expression:"query.agentId"}})],1),e("a-form-item",[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.handleSearch}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),e("div",{staticClass:"overview-grid"},[e("div",{staticClass:"overview-card"},[e("div",{staticClass:"label"},[t._v("预计收入")]),e("div",{staticClass:"value"},[t._v("￥"+t._s(t.toAmount(t.overview.income)))])]),e("div",{staticClass:"overview-card"},[e("div",{staticClass:"label"},[t._v("成交流水")]),e("div",{staticClass:"value"},[t._v("￥"+t._s(t.toAmount(t.overview.turnover)))])]),e("div",{staticClass:"overview-card"},[e("div",{staticClass:"label"},[t._v("订单数")]),e("div",{staticClass:"value"},[t._v(t._s(t.overview.order_count||0))])]),e("div",{staticClass:"overview-card"},[e("div",{staticClass:"label"},[t._v("有效分销员")]),e("div",{staticClass:"value"},[t._v(t._s(t.overview.agent_count||0))])])]),e("a-row",{staticStyle:{"margin-top":"16px"},attrs:{gutter:16}},[e("a-col",{attrs:{span:8}},[e("a-card",{attrs:{title:"分销员排行榜",bordered:"false",size:"small",loading:t.rankingLoading}},[e("a-table",{attrs:{columns:t.rankingColumns,dataSource:t.ranking,size:"small",rowKey:"user_id",pagination:!1}})],1)],1),e("a-col",{attrs:{span:16}},[e("a-card",{attrs:{title:"日维度统计",bordered:"false",size:"small"}},[e("a-table",{attrs:{columns:t.dailyColumns,dataSource:t.dailyList,loading:t.dailyLoading,pagination:t.dailyPagination,rowKey:"id",size:"small"},on:{change:t.handleDailyChange},scopedSlots:t._u([{key:"agent",fn:function(a,n){return[e("span",[t._v("#"+t._s(n.user_id)+" "+t._s(t.resolveNickname(n.user_id,n.nickname)))])]}},{key:"actions",fn:function(a,n){return[e("a",{on:{click:function(e){return t.openDetail(n)}}},[t._v("查看趋势")])]}}])})],1)],1)],1)],1),e("a-drawer",{attrs:{visible:t.detailVisible,title:t.detailTitle,width:720,destroyOnClose:""},on:{close:t.closeDetail}},[e("div",{staticClass:"detail-toolbar"},[e("span",[t._v("统计范围：")]),e("a-select",{staticStyle:{width:"120px"},on:{change:t.handleDetailRangeChange},model:{value:t.detailRange,callback:function(e){t.detailRange=e},expression:"detailRange"}},[e("a-select-option",{attrs:{value:"7d"}},[t._v("近7天")]),e("a-select-option",{attrs:{value:"30d"}},[t._v("近30天")]),e("a-select-option",{attrs:{value:"90d"}},[t._v("近90天")])],1)],1),e("a-spin",{attrs:{spinning:t.detailLoading}},[t.detailSummary?e("div",{staticClass:"summary-grid"},[e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("收入合计")]),e("div",{staticClass:"value"},[t._v("￥"+t._s(t.toAmount(t.detailSummary.income)))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("已入账")]),e("div",{staticClass:"value"},[t._v("￥"+t._s(t.toAmount(t.detailSummary.accounted)))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("成交流水")]),e("div",{staticClass:"value"},[t._v("￥"+t._s(t.toAmount(t.detailSummary.turnover)))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("订单数")]),e("div",{staticClass:"value"},[t._v(t._s(t.detailSummary.order_count||0))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("分享次数")]),e("div",{staticClass:"value"},[t._v(t._s(t.detailSummary.share_count||0))])]),e("div",{staticClass:"summary-card"},[e("div",{staticClass:"label"},[t._v("团队人数")]),e("div",{staticClass:"value"},[t._v(t._s(t.detailSummary.member_total||0))])])]):t._e(),t.detailSeries.length?e("a-table",{attrs:{columns:t.detailColumns,dataSource:t.detailSeries,pagination:!1,size:"small",rowKey:"date"}}):e("a-empty",{attrs:{description:"暂无数据"}})],1)],1)],1)},r=[],i=a(69870),s=a(57888),o=a(17654),c=a(21092),u=(a(28706),a(62062),a(2892),a(25428),a(9868),a(26099),a(23500),a(95093)),l=a.n(u),d=a(35491),m={data:function(){var t=this;return{query:{dateRange:[],rangePreset:"30d",metric:"income",agentId:void 0,page:1,per_page:10},overview:{income:0,turnover:0,order_count:0,agent_count:0},ranking:[],rankingLoading:!1,rankingColumns:[{title:"排名",dataIndex:"rank",width:70,customRender:function(t,e,a){return a+1}},{title:"分销员",dataIndex:"user_id",customRender:function(e){return"#".concat(e," ").concat(t.resolveNickname(e))}},{title:"预计收入",dataIndex:"income",customRender:function(e){return"￥".concat(t.toAmount(e))}},{title:"成交流水",dataIndex:"turnover",customRender:function(e){return"￥".concat(t.toAmount(e))}},{title:"订单数",dataIndex:"order_count"}],dailyList:[],dailyLoading:!1,dailyPagination:{current:1,pageSize:10,total:0,showTotal:function(t){return"共 ".concat(t," 条")}},dailyColumns:[{title:"日期",dataIndex:"date"},{title:"分销员",dataIndex:"user_id",scopedSlots:{customRender:"agent"}},{title:"等级",dataIndex:"level",customRender:function(t){return"LV".concat(t||1)}},{title:"预计收入",dataIndex:"income",customRender:function(e){return"￥".concat(t.toAmount(e))}},{title:"成交流水",dataIndex:"turnover",customRender:function(e){return"￥".concat(t.toAmount(e))}},{title:"订单数",dataIndex:"order_count"},{title:"分享数",dataIndex:"share_count"},{title:"操作",dataIndex:"actions",scopedSlots:{customRender:"actions"},width:100}],agentCache:{},detailVisible:!1,detailLoading:!1,detailSummary:null,detailSeries:[],detailColumns:[{title:"日期",dataIndex:"date"},{title:"收入",dataIndex:"income",customRender:function(e){return"￥".concat(t.toAmount(e))}},{title:"已入账",dataIndex:"accounted",customRender:function(e){return"￥".concat(t.toAmount(e))}},{title:"流水",dataIndex:"turnover",customRender:function(e){return"￥".concat(t.toAmount(e))}},{title:"订单数",dataIndex:"order_count"},{title:"分享数",dataIndex:"share_count"},{title:"团队人数",dataIndex:"member_total"}],detailRange:"30d",currentAgent:null}},computed:{detailTitle:function(){if(!this.currentAgent)return"分销员数据";var t=this.resolveNickname(this.currentAgent.user_id,this.currentAgent.nickname);return t?"分销员 #".concat(this.currentAgent.user_id,"（").concat(t,"）"):"分销员 #".concat(this.currentAgent.user_id)}},mounted:function(){this.applyPreset("30d"),this.loadOverview(),this.loadRanking(),this.loadDaily(!0)},methods:{resolveNickname:function(t,e){var a=this.agentCache[t];return(null===a||void 0===a?void 0:a.nickname)||(null===a||void 0===a?void 0:a.user_nickname)||e||""},toAmount:function(t){return Number(t||0).toFixed(2)},formatDate:function(t){return t?l()(t).format("YYYY-MM-DD HH:mm"):"-"},getDateParams:function(){if(!this.query.dateRange||2!==this.query.dateRange.length)return{};var t=(0,c.A)(this.query.dateRange,2),e=t[0],a=t[1];return{date_between:[e.startOf("day").format("YYYY-MM-DD"),a.endOf("day").format("YYYY-MM-DD")]}},applyPreset:function(t){this.query.rangePreset=t;var e,a=l()();switch(t){case"7d":e=a.clone().subtract(6,"days");break;case"90d":e=a.clone().subtract(89,"days");break;default:e=a.clone().subtract(29,"days");break}this.query.dateRange=[e.startOf("day"),a.endOf("day")]},handlePresetChange:function(t){this.applyPreset(t.target.value),this.handleSearch()},handleDateChange:function(){this.query.rangePreset=void 0},loadOverview:function(){var t=this;return(0,o.A)((0,i.A)().mark((function e(){var a,n;return(0,i.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=(0,s.A)({},t.getDateParams()),e.next=4,(0,d.UF)(a);case 4:n=e.sent,n&&(t.overview={income:Number(n.income||0),turnover:Number(n.turnover||0),order_count:Number(n.order_count||0),agent_count:Number(n.agent_count||0)}),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"概览数据加载失败");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},loadRanking:function(){var t=this;return(0,o.A)((0,i.A)().mark((function e(){var a,n;return(0,i.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.rankingLoading=!0,e.prev=1,a=(0,s.A)({metric:t.query.metric,limit:20},t.getDateParams()),e.next=5,(0,d.tl)(a);case 5:n=e.sent,t.ranking=(n||[]).map((function(t,e){return(0,s.A)((0,s.A)({},t),{},{rank:e+1})})),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"排行榜加载失败");case 12:return e.prev=12,t.rankingLoading=!1,e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})))()},loadDaily:function(){var t=arguments,e=this;return(0,o.A)((0,i.A)().mark((function a(){var n,r,o,c,u;return(0,i.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]&&t[0],n&&(e.query.page=1,e.dailyPagination.current=1),e.dailyLoading=!0,a.prev=3,r=(0,s.A)({page:e.query.page,per_page:e.query.per_page},e.getDateParams()),e.query.agentId&&(o=Number(e.query.agentId),Number.isFinite(o)&&(r.user_id=o)),a.next=8,(0,d.SE)(r);case 8:c=a.sent,u=(c.data||[]).map((function(t){return(0,s.A)((0,s.A)({},t),{},{id:"".concat(t.date||"","-").concat(t.user_id)})})),e.dailyList=u,e.dailyPagination=(0,s.A)((0,s.A)({},e.dailyPagination),{},{current:c.current_page||e.query.page,pageSize:c.per_page||e.query.per_page,total:c.total||0}),e.addAgentsToCache(u),a.next=18;break;case 15:a.prev=15,a.t0=a["catch"](3),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"日统计加载失败");case 18:return a.prev=18,e.dailyLoading=!1,a.finish(18);case 21:case"end":return a.stop()}}),a,null,[[3,15,18,21]])})))()},addAgentsToCache:function(t){var e=this;(t||[]).forEach((function(t){var a=Number(t.user_id);!Number.isFinite(a)||a<=0||(e.agentCache[a]=(0,s.A)((0,s.A)((0,s.A)({},e.agentCache[a]),t),{},{user_id:a,nickname:t.nickname||t.user_nickname}))}))},handleDailyChange:function(t){this.query.page=t.current,this.query.per_page=t.pageSize,this.loadDaily()},handleSearch:function(){this.loadOverview(),this.loadRanking(),this.loadDaily(!0)},reset:function(){this.query.dateRange=[],this.query.rangePreset="30d",this.query.metric="income",this.query.agentId=void 0,this.applyPreset("30d"),this.handleSearch()},openDetail:function(t){this.currentAgent={user_id:t.user_id,nickname:t.nickname||t.user_nickname},this.detailVisible=!0,this.detailRange="30d",this.loadAgentDetail()},loadAgentDetail:function(){var t=this;return(0,o.A)((0,i.A)().mark((function e(){var a,n;return(0,i.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.currentAgent){e.next=2;break}return e.abrupt("return");case 2:return t.detailLoading=!0,e.prev=3,e.next=6,(0,d.gF)({agent_id:t.currentAgent.user_id,range:t.detailRange});case 6:n=e.sent,t.detailSummary=null!==n&&void 0!==n&&n.summary?(0,s.A)({},n.summary):null,t.detailSeries=((null===n||void 0===n?void 0:n.series)||[]).map((function(t){return{date:t.date,income:Number(t.income||0),accounted:Number(t.accounted||0),turnover:Number(t.turnover||0),order_count:Number(t.order_count||0),share_count:Number(t.share_count||0),member_total:Number(t.member_total||0)}})),null!==(a=t.detailSummary)&&void 0!==a&&a.nickname&&(t.agentCache[t.currentAgent.user_id]=(0,s.A)((0,s.A)({},t.agentCache[t.currentAgent.user_id]||{}),{},{nickname:t.detailSummary.nickname})),e.next=17;break;case 12:e.prev=12,e.t0=e["catch"](3),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"统计数据获取失败"),t.detailSummary=null,t.detailSeries=[];case 17:return e.prev=17,t.detailLoading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[3,12,17,20]])})))()},handleDetailRangeChange:function(t){this.detailRange=t,this.loadAgentDetail()},closeDetail:function(){this.detailVisible=!1,this.detailLoading=!1,this.currentAgent=null,this.detailSummary=null,this.detailSeries=[],this.detailRange="30d"}}},p=m,h=a(81656),f=(0,h.A)(p,n,r,!1,null,"3f28752f",null),g=f.exports},40809:function(t,e,a){a.r(e),a.d(e,{default:function(){return v}});a(2892),a(9868);var n=function(){var t=this,e=t._self._c;return e("a-card",{attrs:{bordered:"false"}},[t.stats?e("div",{staticClass:"stats-cards"},[e("a-row",{attrs:{gutter:16}},[e("a-col",{attrs:{span:6}},[e("a-statistic",{attrs:{title:"待审核",value:t.stats.pending_count,suffix:"笔"},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("a-icon",{staticStyle:{color:"#fa8c16"},attrs:{type:"clock-circle"}})]},proxy:!0}],null,!1,3794870940)}),e("div",{staticClass:"stats-amount"},[t._v("￥"+t._s(Number(t.stats.pending_amount||0).toFixed(2)))])],1),e("a-col",{attrs:{span:6}},[e("a-statistic",{attrs:{title:"待打款",value:t.stats.approved_count,suffix:"笔"},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("a-icon",{staticStyle:{color:"#1890ff"},attrs:{type:"wallet"}})]},proxy:!0}],null,!1,3598131415)}),e("div",{staticClass:"stats-amount"},[t._v("￥"+t._s(Number(t.stats.approved_amount||0).toFixed(2)))])],1),e("a-col",{attrs:{span:6}},[e("a-statistic",{attrs:{title:"已打款",value:t.stats.paid_count,suffix:"笔"},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("a-icon",{staticStyle:{color:"#52c41a"},attrs:{type:"check-circle"}})]},proxy:!0}],null,!1,1662436009)}),e("div",{staticClass:"stats-amount"},[t._v("￥"+t._s(Number(t.stats.paid_amount||0).toFixed(2)))])],1),e("a-col",{attrs:{span:6}},[e("a-statistic",{attrs:{title:"手续费收入",value:Number(t.stats.total_fee||0).toFixed(2),prefix:"￥"},scopedSlots:t._u([{key:"prefix",fn:function(){return[e("a-icon",{staticStyle:{color:"#722ed1"},attrs:{type:"dollar"}})]},proxy:!0}],null,!1,3161448271)})],1)],1)],1):t._e(),e("a-divider"),e("div",{staticClass:"table-toolbar"},[e("div",{staticClass:"table-search"},[e("a-form",{attrs:{layout:"inline"}},[e("a-form-item",{attrs:{label:"状态"}},[e("a-select",{staticStyle:{width:"160px"},attrs:{allowClear:"",placeholder:"全部"},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},[e("a-select-option",{attrs:{value:"pending"}},[t._v("待审核")]),e("a-select-option",{attrs:{value:"approved"}},[t._v("待打款")]),e("a-select-option",{attrs:{value:"paid"}},[t._v("已打款")]),e("a-select-option",{attrs:{value:"rejected"}},[t._v("已拒绝")])],1)],1),e("a-form-item",{attrs:{label:"时间范围"}},[e("a-range-picker",{attrs:{format:"YYYY-MM-DD"},model:{value:t.query.date_between,callback:function(e){t.$set(t.query,"date_between",e)},expression:"query.date_between"}})],1),e("a-form-item",[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.loadData(!0)}}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),e("div",{staticClass:"table-actions"},[e("a-button",{attrs:{icon:"download",loading:t.exporting},on:{click:t.handleExport}},[t._v("导出Excel")]),t.$auth("distribution.withdrawals.approve")?e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",icon:"check",disabled:!t.selectedRowKeys.length},on:{click:t.handleBatchApprove}},[t._v(" 批量通过 "+t._s(t.selectedRowKeys.length?"(".concat(t.selectedRowKeys.length,")"):"")+" ")]):t._e(),t.$auth("distribution.withdrawals.approve")?e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",icon:"pay-circle",disabled:!t.approvedSelectedKeys.length},on:{click:t.handleBatchMarkPaid}},[t._v(" 批量打款 "+t._s(t.approvedSelectedKeys.length?"(".concat(t.approvedSelectedKeys.length,")"):"")+" ")]):t._e(),t.$auth("distribution.withdrawals.setting")?e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"setting"},on:{click:function(e){return t.$router.push("/distribution/withdrawals/setting")}}},[t._v(" 提现配置 ")]):t._e()],1)]),e("a-table",{attrs:{columns:t.columns,dataSource:t.list,loading:t.loading,pagination:t.pagination,rowSelection:t.rowSelection,rowKey:"id"},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"amount",fn:function(a){return e("span",{},[t._v(" ￥"+t._s(Number(a||0).toFixed(2))+" ")])}},{key:"status",fn:function(a){return e("span",{},[e("a-tag",{attrs:{color:t.statusColor(a)}},[t._v(t._s(t.statusText(a)))])],1)}},{key:"account",fn:function(a,n){return e("span",{},[t._v(" "+t._s(t.formatAccount(n))+" ")])}},{key:"actions",fn:function(a,n){return e("span",{},["pending"===n.status&&t.$auth("distribution.withdrawals.approve")?e("span",[e("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleApprove(n)}}},[t._v("通过")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"danger",size:"small"},on:{click:function(e){return t.handleReject(n)}}},[t._v("拒绝")])],1):"approved"===n.status&&t.$auth("distribution.withdrawals.approve")?e("span",[e("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleMarkPaid(n)}}},[t._v("标记打款")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"danger",size:"small"},on:{click:function(e){return t.handleReject(n)}}},[t._v("拒绝")])],1):t.$auth("distribution.withdrawals.approve")?e("span",[t._v("-")]):e("span",[t._v(" "+t._s(t.statusText(n.status))+" ")])])}}])})],1)},r=[],i=a(9133),s=(a(96305),a(43898)),o=a(69870),c=a(57888),u=a(17654),l=(a(28706),a(2008),a(74423),a(48598),a(62062),a(34782),a(26099),a(21699),a(47764),a(62953),a(3296),a(27208),a(48408),a(95093)),d=a.n(l),m=a(35491),p={data:function(){var t=this;return{loading:!1,exporting:!1,list:[],stats:null,selectedRowKeys:[],query:{page:1,per_page:10,status:void 0,date_between:[]},pagination:{current:1,pageSize:10,total:0,showTotal:function(t){return"共 ".concat(t," 条")}},columns:[{title:"ID",dataIndex:"id",width:80},{title:"用户ID",dataIndex:"user_id",width:100},{title:"提现金额",dataIndex:"amount",scopedSlots:{customRender:"amount"},width:120},{title:"手续费",dataIndex:"fee",customRender:function(t){return"￥".concat(Number(t||0).toFixed(2))},width:100},{title:"实际到账",dataIndex:"actual_amount",customRender:function(t){return"￥".concat(Number(t||0).toFixed(2))},width:120},{title:"到账方式",scopedSlots:{customRender:"account"},width:150},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"},width:100},{title:"申请时间",dataIndex:"created_at",customRender:function(e){return t.formatDate(e)},width:160},{title:"审核时间",dataIndex:"reviewed_at",customRender:function(e){return t.formatDate(e)},width:160},{title:"打款时间",dataIndex:"paid_at",customRender:function(e){return t.formatDate(e)},width:160},{title:"操作",scopedSlots:{customRender:"actions"},width:180,fixed:"right"}]}},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange,getCheckboxProps:function(t){return{props:{disabled:"paid"===t.status||"rejected"===t.status}}}}},approvedSelectedKeys:function(){var t=this;return this.list.filter((function(e){return t.selectedRowKeys.includes(e.id)&&"approved"===e.status})).map((function(t){return t.id}))},pendingSelectedKeys:function(){var t=this;return this.list.filter((function(e){return t.selectedRowKeys.includes(e.id)&&"pending"===e.status})).map((function(t){return t.id}))}},mounted:function(){this.loadData(!0),this.loadStats()},methods:{loadData:function(){var t=arguments,e=this;return(0,u.A)((0,o.A)().mark((function a(){var n,r,i;return(0,o.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]&&t[0],n&&(e.query.page=1,e.pagination.current=1,e.selectedRowKeys=[]),e.loading=!0,a.prev=3,r=(0,c.A)({},e.query),r.date_between&&2===r.date_between.length?r.date_between=[r.date_between[0].format("YYYY-MM-DD"),r.date_between[1].format("YYYY-MM-DD")]:delete r.date_between,a.next=8,(0,m.v7)(r);case 8:i=a.sent,e.list=i.data||[],e.pagination=(0,c.A)((0,c.A)({},e.pagination),{},{current:i.current_page||1,pageSize:i.per_page||e.query.per_page,total:i.total||0}),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](3),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"加载失败");case 16:return a.prev=16,e.loading=!1,a.finish(16);case 19:case"end":return a.stop()}}),a,null,[[3,13,16,19]])})))()},loadStats:function(){var t=this;return(0,u.A)((0,o.A)().mark((function e(){return(0,o.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,m.RV)({period:"month"});case 3:t.stats=e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e["catch"](0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))()},handleTableChange:function(t){this.query.page=t.current,this.query.per_page=t.pageSize,this.loadData()},onSelectChange:function(t){this.selectedRowKeys=t},reset:function(){this.query.status=void 0,this.query.date_between=[],this.loadData(!0)},statusText:function(t){switch(t){case"pending":return"待审核";case"approved":return"待打款";case"paid":return"已打款";case"rejected":return"已拒绝";default:return t}},statusColor:function(t){switch(t){case"pending":return"orange";case"approved":return"blue";case"paid":return"green";case"rejected":return"red";default:return"purple"}},formatDate:function(t){return t?d()(t).format("YYYY-MM-DD HH:mm"):"-"},formatAccount:function(t){if(!t)return"-";if("wechat"===t.account_type||!t.account_type)return"微信零钱";var e=t.account_info||{};if("alipay"===t.account_type)return"支付宝 ".concat(e.account_no||"");if("bank_card"===t.account_type){var a=e.account_no?e.account_no.slice(-4):"";return"".concat(e.bank_name||"银行卡"," (***").concat(a,")")}return t.account_type},handleApprove:function(t){var e=this;return(0,u.A)((0,o.A)().mark((function a(){return(0,o.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:s.A.confirm({title:"确认操作",content:"确认通过该提现申请吗？",onOk:function(){var a=(0,u.A)((0,o.A)().mark((function a(){return(0,o.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,m.Vm)(t.id);case 3:e.$message.success("操作成功"),e.loadData(),e.loadStats(),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](0),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"操作失败");case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));function n(){return a.apply(this,arguments)}return n}()});case 1:case"end":return a.stop()}}),a)})))()},handleReject:function(t){var e=this;return(0,u.A)((0,o.A)().mark((function a(){return(0,o.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:s.A.confirm({title:"确认操作",content:"确认拒绝该提现申请吗？",onOk:function(){var a=(0,u.A)((0,o.A)().mark((function a(){return(0,o.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,m.Tb)(t.id);case 3:e.$message.success("已拒绝"),e.loadData(),e.loadStats(),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](0),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"操作失败");case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));function n(){return a.apply(this,arguments)}return n}()});case 1:case"end":return a.stop()}}),a)})))()},handleMarkPaid:function(t){var e=this;return(0,u.A)((0,o.A)().mark((function a(){return(0,o.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:s.A.confirm({title:"确认操作",content:"确认已完成打款？",onOk:function(){var a=(0,u.A)((0,o.A)().mark((function a(){return(0,o.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,m.xY)(t.id);case 3:e.$message.success("已标记打款"),e.loadData(),e.loadStats(),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](0),e.$message.error((null===a.t0||void 0===a.t0?void 0:a.t0.msg)||"操作失败");case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));function n(){return a.apply(this,arguments)}return n}()});case 1:case"end":return a.stop()}}),a)})))()},handleBatchApprove:function(){var t=this;return(0,u.A)((0,o.A)().mark((function e(){var a;return(0,o.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.pendingSelectedKeys,a.length){e.next=4;break}return t.$message.warning("请选择待审核的记录"),e.abrupt("return");case 4:s.A.confirm({title:"批量审核通过",content:"确认批量通过 ".concat(a.length," 条提现申请吗？"),onOk:function(){var e=(0,u.A)((0,o.A)().mark((function e(){var n;return(0,o.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,m.Sm)(a);case 3:n=e.sent,t.$message.success("成功通过 ".concat(n.success_count," 条")),n.failed_ids&&n.failed_ids.length&&t.$message.warning("".concat(n.failed_ids.length," 条失败")),t.selectedRowKeys=[],t.loadData(),t.loadStats(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"批量操作失败");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));function n(){return e.apply(this,arguments)}return n}()});case 5:case"end":return e.stop()}}),e)})))()},handleBatchMarkPaid:function(){var t=this;return(0,u.A)((0,o.A)().mark((function e(){var a;return(0,o.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.approvedSelectedKeys,a.length){e.next=4;break}return t.$message.warning("请选择待打款的记录"),e.abrupt("return");case 4:s.A.confirm({title:"批量标记打款",content:"确认批量标记 ".concat(a.length," 条记录为已打款吗？"),onOk:function(){var e=(0,u.A)((0,o.A)().mark((function e(){var n;return(0,o.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,m.Gk)(a);case 3:n=e.sent,t.$message.success("成功标记 ".concat(n.success_count," 条")),n.failed_ids&&n.failed_ids.length&&t.$message.warning("".concat(n.failed_ids.length," 条失败")),t.selectedRowKeys=[],t.loadData(),t.loadStats(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"批量操作失败");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));function n(){return e.apply(this,arguments)}return n}()});case 5:case"end":return e.stop()}}),e)})))()},handleExport:function(){var t=this;return(0,u.A)((0,o.A)().mark((function e(){var a,n,r,s,u,l,p;return(0,o.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.exporting=!0,e.prev=1,a=(0,c.A)({},t.query),a.date_between&&2===a.date_between.length?a.date_between=[a.date_between[0].format("YYYY-MM-DD"),a.date_between[1].format("YYYY-MM-DD")]:delete a.date_between,e.next=6,(0,m.dE)(a);case 6:n=e.sent,r=["ID","用户ID","用户昵称","提现金额","手续费","实际到账","到账方式","账户信息","状态","申请时间","审核时间","打款时间"],s=n.map((function(e){return[e.id,e.user_id,e.user_nickname||"",e.amount,e.fee,e.actual_amount,"wechat"===e.account_type?"微信零钱":e.account_type,e.account_info?JSON.stringify(e.account_info):"",t.statusText(e.status),e.created_at||"",e.reviewed_at||"",e.paid_at||""]})),u=[r].concat((0,i.A)(s)).map((function(t){return t.map((function(t){return'"'.concat(t,'"')})).join(",")})).join("\n"),l=new Blob(["\ufeff"+u],{type:"text/csv;charset=utf-8"}),p=document.createElement("a"),p.href=URL.createObjectURL(l),p.download="提现记录_".concat(d()().format("YYYYMMDD_HHmmss"),".csv"),p.click(),t.$message.success("导出成功"),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](1),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"导出失败");case 21:return e.prev=21,t.exporting=!1,e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[1,18,21,24]])})))()}}},h=p,f=a(81656),g=(0,f.A)(h,n,r,!1,null,"16be04a9",null),v=g.exports},31126:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var n=function(){var t=this,e=t._self._c;return e("a-card",{attrs:{bordered:"false",title:"提现配置"}},[e("a-spin",{attrs:{spinning:t.loading}},[e("a-form",{attrs:{form:t.form,"label-col":{span:6},"wrapper-col":{span:14}}},[e("a-divider",[t._v("基础配置")]),e("a-form-item",{attrs:{label:"手续费类型"}},[e("a-radio-group",{model:{value:t.config.withdrawal_fee_type,callback:function(e){t.$set(t.config,"withdrawal_fee_type",e)},expression:"config.withdrawal_fee_type"}},[e("a-radio",{attrs:{value:"fixed"}},[t._v("固定金额")]),e("a-radio",{attrs:{value:"percent"}},[t._v("按比例")])],1)],1),e("a-form-item",{attrs:{label:"percent"===t.config.withdrawal_fee_type?"手续费比例":"手续费金额"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:0,max:"percent"===t.config.withdrawal_fee_type?100:void 0,precision:2},model:{value:t.config.withdrawal_fee_amount,callback:function(e){t.$set(t.config,"withdrawal_fee_amount",e)},expression:"config.withdrawal_fee_amount"}}),e("span",{staticClass:"ant-form-text"},[t._v(t._s("percent"===t.config.withdrawal_fee_type?"%":"元/笔"))])],1),e("a-form-item",{attrs:{label:"最低提现金额"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:.01,precision:2},model:{value:t.config.withdrawal_min_amount,callback:function(e){t.$set(t.config,"withdrawal_min_amount",e)},expression:"config.withdrawal_min_amount"}}),e("span",{staticClass:"ant-form-text"},[t._v("元")])],1),e("a-form-item",{attrs:{label:"每日提现限制"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:0,precision:0},model:{value:t.config.withdrawal_daily_limit,callback:function(e){t.$set(t.config,"withdrawal_daily_limit",e)},expression:"config.withdrawal_daily_limit"}}),e("span",{staticClass:"ant-form-text"},[t._v("笔（0表示不限制）")])],1),e("a-form-item",{attrs:{label:"每月提现限制"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:0,precision:0},model:{value:t.config.withdrawal_monthly_limit,callback:function(e){t.$set(t.config,"withdrawal_monthly_limit",e)},expression:"config.withdrawal_monthly_limit"}}),e("span",{staticClass:"ant-form-text"},[t._v("笔（0表示不限制）")])],1),e("a-form-item",{attrs:{label:"预计到账时间"}},[e("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"如：1-3"},model:{value:t.config.withdrawal_estimated_days,callback:function(e){t.$set(t.config,"withdrawal_estimated_days",e)},expression:"config.withdrawal_estimated_days"}}),e("span",{staticClass:"ant-form-text"},[t._v("工作日")])],1),e("a-divider",[t._v("安全配置")]),e("a-form-item",{attrs:{label:"首次提现冷静期"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:0,precision:0},model:{value:t.config.withdrawal_cooldown_hours,callback:function(e){t.$set(t.config,"withdrawal_cooldown_hours",e)},expression:"config.withdrawal_cooldown_hours"}}),e("span",{staticClass:"ant-form-text"},[t._v("小时（0表示无冷静期）")])],1),e("a-form-item",{attrs:{label:"大额审核阈值"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:0,precision:2},model:{value:t.config.withdrawal_large_amount_threshold,callback:function(e){t.$set(t.config,"withdrawal_large_amount_threshold",e)},expression:"config.withdrawal_large_amount_threshold"}}),e("span",{staticClass:"ant-form-text"},[t._v("元（超过此金额需人工审核）")])],1),e("a-form-item",{attrs:{label:"手机号验证"}},[e("a-switch",{model:{value:t.config.withdrawal_phone_verify_enabled,callback:function(e){t.$set(t.config,"withdrawal_phone_verify_enabled",e)},expression:"config.withdrawal_phone_verify_enabled"}}),e("span",{staticClass:"ant-form-text"},[t._v("提现前需验证微信手机号")])],1),e("a-divider",[t._v("风控配置")]),e("a-form-item",{attrs:{label:"1小时提现次数上限"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:0,precision:0},model:{value:t.config.withdrawal_risk_hourly_count,callback:function(e){t.$set(t.config,"withdrawal_risk_hourly_count",e)},expression:"config.withdrawal_risk_hourly_count"}}),e("span",{staticClass:"ant-form-text"},[t._v("次（超过触发风控）")])],1),e("a-form-item",{attrs:{label:"1小时提现金额上限"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:0,precision:2},model:{value:t.config.withdrawal_risk_hourly_amount,callback:function(e){t.$set(t.config,"withdrawal_risk_hourly_amount",e)},expression:"config.withdrawal_risk_hourly_amount"}}),e("span",{staticClass:"ant-form-text"},[t._v("元（超过触发风控）")])],1),e("a-form-item",{attrs:{label:"风控企业微信通知"}},[e("a-switch",{model:{value:t.config.withdrawal_risk_notify_wework,callback:function(e){t.$set(t.config,"withdrawal_risk_notify_wework",e)},expression:"config.withdrawal_risk_notify_wework"}}),e("span",{staticClass:"ant-form-text"},[t._v("触发风控时推送企业微信通知给管理员")])],1),e("a-divider",[t._v("VIP快速提现")]),e("a-form-item",{attrs:{label:"免审核分销等级"}},[e("a-select",{staticStyle:{width:"200px"},model:{value:t.config.withdrawal_fast_min_level,callback:function(e){t.$set(t.config,"withdrawal_fast_min_level",e)},expression:"config.withdrawal_fast_min_level"}},[e("a-select-option",{attrs:{value:0}},[t._v("不启用")]),e("a-select-option",{attrs:{value:1}},[t._v("1级及以上")]),e("a-select-option",{attrs:{value:2}},[t._v("2级及以上")]),e("a-select-option",{attrs:{value:3}},[t._v("3级及以上")])],1),e("span",{staticClass:"ant-form-text"},[t._v("达到等级且金额≤大额阈值时自动通过")])],1),e("a-divider",[t._v("自动提现")]),e("a-form-item",{attrs:{label:"开启自动提现"}},[e("a-switch",{model:{value:t.config.withdrawal_auto_enabled,callback:function(e){t.$set(t.config,"withdrawal_auto_enabled",e)},expression:"config.withdrawal_auto_enabled"}}),e("span",{staticClass:"ant-form-text"},[e("a-tag",{attrs:{color:"orange"}},[t._v("仅支持微信零钱")])],1)],1),t.config.withdrawal_auto_enabled?e("a-form-item",{attrs:{label:"触发阈值"}},[e("a-input-number",{staticStyle:{width:"200px"},attrs:{min:1,precision:2},model:{value:t.config.withdrawal_auto_threshold,callback:function(e){t.$set(t.config,"withdrawal_auto_threshold",e)},expression:"config.withdrawal_auto_threshold"}}),e("span",{staticClass:"ant-form-text"},[t._v("元（余额达到此金额时自动提现）")])],1):t._e(),t.config.withdrawal_auto_enabled?e("a-form-item",{attrs:{label:"执行时间"}},[e("a-time-picker",{staticStyle:{width:"200px"},attrs:{format:"HH:mm"},on:{change:t.onAutoTimeChange},model:{value:t.autoTimeValue,callback:function(e){t.autoTimeValue=e},expression:"autoTimeValue"}}),e("span",{staticClass:"ant-form-text"},[t._v("每日执行时间")])],1):t._e(),e("a-form-item",{attrs:{"wrapper-col":{span:14,offset:6}}},[e("a-button",{attrs:{type:"primary",loading:t.saving},on:{click:t.handleSubmit}},[t._v("保存配置")]),e("a-button",{staticStyle:{"margin-left":"10px"},on:{click:t.loadConfig}},[t._v("重置")])],1)],1)],1)],1)},r=[],i=a(69870),s=a(17654),o=(a(79432),a(26099),a(23500),a(95093)),c=a.n(o),u=a(35491),l={name:"WithdrawalSetting",data:function(){return{loading:!1,saving:!1,form:this.$form.createForm(this),autoTimeValue:null,config:{withdrawal_fee_type:"fixed",withdrawal_fee_amount:0,withdrawal_min_amount:1,withdrawal_daily_limit:3,withdrawal_monthly_limit:10,withdrawal_estimated_days:"1-3",withdrawal_cooldown_hours:0,withdrawal_large_amount_threshold:500,withdrawal_phone_verify_enabled:!1,withdrawal_risk_hourly_count:5,withdrawal_risk_hourly_amount:1e3,withdrawal_risk_notify_wework:!0,withdrawal_fast_min_level:0,withdrawal_auto_enabled:!1,withdrawal_auto_threshold:100,withdrawal_auto_time:"10:00"}}},mounted:function(){this.loadConfig()},methods:{loadConfig:function(){var t=this;return(0,s.A)((0,i.A)().mark((function e(){var a;return(0,i.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,(0,u.M0)();case 4:a=e.sent,a&&(Object.keys(t.config).forEach((function(e){void 0!==a[e]&&(t.config[e]=a[e])})),t.config.withdrawal_auto_time&&(t.autoTimeValue=c()(t.config.withdrawal_auto_time,"HH:mm"))),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"加载配置失败");case 11:return e.prev=11,t.loading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})))()},onAutoTimeChange:function(t,e){this.config.withdrawal_auto_time=e},handleSubmit:function(){var t=this;return(0,s.A)((0,i.A)().mark((function e(){return(0,i.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.saving=!0,e.prev=1,e.next=4,(0,u.xc)(t.config);case 4:t.$message.success("保存成功"),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),t.$message.error((null===e.t0||void 0===e.t0?void 0:e.t0.msg)||"保存失败");case 10:return e.prev=10,t.saving=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})))()}}},d=l,m=a(81656),p=(0,m.A)(d,n,r,!1,null,"25ad2c47",null),h=p.exports},35491:function(t,e,a){a.d(e,{$X:function(){return m},Gg:function(){return d},Gk:function(){return R},L_:function(){return u},M0:function(){return A},RS:function(){return h},RV:function(){return S},SE:function(){return w},Sm:function(){return D},Sn:function(){return o},Tb:function(){return v},UF:function(){return b},Vm:function(){return g},dE:function(){return C},gF:function(){return x},oQ:function(){return l},pQ:function(){return s},tl:function(){return y},v7:function(){return f},vt:function(){return p},x4:function(){return c},xY:function(){return _},xc:function(){return k}});var n=a(57888),r=(a(27495),a(25440),a(26222)),i={agents:"/agents",agentDetail:"/agents/{id}",agentStats:"/agents/{id}/stats",createAgent:"/agents",updateAgent:"/agents/{id}",managerAgents:"/members/{id}/agents",assignAgents:"/members/{id}/assign_agents",managers:"/members",rebates:"/rebates",rebateApprove:"/rebates/{id}/approve",rebateReject:"/rebates/{id}/reject",withdrawals:"/withdrawals",withdrawalApprove:"/withdrawals/{id}/approve",withdrawalReject:"/withdrawals/{id}/reject",withdrawalMarkPaid:"/withdrawals/{id}/mark_paid",withdrawalConfig:"/settings/withdrawal",withdrawalStats:"/withdrawals/stats",withdrawalExport:"/withdrawals/export",withdrawalBatchApprove:"/withdrawals/batch_approve",withdrawalBatchMarkPaid:"/withdrawals/batch_mark_paid",statsDaily:"/agents/stats/daily",statsRanking:"/agents/stats/ranking",statsOverall:"/agents/stats/overall",statsTeam:"/agents/stats/team",statsDetail:"/agents/stats/detail"};function s(t){return(0,r.p)({url:i.agents,method:"get",params:t})}function o(t){return(0,r.p)({url:i.createAgent,method:"post",data:t})}function c(t,e){return(0,r.p)({url:i.updateAgent.replace("{id}",t),method:"patch",data:e})}function u(t){return(0,r.p)({url:i.managers,method:"get",params:(0,n.A)((0,n.A)({},t),{},{role:"分销管理员"})})}function l(t,e){return(0,r.p)({url:i.assignAgents.replace("{id}",t),method:"post",data:e})}function d(t,e){return(0,r.p)({url:i.managerAgents.replace("{id}",t),method:"get",params:e})}function m(t){return(0,r.p)({url:i.rebates,method:"get",params:t})}function p(t,e){return(0,r.p)({url:i.rebateApprove.replace("{id}",t),method:"patch",data:e})}function h(t,e){return(0,r.p)({url:i.rebateReject.replace("{id}",t),method:"patch",data:e})}function f(t){return(0,r.p)({url:i.withdrawals,method:"get",params:t})}function g(t,e){return(0,r.p)({url:i.withdrawalApprove.replace("{id}",t),method:"patch",data:e})}function v(t,e){return(0,r.p)({url:i.withdrawalReject.replace("{id}",t),method:"patch",data:e})}function _(t,e){return(0,r.p)({url:i.withdrawalMarkPaid.replace("{id}",t),method:"patch",data:e})}function w(t){return(0,r.p)({url:i.statsDaily,method:"get",params:t})}function y(t){return(0,r.p)({url:i.statsRanking,method:"get",params:t})}function b(t){return(0,r.p)({url:i.statsOverall,method:"get",params:t})}function x(t){return(0,r.p)({url:i.statsDetail,method:"get",params:t})}function A(){return(0,r.p)({url:i.withdrawalConfig,method:"get"})}function k(t){return(0,r.p)({url:i.withdrawalConfig,method:"put",data:{values:t}})}function S(t){return(0,r.p)({url:i.withdrawalStats,method:"get",params:t})}function C(t){return(0,r.p)({url:i.withdrawalExport,method:"get",params:t})}function D(t){return(0,r.p)({url:i.withdrawalBatchApprove,method:"post",data:{ids:t}})}function R(t){return(0,r.p)({url:i.withdrawalBatchMarkPaid,method:"post",data:{ids:t}})}},17654:function(t,e,a){a.d(e,{A:function(){return r}});a(26099);function n(t,e,a,n,r,i,s){try{var o=t[i](s),c=o.value}catch(t){return void a(t)}o.done?e(c):Promise.resolve(c).then(n,r)}function r(t){return function(){var e=this,a=arguments;return new Promise((function(r,i){var s=t.apply(e,a);function o(t){n(s,r,i,o,c,"next",t)}function c(t){n(s,r,i,o,c,"throw",t)}o(void 0)}))}}},69870:function(t,e,a){a.d(e,{A:function(){return r}});a(52675),a(89463),a(66412),a(2259),a(78125),a(34782),a(62010),a(4731),a(60479),a(40875),a(10287),a(26099),a(47764),a(23500),a(62953);var n=a(68285);function r(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
r=function(){return e};var t,e={},a=Object.prototype,i=a.hasOwnProperty,s=Object.defineProperty||function(t,e,a){t[e]=a.value},o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function d(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,a){return t[e]=a}}function m(t,e,a,n){var r=e&&e.prototype instanceof w?e:w,i=Object.create(r.prototype),o=new O(n||[]);return s(i,"_invoke",{value:R(t,a,o)}),i}function p(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(t){return{type:"throw",arg:t}}}e.wrap=m;var h="suspendedStart",f="suspendedYield",g="executing",v="completed",_={};function w(){}function y(){}function b(){}var x={};d(x,c,(function(){return this}));var A=Object.getPrototypeOf,k=A&&A(A($([])));k&&k!==a&&i.call(k,c)&&(x=k);var S=b.prototype=w.prototype=Object.create(x);function C(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function a(r,s,o,c){var u=p(t[r],t,s);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==(0,n.A)(d)&&i.call(d,"__await")?e.resolve(d.__await).then((function(t){a("next",t,o,c)}),(function(t){a("throw",t,o,c)})):e.resolve(d).then((function(t){l.value=t,o(l)}),(function(t){return a("throw",t,o,c)}))}c(u.arg)}var r;s(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,r){a(t,n,e,r)}))}return r=r?r.then(i,i):i()}})}function R(e,a,n){var r=h;return function(i,s){if(r===g)throw Error("Generator is already running");if(r===v){if("throw"===i)throw s;return{value:t,done:!0}}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var c=I(o,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=g;var u=p(e,a,n);if("normal"===u.type){if(r=n.done?v:f,u.arg===_)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=v,n.method="throw",n.arg=u.arg)}}}function I(e,a){var n=a.method,r=e.iterator[n];if(r===t)return a.delegate=null,"throw"===n&&e.iterator["return"]&&(a.method="return",a.arg=t,I(e,a),"throw"===a.method)||"return"!==n&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var i=p(r,e.iterator,a.arg);if("throw"===i.type)return a.method="throw",a.arg=i.arg,a.delegate=null,_;var s=i.arg;return s?s.done?(a[e.resultName]=s.value,a.next=e.nextLoc,"return"!==a.method&&(a.method="next",a.arg=t),a.delegate=null,_):s:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,_)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function q(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function $(e){if(e||""===e){var a=e[c];if(a)return a.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function a(){for(;++r<e.length;)if(i.call(e,r))return a.value=e[r],a.done=!1,a;return a.value=t,a.done=!0,a};return s.next=s}}throw new TypeError((0,n.A)(e)+" is not iterable")}return y.prototype=b,s(S,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:y,configurable:!0}),y.displayName=d(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,d(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},C(D.prototype),d(D.prototype,u,(function(){return this})),e.AsyncIterator=D,e.async=function(t,a,n,r,i){void 0===i&&(i=Promise);var s=new D(m(t,a,n,r),i);return e.isGeneratorFunction(a)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},C(S),d(S,l,"Generator"),d(S,c,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),a=[];for(var n in e)a.push(n);return a.reverse(),function t(){for(;a.length;){var n=a.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=$,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(q),!e)for(var a in this)"t"===a.charAt(0)&&i.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var a=this;function n(n,r){return o.type="throw",o.arg=e,a.next=n,r&&(a.method="next",a.arg=t),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,_):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),q(a),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var n=a.completion;if("throw"===n.type){var r=n.arg;q(a)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,a,n){return this.delegate={iterator:$(e),resultName:a,nextLoc:n},"next"===this.method&&(this.arg=t),_}},e}}}]);