(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["store"],{"1da1":function(e,a,t){"use strict";t.d(a,"a",(function(){return r}));t("d3b7");function n(e,a,t,n,r,i,o){try{var l=e[i](o),s=l.value}catch(c){return void t(c)}l.done?a(s):Promise.resolve(s).then(n,r)}function r(e){return function(){var a=this,t=arguments;return new Promise((function(r,i){var o=e.apply(a,t);function l(e){n(o,r,i,l,s,"next",e)}function s(e){n(o,r,i,l,s,"throw",e)}l(void 0)}))}}},2557:function(e,a,t){},"27d2":function(e,a,t){"use strict";t("f341")},"4d55":function(e,a,t){"use strict";t.d(a,"e",(function(){return i})),t.d(a,"b",(function(){return o})),t.d(a,"a",(function(){return l})),t.d(a,"d",(function(){return s})),t.d(a,"c",(function(){return c}));t("ac1f"),t("5319");var n=t("b775"),r={list:"/stores",all:"/stores",add:"/stores",edit:"/stores/{id}",delete:"/stores/{id}"};function i(e){return Object(n["b"])({url:r.list,method:"get",params:e})}function o(e){return Object(n["b"])({url:r.all,method:"get",params:e})}function l(e){return Object(n["b"])({url:r.add,method:"post",data:e})}function s(e,a){return Object(n["b"])({url:r.edit.replace("{id}",e),method:"patch",data:a})}function c(e){return Object(n["b"])({url:r.delete.replace("{id}",e),method:"delete"})}},"862d3":function(e,a,t){"use strict";(function(a,t){e.exports=t()})(0,(function(){function e(e){var n=[];return e.AMapUI&&n.push(a(e.AMapUI)),e.Loca&&n.push(t(e.Loca)),Promise.all(n)}function a(e){return new Promise((function(a,t){var l=[];if(e.plugins)for(var s=0;s<e.plugins.length;s+=1)-1==r.AMapUI.plugins.indexOf(e.plugins[s])&&l.push(e.plugins[s]);if(i.AMapUI===n.failed)t("前次请求 AMapUI 失败");else if(i.AMapUI===n.notload){i.AMapUI=n.loading,r.AMapUI.version=e.version||r.AMapUI.version,s=r.AMapUI.version;var c=document.body||document.head,d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/ui/"+s+"/main.js",d.onerror=function(e){i.AMapUI=n.failed,t("请求 AMapUI 失败")},d.onload=function(){if(i.AMapUI=n.loaded,l.length)window.AMapUI.loadUI(l,(function(){for(var e=0,t=l.length;e<t;e++){var n=l[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}for(a();o.AMapUI.length;)o.AMapUI.splice(0,1)[0]()}));else for(a();o.AMapUI.length;)o.AMapUI.splice(0,1)[0]()},c.appendChild(d)}else i.AMapUI===n.loaded?e.version&&e.version!==r.AMapUI.version?t("不允许多个版本 AMapUI 混用"):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,t=l.length;e<t;e++){var n=l[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}a()})):a():e.version&&e.version!==r.AMapUI.version?t("不允许多个版本 AMapUI 混用"):o.AMapUI.push((function(e){e?t(e):l.length?window.AMapUI.loadUI(l,(function(){for(var e=0,t=l.length;e<t;e++){var n=l[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}a()})):a()}))}))}function t(e){return new Promise((function(a,t){if(i.Loca===n.failed)t("前次请求 Loca 失败");else if(i.Loca===n.notload){i.Loca=n.loading,r.Loca.version=e.version||r.Loca.version;var l=r.Loca.version,s=r.AMap.version.startsWith("2"),c=l.startsWith("2");if(s&&!c||!s&&c)t("JSAPI 与 Loca 版本不对应！！");else{s=r.key,c=document.body||document.head;var d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/loca?v="+l+"&key="+s,d.onerror=function(e){i.Loca=n.failed,t("请求 AMapUI 失败")},d.onload=function(){for(i.Loca=n.loaded,a();o.Loca.length;)o.Loca.splice(0,1)[0]()},c.appendChild(d)}}else i.Loca===n.loaded?e.version&&e.version!==r.Loca.version?t("不允许多个版本 Loca 混用"):a():e.version&&e.version!==r.Loca.version?t("不允许多个版本 Loca 混用"):o.Loca.push((function(e){e?t(e):t()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var n;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(n||(n={}));var r={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},o={AMap:[],AMapUI:[],Loca:[]},l=[],s=function(e){"function"==typeof e&&(i.AMap===n.loaded?e(window.AMap):l.push(e))};return{load:function(a){return new Promise((function(t,o){if(i.AMap==n.failed)o("");else if(i.AMap==n.notload){var c=a.key,d=a.version,u=a.plugins;c?(window.AMap&&"lbs.amap.com"!==location.host&&o("禁止多种API加载方式混用"),r.key=c,r.AMap.version=d||r.AMap.version,r.AMap.plugins=u||r.AMap.plugins,i.AMap=n.loading,d=document.body||document.head,window.___onAPILoaded=function(r){if(delete window.___onAPILoaded,r)i.AMap=n.failed,o(r);else for(i.AMap=n.loaded,e(a).then((function(){t(window.AMap)}))["catch"](o);l.length;)l.splice(0,1)[0]()},u=document.createElement("script"),u.type="text/javascript",u.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+r.AMap.version+"&key="+c+"&plugin="+r.AMap.plugins.join(","),u.onerror=function(e){i.AMap=n.failed,o(e)},d.appendChild(u)):o("请填写key")}else if(i.AMap==n.loaded)if(a.key&&a.key!==r.key)o("多个不一致的 key");else if(a.version&&a.version!==r.AMap.version)o("不允许多个版本 JSAPI 混用");else{if(c=[],a.plugins)for(d=0;d<a.plugins.length;d+=1)-1==r.AMap.plugins.indexOf(a.plugins[d])&&c.push(a.plugins[d]);c.length?window.AMap.plugin(c,(function(){e(a).then((function(){t(window.AMap)}))["catch"](o)})):e(a).then((function(){t(window.AMap)}))["catch"](o)}else if(a.key&&a.key!==r.key)o("多个不一致的 key");else if(a.version&&a.version!==r.AMap.version)o("不允许多个版本 JSAPI 混用");else{var p=[];if(a.plugins)for(d=0;d<a.plugins.length;d+=1)-1==r.AMap.plugins.indexOf(a.plugins[d])&&p.push(a.plugins[d]);s((function(){p.length?window.AMap.plugin(p,(function(){e(a).then((function(){t(window.AMap)}))["catch"](o)})):e(a).then((function(){t(window.AMap)}))["catch"](o)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,r={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},o={AMap:[],AMapUI:[],Loca:[]}}}}))},"88bc":function(e,a,t){(function(a){var t=1/0,n=9007199254740991,r="[object Arguments]",i="[object Function]",o="[object GeneratorFunction]",l="[object Symbol]",s="object"==typeof a&&a&&a.Object===Object&&a,c="object"==typeof self&&self&&self.Object===Object&&self,d=s||c||Function("return this")();function u(e,a,t){switch(t.length){case 0:return e.call(a);case 1:return e.call(a,t[0]);case 2:return e.call(a,t[0],t[1]);case 3:return e.call(a,t[0],t[1],t[2])}return e.apply(a,t)}function p(e,a){var t=-1,n=e?e.length:0,r=Array(n);while(++t<n)r[t]=a(e[t],t,e);return r}function m(e,a){var t=-1,n=a.length,r=e.length;while(++t<n)e[r+t]=a[t];return e}var f=Object.prototype,h=f.hasOwnProperty,v=f.toString,g=d.Symbol,b=f.propertyIsEnumerable,y=g?g.isConcatSpreadable:void 0,w=Math.max;function C(e,a,t,n,r){var i=-1,o=e.length;t||(t=k),r||(r=[]);while(++i<o){var l=e[i];a>0&&t(l)?a>1?C(l,a-1,t,n,r):m(r,l):n||(r[r.length]=l)}return r}function A(e,a){return e=Object(e),M(e,a,(function(a,t){return t in e}))}function M(e,a,t){var n=-1,r=a.length,i={};while(++n<r){var o=a[n],l=e[o];t(l,o)&&(i[o]=l)}return i}function _(e,a){return a=w(void 0===a?e.length-1:a,0),function(){var t=arguments,n=-1,r=w(t.length-a,0),i=Array(r);while(++n<r)i[n]=t[a+n];n=-1;var o=Array(a+1);while(++n<a)o[n]=t[n];return o[a]=i,u(e,this,o)}}function k(e){return S(e)||I(e)||!!(y&&e&&e[y])}function x(e){if("string"==typeof e||P(e))return e;var a=e+"";return"0"==a&&1/e==-t?"-0":a}function I(e){return O(e)&&h.call(e,"callee")&&(!b.call(e,"callee")||v.call(e)==r)}var S=Array.isArray;function L(e){return null!=e&&F(e.length)&&!j(e)}function O(e){return $(e)&&L(e)}function j(e){var a=E(e)?v.call(e):"";return a==i||a==o}function F(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function E(e){var a=typeof e;return!!e&&("object"==a||"function"==a)}function $(e){return!!e&&"object"==typeof e}function P(e){return"symbol"==typeof e||$(e)&&v.call(e)==l}var q=_((function(e,a){return null==e?{}:A(e,p(C(a,1),x))}));e.exports=q}).call(this,t("c8ba"))},c2d4:function(e,a,t){"use strict";t("2557")},cad8e:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-card",{attrs:{bordered:!1}},[t("div",{staticClass:"card-title"},[e._v(e._s(e.$route.meta.title))]),t("div",{staticClass:"table-operator"},[t("a-row",[t("a-col",{attrs:{span:5}},[t("a-button",{directives:[{name:"action",rawName:"v-action:add",arg:"add"}],attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1),t("a-col",{staticClass:"flex flex-x-end",attrs:{span:11,offset:8}},[t("SelectRegion",{attrs:{placeholder:"请选择省市区"},on:{change:e.onCascaderChange},model:{value:e.cascader,callback:function(a){e.cascader=a},expression:"cascader"}})],1)],1)],1),t("a-layout",[t("a-layout-sider",{attrs:{mode:"inline","inline-collapsed":!0,collapsed:!0}},[t("a-menu",{on:{click:e.switchArea},model:{value:e.selectedKeys,callback:function(a){e.selectedKeys=a},expression:"selectedKeys"}},e._l(e.areasById,(function(a){return t("a-menu-item",{key:a.id},[t("a-icon",{attrs:{type:"environment"}}),e._v(" "+e._s(a.id)+" "),t("span",[e._v(". "+e._s(a.name))])],1)})),1)],1),t("a-layout",{staticClass:"area-edit"},[t("div",{style:{height:"500px"},attrs:{id:"map"}}),t("a-card",{staticClass:"floating-controller",attrs:{bodyStyle:{display:"flex",flexDirection:"column"}}},[t("a-button",{attrs:{type:"default"},on:{click:e.handleEdit}},[e._v("区域信息")]),t("a-button",{attrs:{type:"primary"},on:{click:e.saveArea}},[e._v("保存路径")]),t("div",{staticClass:"plain-button",attrs:{size:"large"}},[t("a-button",{attrs:{type:"default",icon:"plus"},on:{click:e.createPath}}),t("a-button",{attrs:{type:"danger",ghost:"",icon:"delete"},on:{click:e.removePath}})],1)],1)],1)],1),t("AddForm",{ref:"AddForm",on:{handleSubmit:e.initData}}),t("EditForm",{ref:"EditForm",on:{handleSubmit:e.initData}})],1)},r=[],i=t("5530"),o=t("3835"),l=t("1da1"),s=(t("96cf"),t("d81d"),t("4de4"),t("d3b7"),t("159b"),t("d9a1")),c=t("2af9"),d=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"区域名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入区域名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入区域名称'}]}]"}]})],1),t("a-form-item",{attrs:{label:"选择地区",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("SelectRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["cascader",{rules:[{required:!0,message:"请选择省市区"}]}],expression:"['cascader', {rules: [{required: true, message: '请选择省市区'}]}]"}],attrs:{placeholder:"请选择省市区"}})],1)],1)],1)],1)},u=[],p={components:{SelectRegion:c["h"]},data:function(){return{title:"新增地址",labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this)}},methods:{add:function(){this.visible=!0},handleSubmit:function(e){var a=this;e.preventDefault();var t=this.form.validateFields;t((function(e,t){!e&&a.onFormSubmit(t)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var a=this;this.confirmLoading=!0;var t=Object(o["a"])(e.cascader,3),n=t[0],r=t[1],l=t[2];delete e.cascader,s["a"](Object(i["a"])(Object(i["a"])({},e),{},{province:n,city:r,district:l})).then((function(t){a.$message.success("创建成功",1.5),a.handleCancel(),a.$emit("handleSubmit",e)})).finally((function(){a.confirmLoading=!1}))}}},m=p,f=t("2877"),h=Object(f["a"])(m,d,u,!1,null,null,null),v=h.exports,g=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"区域名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入区域名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入区域名称'}]}]"}]})],1),t("a-form-item",{attrs:{label:"选择地区",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("SelectRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["cascader",{rules:[{required:!0,message:"请选择省市区"}]}],expression:"['cascader', {rules: [{required: true, message: '请选择省市区'}]}]"}],attrs:{placeholder:"请选择省市区"}})],1)],1)],1)],1)},b=[],y={components:{SelectRegion:c["h"]},data:function(){return{title:"编辑地址",labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),record:{}}},methods:{edit:function(e){this.visible=!0,this.record=e,this.setFieldsValue()},setFieldsValue:function(){var e=this.record,a=this.form.setFieldsValue;e.cascader=[e.province,e.city,e.district],this.$nextTick((function(){a(e)}))},handleSubmit:function(e){var a=this;e.preventDefault();var t=this.form.validateFields;t((function(e,t){!e&&a.onFormSubmit(t)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var a=this;this.confirmLoading=!0;var t=Object(o["a"])(e.cascader,3),n=t[0],r=t[1],l=t[2];delete e.cascader,s["c"](this.record.id,Object(i["a"])(Object(i["a"])({},e),{},{province:n,city:r,district:l})).then((function(t){a.$message.success("已修改",1.5),a.handleCancel(),a.$emit("handleSubmit",e)})).finally((function(){a.confirmLoading=!1}))}}},w=y,C=Object(f["a"])(w,g,b,!1,null,null,null),A=C.exports,M=t("862d3"),_=t.n(M),k=t("2ef0"),x=t.n(k),I={name:"Index",components:{STable:c["c"],AddForm:v,EditForm:A,SelectRegion:c["h"]},data:function(){return{areasById:[],selectedKeys:[],queryParam:{per_page:100},cascader:[],isLoading:!1,Amap:null,map:{},polyEditor:null,polygons:[],columns:[{title:"所属区域ID",dataIndex:"delivery_area_id"},{title:"仓储名",dataIndex:"name"},{title:"联系人姓名",dataIndex:"contact_name"},{title:"联系电话",dataIndex:"contact_phone"},{title:"详细地址",dataIndex:"full_address",scopedSlots:{customRender:"full_address"}},{title:"评分",dataIndex:"rating"},{title:"添加时间",dataIndex:"created_at"},{title:"操作",dataIndex:"action",width:"180px",scopedSlots:{customRender:"action"}}]}},created:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return window._AMapSecurityConfig={securityJsCode:"cc376bf07ec7a861cbfada9c7de5b86f"},a.next=3,_.a.load({key:"8eed729112431178d5b9adaff42b33c1",version:"2.0",plugins:["AMap.PolygonEditor"]});case 3:return e.AMap=a.sent,e.map=new e.AMap.Map("map",{}),e.polyEditor=new AMap.PolygonEditor(e.map),e.polyEditor.on("add",(function(a){var t=a.target;e.polygons.push(t),e.polyEditor.addAdsorbPolygons(t),t.on("dblclick",(function(){e.polyEditor.setTarget(t),e.polyEditor.open()}))})),a.next=9,e.initData();case 9:case"end":return a.stop()}}),a)})))()},methods:{initData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var t,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,s["d"](e.queryParam).then((function(e){return e}));case 2:t=a.sent,e.areasById=x()(t.data).keyBy("id").value(),t.data.length?(n=e.selectedKeys[0],r=e.areasById[n]||t.data[0],e.selectedKeys=[r.id],e.loadPaths(r.paths)):(e.map.clearMap(),e.polyEditor.close());case 5:case"end":return a.stop()}}),a)})))()},handleAdd:function(){this.$refs.AddForm.add()},handleEdit:function(){var e=this.selectedKeys[0];e?this.$refs.EditForm.edit(this.areasById[e]):this.$message.error("当前未选中区域")},saveArea:function(){var e,a,t=this,n=this.selectedKeys[0];if(n){null===(e=this.polyEditor)||void 0===e||null===(a=e.close)||void 0===a||a.call(e);var r=this.polygons.map((function(e){return e.getPath()})).filter((function(e){return e.length}));s["c"](n,{paths:r}).then((function(e){t.areasById[n].paths=r,t.$message.success("更新成功",1.5)})).catch((function(e){t.$message.error(e.msg,3)}))}else this.$message.error("当前未选中区域")},handleDelete:function(e){var a=this,t=this.$confirm({title:"您确定要删除该记录吗?",content:"删除后不可恢复",onOk:function(){return s["deleted"](e.id).then((function(e){a.$this.$message.success("已删除",1.5),a.handleRefresh()})).finally((function(e){t.destroy()}))}})},onCascaderChange:function(e){var a=Object(o["a"])(e,3),t=a[0],n=a[1],r=a[2];this.queryParam=Object(i["a"])(Object(i["a"])({},this.queryParam),{},{province:t,city:n,district:r}),this.initData()},switchArea:function(e){this.loadPaths(this.areasById[e.key].paths,this.areasById[e.key].district||this.areasById[e.key].city||this.areasById[e.key].province)},loadPaths:function(e,a){var t=this;if(this.map){if(this.map.clearMap(),this.polyEditor.close(),!e||!e.length)return this.$message.error("暂无路径数据！"),void this.map.setCity(a);this.polygons=e.map((function(e){return new AMap.Polygon({path:e})})),this.map.add(this.polygons),this.map.setFitView(),this.polyEditor.addAdsorbPolygons(this.polygons),this.polygons.forEach((function(e){return e.on("dblclick",(function(){t.polyEditor.setTarget(e),t.polyEditor.open()}))})),this.polyEditor.setTarget(this.polygons[0]),this.polyEditor.open()}else this.$message.error("map还未完全加载，请刷新重试！")},createPath:function(){this.polyEditor.close(),this.polyEditor.setTarget(),this.polyEditor.open()},removePath:function(){var e=this.polyEditor.getTarget();this.map.remove(e),this.polyEditor.close(),this.polygons=this.polygons.filter((function(a){return a!=e}))}}},S=I,L=(t("c2d4"),Object(f["a"])(S,n,r,!1,null,"25b6422a",null));a["default"]=L.exports},d9a1:function(e,a,t){"use strict";t.d(a,"d",(function(){return i})),t.d(a,"a",(function(){return o})),t.d(a,"c",(function(){return l}));t("ac1f"),t("5319");var n=t("b775"),r={list:"/areas",add:"/areas",edit:"/areas/{id}"};function i(e){return Object(n["b"])({url:r.list,method:"get",params:e})}function o(e){return Object(n["b"])({url:r.add,method:"post",data:e})}function l(e,a){return Object(n["b"])({url:r.edit.replace("{id}",e),method:"patch",data:a})}},f30f:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-card",{attrs:{bordered:!1}},[t("div",{staticClass:"card-title"},[e._v(e._s(e.$route.meta.title))]),t("div",{staticClass:"table-operator"},[t("a-row",[t("a-col",{attrs:{span:5}},[t("a-button",{directives:[{name:"action",rawName:"v-action:add",arg:"add"}],attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1),t("a-col",{staticClass:"flex flex-x-end",attrs:{span:11,offset:8}},[t("SelectRegion",{attrs:{placeholder:"请选择省市区"},on:{change:e.onCascaderChange},model:{value:e.cascader,callback:function(a){e.cascader=a},expression:"cascader"}}),t("a-input-search",{staticStyle:{"max-width":"300px","min-width":"150px"},attrs:{placeholder:"搜索名称地址联系人"},on:{search:e.onSearch},model:{value:e.queryParam.search,callback:function(a){e.$set(e.queryParam,"search",a)},expression:"queryParam.search"}})],1)],1)],1),t("s-table",{ref:"table",attrs:{rowKey:"id",loading:e.isLoading,columns:e.columns,data:e.loadData,pageSize:15},scopedSlots:e._u([{key:"full_address",fn:function(a){return t("span",{},[t("p",{staticClass:"twoline-hide",staticStyle:{width:"270px"}},[e._v(e._s(a))])])}},{key:"action",fn:function(a,n){return t("span",{},[t("a",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}],staticStyle:{"margin-right":"8px"},on:{click:function(a){return e.handleEdit(n)}}},[e._v("编辑")]),t("a",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}],on:{click:function(a){return e.handleDelete(n)}}},[e._v("删除")])])}}])}),t("AddForm",{ref:"AddForm",on:{handleSubmit:e.handleRefresh}}),t("EditForm",{ref:"EditForm",on:{handleSubmit:e.handleRefresh}})],1)},r=[],i=t("3835"),o=t("5530"),l=(t("d3b7"),t("4d55")),s=t("2af9"),c=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"仓储名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入仓储名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入仓储名称'}]}]"}]})],1),t("a-form-item",{attrs:{label:"联系人姓名",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact_name",{rules:[{required:!0,message:"请输入联系人姓名"}]}],expression:"['contact_name', {rules: [{required: true, message: '请输入联系人姓名'}]}]"}]})],1),t("a-form-item",{attrs:{label:"联系电话",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact_phone",{rules:[{required:!0,message:"请输入联系电话"}]}],expression:"['contact_phone', {rules: [{required: true, message: '请输入联系电话'}]}]"}]})],1),t("a-form-item",{attrs:{label:"选择地区",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("SelectRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["cascader",{rules:[{required:!0,message:"请选择省市区"}]}],expression:"['cascader', {rules: [{required: true, message: '请选择省市区'}]}]"}],attrs:{placeholder:"请选择省市区"},on:{change:e.onCascaderChange}})],1),t("a-form-item",{attrs:{label:"地图选点",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[e._v(" "+e._s(e.lng)+", "+e._s(e.lat)+" "),t("a-button",{attrs:{type:"primary"},on:{click:e.openSelectMap}},[e._v("打开地图选择位置")]),t("SelectMapPoint",{ref:"SelectMap",attrs:{lng:e.lng,lat:e.lat},on:{complete:e.onSelectMap},model:{value:e.showMap,callback:function(a){e.showMap=a},expression:"showMap"}})],1),t("a-form-item",{attrs:{label:"详细地址",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["address",{rules:[{required:!0,message:"请输入详细地址"}]}],expression:"['address', {rules: [{required: true, message: '请输入详细地址'}]}]"}]})],1),t("a-form-item",{attrs:{label:"所属区域",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["delivery_area_id",{rules:[{required:!1}]}],expression:"['delivery_area_id', {rules: [{required: false}]}]"}],attrs:{options:e.areas}})],1)],1)],1)],1)},d=[],u=t("1da1"),p=(t("96cf"),t("d81d"),t("b0c0"),t("99af"),t("d9a1")),m=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{visible:e.value,title:"请点击地图选择对应位置",forceRender:!0,"wrap-class-name":"full-modal",width:"100%"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{attrs:{id:"map"}})])},f=[],h=(t("3b18"),t("f64c")),v=t("4d91"),g=t("862d3"),b=t.n(g),y={name:"SelectMapPoint",model:{prop:"value",event:"change"},props:{value:v["a"].bool.def(),lng:v["a"].any.def(),lat:v["a"].any.def()},data:function(){return{AMap:null,map:{},marker:null,city:null,longitude:null,latitude:null,address:null}},created:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return window._AMapSecurityConfig={securityJsCode:e.$store.state.AMap_securityJsCode},a.next=3,b.a.load({key:e.$store.state.AMap_key,version:"2.0",plugins:["AMap.Geocoder"]});case 3:e.AMap=a.sent,e.map=new e.AMap.Map("map",{}),e.city&&e.map.setCity(e.city),e.map.on("click",(function(a){e.marker&&e.map.remove(e.marker),e.longitude=a.lnglat.getLng(),e.latitude=a.lnglat.getLat(),e.marker=new e.AMap.Marker({position:new e.AMap.LngLat(e.longitude,e.latitude)}),e.map.add(e.marker)})),e.lng&&e.lat&&(e.marker&&e.map.remove(e.marker),e.marker=new e.AMap.Marker({position:new e.AMap.LngLat(e.lng,e.lat)}),e.map.add(e.marker));case 8:case"end":return a.stop()}}),a)})))()},methods:{onOpen:function(e){map&&(this.city=e.city||this.city,this.lng=e.lng,this.lat=e.lat,this.city&&this.map.setCity(this.city),this.lng&&this.lat?(this.marker&&this.map.remove(this.marker),this.marker=new this.AMap.Marker({position:new this.AMap.LngLat(this.lng,this.lat)}),this.map.add(this.marker)):this.marker&&this.map.remove(this.marker))},handleOk:function(e){var a=this;if(!this.longitude||!this.latitude)return h["a"].error("请先点击地图选择点",3),!1;this.AMap||h["a"].error("地图尚未初始化，请稍后或刷新重试",3);var t=new this.AMap.Geocoder({});t.getAddress([this.longitude,this.latitude],(function(e,t){if("complete"===e&&"OK"===t.info){var n,r,i=null===t||void 0===t||null===(n=t.regeocode)||void 0===n?void 0:n.addressComponent;a.address=i.township+i.street+i.streetNumber,a.address||(a.address=null===t||void 0===t||null===(r=t.regeocode)||void 0===r?void 0:r.formattedAddress)}a.$emit("change",!1),a.$emit("complete",{lng:a.longitude,lat:a.latitude,address:a.address})}))},handleCancel:function(e){this.$emit("change",!1)}}},w=y,C=(t("27d2"),t("2877")),A=Object(C["a"])(w,m,f,!1,null,"d502260a",null),M=A.exports,_={components:{SelectRegion:s["h"],SelectMapPoint:M},data:function(){return{title:"新增地址",labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),showMap:!1,lng:null,lat:null,areas:[],province:""}},created:function(){var e=this;p["d"]({per_page:100}).then((function(a){e.areas=a.data.map((function(e){return{value:e.id,label:e.name||"".concat(e.province,"_").concat(e.id)}}))}))},destroyed:function(){this.lng=null,this.lat=null},methods:{add:function(){this.visible=!0},handleSubmit:function(e){var a=this;e.preventDefault();var t=this.form.validateFields;t((function(e,t){!e&&a.onFormSubmit(t)}))},handleCancel:function(){this.visible=!1,this.form.resetFields(),this.lng=null,this.lat=null},onFormSubmit:function(e){var a=this;this.confirmLoading=!0;var t=Object(i["a"])(e.cascader,3),n=t[0],r=t[1],s=t[2];delete e.cascader,l["a"](Object(o["a"])(Object(o["a"])({},e),{},{province:n,city:r,district:s,longitude:this.lng,latitude:this.lat})).then((function(t){a.$message.success("创建成功",1.5),a.handleCancel(),a.$emit("handleSubmit",e)})).finally((function(){a.confirmLoading=!1}))},openSelectMap:function(){var e,a,t;this.showMap=!0;var n=this.form,r=(n.setFieldsValue,n.getFieldsValue),i=r();this.$refs.SelectMap.onOpen({city:(null===(e=i.cascader)||void 0===e?void 0:e[2])||(null===(a=i.cascader)||void 0===a?void 0:a[1])||(null===(t=i.cascader)||void 0===t?void 0:t[0]),lng:this.lng,lat:this.lat})},onSelectMap:function(e){var a=this.form,t=a.setFieldsValue,n=a.getFieldsValue;this.lng=e.lng,this.lat=e.lat;var r=n();r.address||(r.address=e.address,t(r))},onCascaderChange:function(e){var a=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n="",e.length&&(n=e[0]),n==a.province){t.next=8;break}return t.next=5,p["d"]({province:n,per_page:100});case 5:r=t.sent,a.areas=r.data.map((function(e){return{value:e.id,label:e.name||"".concat(e.province,"_").concat(e.id)}})),a.province=n;case 8:case"end":return t.stop()}}),t)})))()}}},k=_,x=Object(C["a"])(k,c,d,!1,null,null,null),I=x.exports,S=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-modal",{attrs:{title:e.title,width:720,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1,destroyOnClose:!0},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"仓储名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入仓储名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入仓储名称'}]}]"}]})],1),t("a-form-item",{attrs:{label:"联系人姓名",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact_name",{rules:[{required:!0,message:"请输入联系人姓名"}]}],expression:"['contact_name', {rules: [{required: true, message: '请输入联系人姓名'}]}]"}]})],1),t("a-form-item",{attrs:{label:"联系电话",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact_phone",{rules:[{required:!0,message:"请输入联系电话"}]}],expression:"['contact_phone', {rules: [{required: true, message: '请输入联系电话'}]}]"}]})],1),t("a-form-item",{attrs:{label:"选择地区",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("SelectRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["cascader",{rules:[{required:!0,message:"请选择省市区"}]}],expression:"['cascader', {rules: [{required: true, message: '请选择省市区'}]}]"}],attrs:{placeholder:"请选择省市区"},on:{change:e.onCascaderChange}})],1),t("a-form-item",{attrs:{label:"地图选点",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[e._v(" "+e._s(e.lng)+", "+e._s(e.lat)+" "),t("a-button",{attrs:{type:"primary"},on:{click:e.openSelectMap}},[e._v("打开地图选择位置")]),t("SelectMapPoint",{ref:"SelectMap",attrs:{lng:e.lng,lat:e.lat},on:{complete:e.onSelectMap},model:{value:e.showMap,callback:function(a){e.showMap=a},expression:"showMap"}})],1),t("a-form-item",{attrs:{label:"详细地址",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["address",{rules:[{required:!0,message:"请输入详细地址"}]}],expression:"['address', {rules: [{required: true, message: '请输入详细地址'}]}]"}]})],1),t("a-form-item",{attrs:{label:"所属区域",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["delivery_area_id",{rules:[{required:!1}]}],expression:"['delivery_area_id', {rules: [{required: false}]}]"}],attrs:{options:e.areas}})],1),t("a-form-item",{attrs:{label:"门面照片",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("SelectImage",{directives:[{name:"decorator",rawName:"v-decorator",value:["image_id"],expression:"['image_id']"}],attrs:{channel:e.channel,channel_id:e.record.id,collection:"store_image",defaultList:e.record.image?[e.record.image]:[]}})],1)],1)],1)],1)},L=[],O=t("88bc"),j=t.n(O),F=t("c9cc"),E={components:{SelectRegion:s["h"],SelectMapPoint:M,SelectImage:s["g"]},data:function(){return{title:"编辑地址",labelCol:{span:7},wrapperCol:{span:13},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),record:{},showMap:!1,lng:null,lat:null,areas:[],province:"",channel:F["a"].STORE.value}},methods:{edit:function(e){var a=this;this.visible=!0,this.record=e,this.setFieldsValue(),p["d"]({province:e.province,per_page:100}).then((function(e){a.areas=e.data.map((function(e){return{value:e.id,label:e.name||"".concat(e.province,"_").concat(e.id)}}))}))},setFieldsValue:function(){var e=this.record,a=this.form.setFieldsValue;e.cascader=[e.province,e.city,e.district],this.$nextTick((function(){a(j()(e,["name","contact_name","contact_phone","cascader","address","delivery_area_id","image_id"]))})),this.lng=e.longitude,this.lat=e.latitude,this.province=e.province},handleSubmit:function(e){var a=this;e.preventDefault();var t=this.form.validateFields;t((function(e,t){!e&&a.onFormSubmit(t)}))},handleCancel:function(){this.visible=!1,this.form.resetFields()},onFormSubmit:function(e){var a=this;this.confirmLoading=!0;var t=Object(i["a"])(e.cascader,3),n=t[0],r=t[1],s=t[2];delete e.cascader,l["d"](this.record.id,Object(o["a"])(Object(o["a"])({},e),{},{province:n,city:r,district:s,longitude:this.lng,latitude:this.lat})).then((function(t){a.$message.success("已修改",1.5),a.handleCancel(),a.$emit("handleSubmit",e)})).finally((function(){a.confirmLoading=!1}))},openSelectMap:function(){this.showMap=!0;var e=this.form,a=(e.setFieldsValue,e.getFieldsValue),t=a();this.$refs.SelectMap.onOpen({city:t.cascader[2]||t.cascader[1]||t.cascader[0],lng:this.lng,lat:this.lat})},onSelectMap:function(e){var a=this.form,t=a.setFieldsValue,n=a.getFieldsValue;this.lng=e.lng,this.lat=e.lat;var r=n();r.address||(r.address=e.address,t(r))},onCascaderChange:function(e){var a=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n="",e.length&&(n=e[0]),n==a.province){t.next=8;break}return t.next=5,p["d"]({province:n,per_page:100});case 5:r=t.sent,a.areas=r.data.map((function(e){return{value:e.id,label:e.name||"".concat(e.province,"_").concat(e.id)}})),a.province=n;case 8:case"end":return t.stop()}}),t)})))()}}},$=E,P=Object(C["a"])($,S,L,!1,null,null,null),q=P.exports,U={name:"Index",components:{STable:s["c"],AddForm:I,EditForm:q,SelectRegion:s["h"]},data:function(){var e=this;return{queryParam:{},cascader:[],isLoading:!1,columns:[{title:"所属区域ID",dataIndex:"delivery_area_id"},{title:"仓储名",dataIndex:"name"},{title:"联系人姓名",dataIndex:"contact_name"},{title:"联系电话",dataIndex:"contact_phone"},{title:"详细地址",dataIndex:"full_address",scopedSlots:{customRender:"full_address"}},{title:"评分",dataIndex:"rating"},{title:"添加时间",dataIndex:"created_at"},{title:"操作",dataIndex:"action",width:"180px",scopedSlots:{customRender:"action"}}],loadData:function(a){return l["e"](Object(o["a"])(Object(o["a"])({},a),e.queryParam)).then((function(e){return e}))}}},created:function(){},methods:{handleAdd:function(){this.$refs.AddForm.add()},handleEdit:function(e){this.$refs.EditForm.edit(e)},handleDelete:function(e){var a=this,t=this.$confirm({title:"您确定要删除该记录吗?",content:"删除后不可恢复",onOk:function(){return l["c"](e.id).then((function(e){a.$message.success("已删除",1.5),a.handleRefresh()})).finally((function(e){t.destroy()}))}})},handleRefresh:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs.table.refresh(e)},onSearch:function(){this.handleRefresh(!0)},onCascaderChange:function(e){var a=Object(i["a"])(e,3),t=a[0],n=a[1],r=a[2];this.queryParam=Object(o["a"])(Object(o["a"])({},this.queryParam),{},{province:t,city:n,district:r}),this.handleRefresh(!0)}}},R=U,N=Object(C["a"])(R,n,r,!1,null,null,null);a["default"]=N.exports},f341:function(e,a,t){}}]);